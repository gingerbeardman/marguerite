function BEINUKI_YAKU_JUDGE(jia){var hp=helepai % 50;var gang;var anke;yakustatus_fu='';yakustatus_fan='';yakustatus_mgn='';yakustatus_pts='';fdat[jia].fudi=0;fdat[jia].menzi=0;fdat[jia].machi=0;fdat[jia].machi_name='';fdat[jia].mohe=0;fdat[jia].mohe_note='';fdat[jia].kui_pinghe=0;fdat[jia].dat=[0,0,0,0,0,0];fdat[jia].te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var fdat2=new Object();fdat2.dat=[0,0,0,0,0,0];fdat2.te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,];var hb=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,];var mf;var fan2=0;var noDuidui=0;i=shugi_name.length; while(--i>0) shugi_tbl[i]=0;var shugi_ykm=0;SHUPAI_MOVE(jia);helepai_ctr=pai_tbl[hp];if(GUOSHIWUSHUANG(jia)){if(shisanbuta) return(0);if(!yixun && (!ndr_ctr[jia] || ndr[jia][0]>37)){i='地和';if(!tianhe){if(!ronghe){ i='天和'; }}else {if(ronghe) i='人和';}yakutbl[yakutbl_ctr]=i;yfantbl[yakutbl_ctr++]=12;fan+=12;}yakutbl[yakutbl_ctr]='門前清';yfantbl[yakutbl_ctr++]=1;fan++;i=reach[jia];if(i>0){yakutbl[yakutbl_ctr]='立直';yfantbl[yakutbl_ctr++]=2;fan+=2;if(ippatsu[jia]) shugi_tbl[SHUGI_IPT]=1;}keishikiHele=1;yakutbl[yakutbl_ctr]='国士無双';yfantbl[yakutbl_ctr++]=12;fan+=12; gx++;if(fdat_disp){i=20; while(--i>0) fdat[jia].te[i]=te[jia][i];}}else if((i=JIULIANBAODENG(jia))>0){if(!yixun && (!ndr_ctr[jia] || ndr[jia][0]>37)){i='地和';if(!tianhe){if(!ronghe){ i='天和'; }}else {if(ronghe) i='人和';}yakutbl[yakutbl_ctr]=i;yfantbl[yakutbl_ctr++]=12;fan+=12;}yakutbl[yakutbl_ctr]='門前清';yfantbl[yakutbl_ctr++]=1;fan++;if(reach[jia]){yakutbl[yakutbl_ctr]='立直';yfantbl[yakutbl_ctr++]=2;fan+=2;if(ippatsu[jia]) shugi_tbl[SHUGI_IPT]=1;}j='九蓮宝燈'; if(i>1) j='大車輪';keishikiHele=1;yakutbl[yakutbl_ctr]=j;yfantbl[yakutbl_ctr++]=12;fan+=12;if(fdat_disp){i=20; while(--i>0) fdat[jia].te[i]=te[jia][i];}}else if(QIDUIZI(jia)){keishikiHele=1;if(!yixun && (!ndr_ctr[jia] || ndr[jia][0]>37)){i='地和';if(!tianhe){if(!ronghe){ i='天和'; }}else {if(ronghe) i='人和';}yakutbl[yakutbl_ctr]=i;yfantbl[yakutbl_ctr++]=12;fan+=12;}yakutbl[yakutbl_ctr]='門前清';yfantbl[yakutbl_ctr++]=1;fan++;if(reach[jia]){yakutbl[yakutbl_ctr]='立直';yfantbl[yakutbl_ctr++]=2;fan+=2;if(ippatsu[jia]) shugi_tbl[SHUGI_IPT]=1;}i=30; j=0;while(++i<38){if(pai_tbl[i]==2) ++j;}if(j==7){yakutbl[yakutbl_ctr]='字一色';yfantbl[yakutbl_ctr++]=12;fan+=12;}else {l=Math.floor(l / 10)*10; j=0;i=10; while(--i>0){if(pai_tbl[l+i]==2) ++j;}if(j==7){yakutbl[yakutbl_ctr]='清一色';yfantbl[yakutbl_ctr++]=6;fan+=6;}yakutbl[yakutbl_ctr]='七対子';yfantbl[yakutbl_ctr++]=3;fan+=3;}if(fdat_disp){i=20; while(--i>0) hb[i]=te[jia][i];i=0; l=1; while(++i<14){if((j=hb[i]) % 50!=hp){ fdat[jia].te[l++]=j; hb[i]=0; }}m=0; while(++m<14){if(hb[m]>0) fdat[jia].te[l++]=hb[m];}fdat[jia].te[14]=hb[14];}}else if(!MENZI_1(jia)) return(0);else {keishikiHele=1; mm=0;for(;;){if(!yixun && (!ndr_ctr[jia] || ndr[jia][0]>37)){i='地和';if(!tianhe){if(!ronghe){ i='天和'; }}else {if(ronghe) i='人和';}yakutbl[yakutbl_ctr]=i;yfantbl[yakutbl_ctr++]=12;fan+=12;}if(!mq[jia]){yakutbl[yakutbl_ctr]='門前清';yfantbl[yakutbl_ctr++]=1;fan++;}if(reach[jia]){yakutbl[yakutbl_ctr]='立直';yfantbl[yakutbl_ctr++]=2;fan+=2;}l=anke=0;var pos=-1, pos2=-1;var mnm=mnm2='';mf=[0, 0, 0, 0, 0, 0];i=5; while(--i>=0){j=mz[i];if(!j) continue;if(j<100){if(hp+1==j){if(j % 10==8){if(pos<0 || mnm=='嵌張'){pos=mz[i]; mnm='辺張';}}else {++l; pos2=mz[i]; mnm2='両門';}continue;}if(hp-1==j){if(j % 10==2){if(pos<0 || mnm=='嵌張'){pos=mz[i]; mnm='辺張';}}else {++l; pos2=mz[i]; mnm2='両門';}continue;}if(hp==j){if(pos<0){pos=mz[i]; mnm='嵌張';}}continue;}if(j>200){j%=50;if(hp==j){dundiao=1;pos=mz[i]; mnm='単騎';}continue;}j%=50; ++anke;if(hp==j && helepai_ctr<4){pos2=mz[i]; mnm2='双ポン';if(ronghe) --anke;}}i=-1; k=-5; gang=0;while(++i<fc[jia]){k+=5;j=fl[jia][k] % 50;l=fl[jia][k+1] % 50;n=fl[jia][k+2] % 50;if(j!=l){mz[4-i]=(j+l+n) / 3;fdat[jia].dat[i]=3500;continue;}mz[4-i]=j+100;if(fl[jia][k+4]){ ++anke; ++gang; }if(fl[jia][k+3]){ ++gang; }}if(fdat_disp){i=20; while(--i>0) hb[i]=te[jia][i];i=-1; while(++i<4-fc[jia]){if(mz[i]<=mz[i+1]) continue;j=mz[i]; mz[i]=mz[i+1]; mz[i+1]=j;j=mf[i]; mf[i]=mf[i+1]; mf[i+1]=j;i=-1;}var n=0;k=fc[jia]; l=fc[jia]*3+1;pos2=-1; i=-1; while(++i<5-fc[jia]){if(mz[i]<1) continue;if(pos==(j=mz[i]) && pos2<0){ pos2=i; continue; }if(j<100){j--; m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}j++; m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}j++; m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}fdat[jia].dat[k++]=3000;continue;}if(j<200){j %= 50; m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}fdat[jia].dat[k++]=3000+mf[i];continue;}j %= 50; m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}fdat[jia].dat[k++]=2000+mf[i];}if(pos2>-1){m=0; while(++m<20){if(m==14) continue;if(hb[m]>0) fdat[jia].te[l++]=hb[m];}fdat[jia].te[14]=hb[14];j=3000; if(mz[pos2]>200) j=2000;fdat[jia].dat[k++]=j+mf[pos2];}}i=-1; while(++i<4){if(mz[i]<=mz[i+1]) continue;j=mz[i]; mz[i]=mz[i+1]; mz[i+1]=j;i=-1;}if(mz[0]>130 && mz[4]>230){yakutbl[yakutbl_ctr]='字一色';yfantbl[yakutbl_ctr++]=12;fan+=12;}else {i=5; j=-1; k=0;while(--i>=0){l=mz[i] % 50;if(l>30) break;if(j<0){ j=Math.floor(l / 10)*10; continue; }if(Math.floor(l / 10)*10!=j) break;}if(i<0){yakutbl[yakutbl_ctr]='清一色';yfantbl[yakutbl_ctr++]=6;fan+=6;}i=5;while(--i>=0){l=mz[i];if(l<100){if(l!=3) break;continue;}l=l % 100;if(l!=36 && l!=8 && l!=6 && l!=4 && l!=3 && l!=2) break;}if(i<0){yakutbl[yakutbl_ctr]='緑一色';yfantbl[yakutbl_ctr++]=12;fan+=12;}else {i=5; while(--i>-1){l=mz[i];if(l<100) break;l=l % 100;if(l!=37 && l!=1 && l!=5 && l!=7 && l!=9) break;}if(i<0 && lang!='en' && !rule.yaku.benikujaku){yakutbl[yakutbl_ctr]='紅孔雀';yfantbl[yakutbl_ctr++]=12;fan+=12;}}i=5; l=m=0;while(--i>=0){j=mz[i];if(j<100) break;j=j % 100;if(j!=29 && j!=21 && j!=19 && j!=11 && j!=9 && j!=1) break;}if(i<0){yakutbl[yakutbl_ctr]='清老頭';yfantbl[yakutbl_ctr++]=12;fan+=12;}}if(anke==4){yakutbl[yakutbl_ctr]='四暗刻';yfantbl[yakutbl_ctr++]=12;fan+=12;}if(mz[0]>100 && mz[0]<130 && mz[0]+3==mz[3] && !rule.yaku.Xlianke){yakutbl[yakutbl_ctr]='四連刻';yfantbl[yakutbl_ctr++]=12;fan+=12;}else if((mz[0]+10==mz[1] && mz[0]<110 && (mz[1]+10==mz[2] || mz[1]+10==mz[3])) ||    (mz[3]-10==mz[2] && mz[3]<130 && (mz[2]-10==mz[1] || mz[2]-10==mz[0]))){yakutbl[yakutbl_ctr]='三色同刻';yfantbl[yakutbl_ctr++]=3;fan+=3;}if(gang==4){yakutbl[yakutbl_ctr]='四槓子';yfantbl[yakutbl_ctr++]=12;fan+=12;}n=0; i=-1; k=0; while(++i<5){j=mz[i] % 100;if(j>30 && j<35) ++k;}if(k==4){yakutbl[yakutbl_ctr]='四喜和';yfantbl[yakutbl_ctr++]=12;fan+=12;}if(mz[1]==135){yakutbl[yakutbl_ctr]='大三元';yfantbl[yakutbl_ctr++]=12;fan+=12;}if(mz[0]==mz[3] && !rule.yaku.yiseXshun){yakutbl[yakutbl_ctr]='一色四順';yfantbl[yakutbl_ctr++]=12;fan+=12;}if(!mm){i=yakutbl_ctr; while(--i>=0){yakutbl2[i]=yakutbl[i];yfantbl2[i]=yfantbl[i];}yakutbl_ctr2=yakutbl_ctr;i=yakuman_tbl_ctr; while(--i>=0){yakuman_tbl2[i]=yakuman_tbl[i];}yakuman_tbl_ctr2=yakuman_tbl_ctr;fan2=fan;fu2=fu;yakutbl_ctr=yakuman_tbl_ctr=0;fan=fu=0;i=6; while(--i>=0) fdat2.dat[i]=fdat[jia].dat[i];i=20; while(--i>=0) fdat2.te[i]=fdat[jia].te[i];MENZI_3(jia);++mm; continue;}break;}if(fan2>fan || (fan2==fan && fu2>fu)){i=yakutbl_ctr2; while(--i>=0){yakutbl[i]=yakutbl2[i];yfantbl[i]=yfantbl2[i];}yakutbl_ctr=yakutbl_ctr2;i=yakuman_tbl_ctr2; while(--i>=0){yakuman_tbl[i]=yakuman_tbl2[i];}yakuman_tbl_ctr=yakuman_tbl_ctr2;fan=fan2;fu=fu2;i=6; while(--i>=0) fdat[jia].dat[i]=fdat2.dat[i];i=20; while(--i>=0) fdat[jia].te[i]=fdat2.te[i];}}SHUPAI_MOVE(jia);i=fc[jia]*5;while(--i>=0){k=fl[jia][i] % 100;if(k==0) continue;if(k>50){ ++j; k-=50; }pai_tbl[k]++;}i=16; while(--i>0){if(te[jia][i]>50) ++j;}shugi_tbl[SHUGI_NDK]=i=j=ndr_ctr[jia];while(--i>-1){pai_tbl[ndr[jia][i] % 50]++;}i=doraCtr; while(--i>=0) j+=pai_tbl[dora[i]];if(reach[jia]){j+=pai_tbl[uradora[0]];shugi_tbl[SHUGI_URA]+=pai_tbl[uradora[0]];}j+=pai_tbl[bn_lingshangdora[0]];j+=pai_tbl[bn_lingshangdora[1]];if(j>0){yakutbl[yakutbl_ctr]='ドラ';yfantbl[yakutbl_ctr++]=j;fan+=j;}if(fan<1){yakutbl[yakutbl_ctr]='カラス';yfantbl[yakutbl_ctr++]=0;yakustatus_fu=0;yakustatus_pts=pay0=pay1=pay2=yakustatus_fan=-3;fdat[jia].dat=[0,0,0,0,0,0];return(-3);}if(zhuangjia==jia){++fan;yakustatus_mgn='荘家 ';}yakustatus_fu=0;yakustatus_pts=pay0=pay1=pay2=yakustatus_fan=fan+1;fdat[jia].dat=[0,0,0,0,0,0];return(fan);}function BOO_YAKU_JUDGE(jia){var hp=helepai % 50;var anke;yakustatus_fu='';yakustatus_fan='';yakustatus_mgn='';yakustatus_pts='';fdat[jia].fudi=0;fdat[jia].menzi=0;fdat[jia].machi=0;fdat[jia].machi_name='';fdat[jia].mohe=0;fdat[jia].mohe_note='';fdat[jia].kui_pinghe=0;fdat[jia].dat=[0,0,0,0,0,0];fdat[jia].te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var fdat2=new Object();fdat2.dat=[0,0,0,0,0,0];fdat2.te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,];var hb=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,];var mf;var fan2=0;var noDuidui=0;SHUPAI_MOVE(jia);helepai_ctr=pai_tbl[hp];if(GUOSHIWUSHUANG(jia)){if(shisanbuta) return(0);if(!yixun && (!ndr_ctr[jia] || ndr[jia][0]>37)){i='地和';if(!tianhe){if(!ronghe){ i='天和'; }}else {if(ronghe) i='';}if(i){yakuman_tbl[yakuman_tbl_ctr++]=i;fan+=256;}}keishikiHele=1;yakuman_tbl[yakuman_tbl_ctr++]='国士無双';fan=256; gx++;if(fdat_disp){i=20; while(--i>0) fdat[jia].te[i]=te[jia][i];}}else if(JIULIANBAODENG(jia)==1){if(!yixun && (!ndr_ctr[jia] || ndr[jia][0]>37)){i='地和';if(!tianhe){if(!ronghe){ i='天和'; }}else {if(ronghe) i='';}if(i){yakuman_tbl[yakuman_tbl_ctr++]=i;fan+=256;}}keishikiHele=1;yakuman_tbl[yakuman_tbl_ctr++]='九蓮宝燈';fan=256;if(fdat_disp){i=20; while(--i>0) fdat[jia].te[i]=te[jia][i];}}else if(gameMode!=GAMEMODE_ARSHIAR && QIDUIZI(jia)){keishikiHele=1; noDuidui=0;if(!yixun && (!ndr_ctr[jia] || ndr[jia][0]>37)){i='地和';if(!tianhe){if(!ronghe){ i='天和'; }}else {if(ronghe) i='';}if(i){yakuman_tbl[yakuman_tbl_ctr++]=i;fan+=256;}}if(reach[jia]){yakutbl[yakutbl_ctr]='立直';yfantbl[yakutbl_ctr++]=1;fan++;}if(!mq[jia] && !ronghe){yakutbl[yakutbl_ctr]='門前摸和';yfantbl[yakutbl_ctr++]=1;fan++;}i=30; j=0;while(++i<38){if(pai_tbl[i]==2) ++j;}if(j==7){yakuman_tbl[yakuman_tbl_ctr++]='字一色';fan=256;}else {k=j;if(pai_tbl[9]==2) ++j;if(pai_tbl[19]==2) ++j;if(pai_tbl[29]==2) ++j;if(pai_tbl[21]==2) ++j;if(pai_tbl[11]==2) ++j;if(pai_tbl[1]==2) ++j;if(j==7){yakutbl[yakutbl_ctr]='混老頭';yfantbl[yakutbl_ctr++]=4;fan+=4; noDuidui=1;}else if(!j){yakutbl[yakutbl_ctr]='断&#20040;九';yfantbl[yakutbl_ctr++]=1;fan++;}i=16; while(--i>0){l=te[jia][i];if(l>0 && l<30) break;}l=Math.floor(l / 10)*10; j=k;i=10; while(--i>0){if(pai_tbl[l+i]==2) ++j;}if(j==7){if(k){yakutbl[yakutbl_ctr]='混一色';yfantbl[yakutbl_ctr++]=2;fan+=2;}else {yakutbl[yakutbl_ctr]='清一色';yfantbl[yakutbl_ctr++]=4;fan+=4;}}if(!noDuidui){yakutbl[yakutbl_ctr]='七対子';yfantbl[yakutbl_ctr++]=2;fan+=2;}fu=25;}if(fdat_disp){i=20; while(--i>0) hb[i]=te[jia][i];i=0; l=1; while(++i<14){if((j=hb[i]) % 50!=hp){ fdat[jia].te[l++]=j; hb[i]=0; }}m=0; while(++m<14){if(hb[m]>0) fdat[jia].te[l++]=hb[m];}fdat[jia].te[14]=hb[14];}}else if(!MENZI_1(jia)){if(rule.arshiar_qiduizi && QIDUIZI(jia)){keishikiHele=1; noDuidui=0;i='';if(!yixun && (!ndr_ctr[jia] || ndr[jia][0]>37)){i='地和';if(!tianhe){if(!ronghe){ i='天和'; }}else {if(ronghe) i='';}if(i){yakuman_tbl[yakuman_tbl_ctr++]=i;fan+=256;}}if(!i){yakutbl[yakutbl_ctr]='七対子';yfantbl[yakutbl_ctr++]=0;fan+=2;fu=25;}if(fdat_disp){i=20; while(--i>0) hb[i]=te[jia][i];i=0; l=1; while(++i<14){if((j=hb[i]) % 50!=hp){ fdat[jia].te[l++]=j; hb[i]=0; }}m=0; while(++m<14){if(hb[m]>0) fdat[jia].te[l++]=hb[m];}fdat[jia].te[14]=hb[14];}}else return(0);}else {keishikiHele=1; mm=0;for(;;){if(!yixun && (!ndr_ctr[jia] || ndr[jia][0]>37)){i='地和';if(!tianhe){if(!ronghe){ i='天和'; }}else {if(ronghe) i='';}if(i){yakuman_tbl[yakuman_tbl_ctr++]=i;fan+=256;}}if(reach[jia]){yakutbl[yakutbl_ctr]='立直';yfantbl[yakutbl_ctr++]=1;fan++;}if(!mq[jia] && !ronghe){yakutbl[yakutbl_ctr]='門前摸和';yfantbl[yakutbl_ctr++]=1;fan++;}fu=0; k=l=anke=0;var pos=-1, pos2=-1;var mnm=mnm2='';mf=[0, 0, 0, 0, 0, 0];i=5; while(--i>=0){j=mz[i];if(!j) continue;if(j<100){if(hp+1==j){if(j % 10==8){++k;if(pos<0 || mnm=='嵌張'){pos=mz[i]; mnm='辺張';}}else {++l; pos2=mz[i]; mnm2='両門';}continue;}if(hp-1==j){if(j % 10==2){++k;if(pos<0 || mnm=='嵌張'){pos=mz[i]; mnm='辺張';}}else {++l; pos2=mz[i]; mnm2='両門';}continue;}if(hp==j){++k;if(pos<0){pos=mz[i]; mnm='嵌張';}}continue;}if(j>200){j%=50; n=0;if(hp==j){++k; dundiao=1;pos=mz[i]; mnm='単騎';}if(j>34) n++;if(j==zhuangfeng[0]) n++;if(j==zhuangfeng[1]) n++;if(j==menfeng[jia]) n++;mf[i]=n+n; fu+=n+n;continue;}j%=50; ++anke;n=2;if(j>30 || j==1 || j==11 || j==21 || j==9 || j==19 || j==29) n=4;if(hp==j && helepai_ctr<4){pos2=mz[i]; mnm2='双ポン';if(ronghe){ --anke; n=n / 2; }}mf[i]=n+n;fu+=n+n;}i=fc[jia]; j=-5; while(--i>-1){j+=5;if(fl[jia][j] % 50==fl[jia][j+1] % 50) break;}if(i<0 && !fu && l && (ronghe || (gameMode==GAMEMODE_ARSHIAR && rule.arshiar_mo8pinghe && !mq[jia]))){yakutbl[yakutbl_ctr]='平和';yfantbl[yakutbl_ctr++]=1;fan++;fdat[jia].machi_name=mnm2; pos=pos2; dundiao=0;if(!ronghe){fdat[jia].mohe=0;fdat[jia].mohe_note='(平和)';}}else {fdat[jia].menzi=fu;if(!ronghe){fdat[jia].mohe=2; fu+=2;}if(k){fu+=2; fdat[jia].machi=2; fdat[jia].machi_name=mnm;}else { fdat[jia].machi_name=mnm2; pos=pos2; }}i=-1; k=-5;while(++i<fc[jia]){k+=5;j=fl[jia][k] % 50;l=fl[jia][k+1] % 50;n=fl[jia][k+2] % 50;if(j!=l){mz[4-i]=(j+l+n) / 3;fdat[jia].dat[i]=3500;continue;}mz[4-i]=j+100;n=2;if(fl[jia][k+4]){ n=16; ++anke; }if(fl[jia][k+3]) n=8;if(j>30 || j==1 || j==11 || j==21 || j==9 || j==19 || j==29) n+=n;fu+=n; fdat[jia].dat[i]=3500+n;fdat[jia].menzi+=n;}fdat[jia].fudi=20; fu+=20;if(!mq[jia] && ronghe){fu+=10; fdat[jia].fudi=30;}if(!fan && fu==20){fu=30; fdat[jia].kui_pinghe=10;}fdat[jia].total=fu;if(fdat_disp){i=20; while(--i>0) hb[i]=te[jia][i];i=-1; while(++i<4-fc[jia]){if(mz[i]<=mz[i+1]) continue;j=mz[i]; mz[i]=mz[i+1]; mz[i+1]=j;j=mf[i]; mf[i]=mf[i+1]; mf[i+1]=j;i=-1;}var n=0;k=fc[jia]; l=fc[jia]*3+1;pos2=-1; i=-1; while(++i<5-fc[jia]){if(mz[i]<1) continue;if(pos==(j=mz[i]) && pos2<0){ pos2=i; continue; }if(j<100){j--; m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}j++; m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}j++; m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}fdat[jia].dat[k++]=3000;continue;}if(j<200){j %= 50; m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}fdat[jia].dat[k++]=3000+mf[i];continue;}j %= 50; m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}fdat[jia].dat[k++]=2000+mf[i];}if(pos2>-1){m=0; while(++m<20){if(m==14) continue;if(hb[m]>0) fdat[jia].te[l++]=hb[m];}fdat[jia].te[14]=hb[14];j=3000; if(mz[pos2]>200) j=2000;fdat[jia].dat[k++]=j+mf[pos2];}}i=-1; while(++i<4){if(mz[i]<=mz[i+1]) continue;j=mz[i]; mz[i]=mz[i+1]; mz[i+1]=j;i=-1;}noDuidui=0;if(mz[0]>130 && mz[4]>230){yakuman_tbl[yakuman_tbl_ctr++]='字一色';fan+=256;}else {i=5; j=-1; k=0;while(--i>=0){l=mz[i] % 50;if(l>30){ ++k; continue; }if(j<0){ j=Math.floor(l / 10)*10; continue; }if(Math.floor(l / 10)*10!=j) break;}if(i<0){i=1; n='混一色';if(!k){i=3; n='清一色';if(gameMode==GAMEMODE_ARSHIAR){fdat[jia].arshiar_qinyise=10;fdat[jia].total+=10; fu+=10;}}if(gameMode==GAMEMODE_BOO) i++;yakutbl[yakutbl_ctr]=n;yfantbl[yakutbl_ctr++]=i;fan+=i;}i=5; l=m=0;while(--i>=0){j=mz[i];if(j<100){j=j % 10;if(j==2 || j==8) ++l;else ++m;continue;}j=j % 100;if(j>28 || j==1 || j==11 || j==21 || j==9 || j==19) ++l;else ++m;}if(!l){yakutbl[yakutbl_ctr]='断&#20040;九';yfantbl[yakutbl_ctr++]=1;fan++;}else if(m==0){if(mz[0]>100){if(k==0){yakuman_tbl[yakuman_tbl_ctr++]='清老頭';fan+=256;}else {yakutbl[yakutbl_ctr]='混老頭';i=1; if(gameMode==GAMEMODE_BOO){i=4; noDuidui=1;}yfantbl[yakutbl_ctr++]=i;fan+=i;}}else if(gameMode!=GAMEMODE_BOO || rule.boo_chanta){yakutbl[yakutbl_ctr]='全帯&#20040;';i=1; if(gameMode==GAMEMODE_BOO) i=2;yfantbl[yakutbl_ctr++]=i;fan+=i;}}}if(mz[0]>100 && !noDuidui){yakutbl[yakutbl_ctr]='対々和';i=1; if(gameMode==GAMEMODE_BOO) i++;yfantbl[yakutbl_ctr++]=i;fan+=i;}if(anke==4){yakuman_tbl[yakuman_tbl_ctr++]='四暗刻';fan+=256;}else if(anke==3){yakutbl[yakutbl_ctr]='三暗刻';i=1; if(gameMode==GAMEMODE_BOO) i++;yfantbl[yakutbl_ctr++]=i;fan+=i;}if(((mz[0]+3==mz[1] && (mz[0] % 10)==2 && (mz[1]+3==mz[2] || mz[1]+3==mz[3])) ||(mz[3]-3==mz[2] && (mz[3] % 10)==8 && (mz[2]-3==mz[1] || mz[2]-3==mz[0]))) && mz[1]<100){yakutbl[yakutbl_ctr]='一気通貫';i=1; if(gameMode==GAMEMODE_BOO) i++;yfantbl[yakutbl_ctr++]=i;fan+=i;}if((gameMode==GAMEMODE_BOO && rule.boo_sanshoku) || (gameMode==GAMEMODE_ARSHIAR && rule.arshiar_sanshoku)){if((mz[0]+10==mz[1] && mz[0]<110 && (mz[1]+10==mz[2] || mz[1]+10==mz[3])) ||    (mz[3]-10==mz[2] && mz[3]<130 && (mz[2]-10==mz[1] || mz[2]-10==mz[0]))){i=2; if(gameMode==GAMEMODE_ARSHIAR) i=1;j='刻';if(mz[1]<100) j='順';yakutbl[yakutbl_ctr]='三色同'+j;yfantbl[yakutbl_ctr++]=i;fan+=i;}}if((gameMode==GAMEMODE_BOO && rule.boo_sanshun) || (gameMode==GAMEMODE_ARSHIAR && rule.arshiar_sanshun)){if(mz[0]==mz[2] || mz[1]==mz[3]){i=2; if(gameMode==GAMEMODE_ARSHIAR) i=1;yakutbl[yakutbl_ctr]='一色三順';yfantbl[yakutbl_ctr++]=i;fan+=i;}}i=-1; k=0; while(++i<5){j=mz[i] % 100;if(j>30 && j<35) ++k;}if(k==4){yakuman_tbl[yakuman_tbl_ctr++]='四喜和';fan+=256;if((j<30 || j>34) && fc[jia]>3) babao=djia[jia][3];}noDuidui=0;if(mz[1]==135){yakuman_tbl[yakuman_tbl_ctr++]='大三元';fan+=256;i=-1; j=0; k=-5; while(++i<fc[jia]){k+=5; l=fl[jia][k] % 50;if(l<35) continue;++j; if(j==3) babao=dja[jia][i];}}else if(mz[2]>134 && mz[4]>234){yakutbl[yakutbl_ctr]='小三元';i=1; if(gameMode==GAMEMODE_BOO){i=noDuidui=4;}yfantbl[yakutbl_ctr++]=i;fan+=i;}i=-1; n=0;while(++i<4){j=mz[i]-100; k=0;if(j<0 || j>100) continue;if(noDuidui && j>34) continue;if(j>34 || j==zhuangfeng[0]) ++k;if(j==menfeng[jia]) k++;if(k==0) continue;if(j==35) m='白板';else if(j==36) m='緑発';else if(j==37) m='紅中';else {m='東';if(j==32) m='南';else if(j==33) m='西';else if(j==34) m='北';if(k>1) m=m+'連風';else m=m+'風';}yakutbl[yakutbl_ctr]=m;yfantbl[yakutbl_ctr++]=k;fan+=k; n+=k;}if(gameMode==GAMEMODE_ARSHIAR && n>3 && babao<0){k=-5; l=0; j=-1; while(++j<fc[jia]){k+=5; i=fl[jia][k]  % 50;if(i>34 || i==zhuangfeng[0]) ++l;if(i==menfeng[jia]) l++;if(l>3){ babao=dja[jia][j]; break; }}}if(!mm){i=yakutbl_ctr; while(--i>=0){yakutbl2[i]=yakutbl[i];yfantbl2[i]=yfantbl[i];}yakutbl_ctr2=yakutbl_ctr;i=yakuman_tbl_ctr; while(--i>=0){yakuman_tbl2[i]=yakuman_tbl[i];}yakuman_tbl_ctr2=yakuman_tbl_ctr;fan2=fan;fu2=fu;yakutbl_ctr=yakuman_tbl_ctr=0;fan=fu=0;if(fdat_disp){fdat2.fudi=fdat[jia].fudi;fdat2.menzi=fdat[jia].menzi;fdat2.machi=fdat[jia].machi;fdat2.machi_name=fdat[jia].machi_name;fdat2.mohe=fdat[jia].mohe;fdat2.mohe_note=fdat[jia].mohe_note;fdat2.kui_pinghe=fdat[jia].kui_pinghe;fdat2.total=fdat[jia].total;i=6; while(--i>=0) fdat2.dat[i]=fdat[jia].dat[i];i=20; while(--i>=0) fdat2.te[i]=fdat[jia].te[i];fdat[jia].fudi=0;fdat[jia].menzi=0;fdat[jia].machi=0;fdat[jia].machi_name='';fdat[jia].mohe=0;fdat[jia].mohe_note='';fdat[jia].kui_pinghe=0;fdat[jia].dat=[0,0,0,0,0,0];i=20; while(--i>0) fdat[jia].te[i]=te[jia][i];fdat[jia].total=0;}MENZI_2(jia);++mm; continue;}if(mm<2){if(fan2<fan || (fan2==fan && fu2<fu)){i=yakutbl_ctr; while(--i>=0){yakutbl2[i]=yakutbl[i];yfantbl2[i]=yfantbl[i];}yakutbl_ctr2=yakutbl_ctr;i=yakuman_tbl_ctr; while(--i>=0){yakuman_tbl2[i]=yakuman_tbl[i];}yakuman_tbl_ctr2=yakuman_tbl_ctr;fan2=fan;fu2=fu;if(fdat_disp){fdat2.fudi=fdat[jia].fudi;fdat2.menzi=fdat[jia].menzi;fdat2.machi=fdat[jia].machi;fdat2.machi_name=fdat[jia].machi_name;fdat2.mohe=fdat[jia].mohe;fdat2.mohe_note=fdat[jia].mohe_note;fdat2.kui_pinghe=fdat[jia].kui_pinghe;fdat2.total=fdat[jia].total;i=6; while(--i>=0) fdat2.dat[i]=fdat[jia].dat[i];i=20; while(--i>=0) fdat2.te[i]=fdat[jia].te[i];}}yakutbl_ctr=yakuman_tbl_ctr=0;fan=fu=0;if(fdat_disp){fdat[jia].fudi=0;fdat[jia].menzi=0;fdat[jia].machi=0;fdat[jia].machi_name='';fdat[jia].mohe=0;fdat[jia].mohe_note='';fdat[jia].kui_pinghe=0;fdat[jia].dat=[0,0,0,0,0,0];i=20; while(--i>0) fdat[jia].te[i]=te[jia][i];fdat[jia].total=0;}MENZI_3(jia);++mm; continue;}break;}if(fan2>fan || (fan2==fan && fu2>fu)){i=yakutbl_ctr2; while(--i>=0){yakutbl[i]=yakutbl2[i];yfantbl[i]=yfantbl2[i];}yakutbl_ctr=yakutbl_ctr2;i=yakuman_tbl_ctr2; while(--i>=0){yakuman_tbl[i]=yakuman_tbl2[i];}yakuman_tbl_ctr=yakuman_tbl_ctr2;fan=fan2;fu=fu2;if(fdat_disp){fdat[jia].fudi=fdat2.fudi;fdat[jia].menzi=fdat2.menzi;fdat[jia].machi=fdat2.machi;fdat[jia].machi_name=fdat2.machi_name;fdat[jia].mohe=fdat2.mohe;fdat[jia].mohe_note=fdat2.mohe_note;fdat[jia].kui_pinghe=fdat2.kui_pinghe;fdat[jia].total=fdat2.total;i=6; while(--i>=0) fdat[jia].dat[i]=fdat2.dat[i];i=20; while(--i>=0) fdat[jia].te[i]=fdat2.te[i];}}if(gameMode==GAMEMODE_ARSHIAR && rule.arshiar_qiduizi && QIDUIZI(jia)){if(fan<3 && (fu << fan)<100){yakutbl_ctr=0;yakutbl[yakutbl_ctr]='七対子';yfantbl[yakutbl_ctr++]=0;fan=2;fu=25;fdat[jia].fudi=fdat[jia].menzi=fdat[jia].machi=fdat[jia].mohe=fdat[jia].mohe_note=fdat[jia].kui_pinghe=fdat[jia].total=0;fdat[jia].machi_name='';i=6; while(--i>=0) fdat[jia].dat[i]=0;if(fdat_disp){i=20; while(--i>0) hb[i]=te[jia][i];i=0; l=1; while(++i<14){if((j=hb[i]) % 50!=hp){ fdat[jia].te[l++]=j; hb[i]=0; }}m=0; while(++m<14){if(hb[m]>0) fdat[jia].te[l++]=hb[m];}fdat[jia].te[14]=hb[14];}}}}if(lingshang!=0 && ronghe==0){yakutbl[yakutbl_ctr]='嶺上開花';yfantbl[yakutbl_ctr++]=1;fan++;}else if(qianggang!=0 && ronghe!=0){yakutbl[yakutbl_ctr]='搶槓和';yfantbl[yakutbl_ctr++]=1;fan++;}else if(zampai==0 && ronghe==0){yakutbl[yakutbl_ctr]='海底摸月';yfantbl[yakutbl_ctr++]=1;fan++;}boo_ydora=0;boo_menqian=0;boo_yakuman=0;if(gameMode==GAMEMODE_BOO){i=fc[jia]*5; j=0;while(--i>=0){k=fl[jia][i] % 100;if(k==0) continue;if(k>50){ ++j; k-=50; }if(k==dora[0]) boo_ydora++;}i=16; while(--i>0){if((k=te[jia][i])>50){ ++j; k-=50; }if(k==dora[0]) boo_ydora++;}if(j>0){yakutbl[yakutbl_ctr]='赤牌';yfantbl[yakutbl_ctr++]=j;fan+=j;}if(!mq[jia] && rule.boo_menqian) boo_menqian=1;}pay2=0;if(fan>127){yakutbl_ctr=-1; while(++yakutbl_ctr<yakuman_tbl_ctr){yakutbl[yakutbl_ctr]=yakuman_tbl[yakutbl_ctr];yfantbl[yakutbl_ctr]='';}yakustatus_mgn='満貫';pay0=50; pay1=100;fdat[jia].dat=[0,0,0,0,0,0];if(gameMode==GAMEMODE_BOO && rule.boo_yakuman) boo_yakuman++;}else {if(yakutbl_ctr<1){yakutbl[yakutbl_ctr]='役なし';yfantbl[yakutbl_ctr++]='';}if(gameMode==GAMEMODE_BOO) fan++;j=fan; if(fu!=25){fu=Math.floor((fu-1) / 10)+1;yakustatus_fu=fu*10;yakustatus_fan=fan;}else if(gameMode==GAMEMODE_ARSHIAR){yakustatus_fu=0;yakustatus_fan=0;fu=5; --j;}else {yakustatus_fu=25;yakustatus_fan=fan;fu=5; --j;}pay0=fu;while(--j>=0) pay0+=pay0;if(pay0>=50){yakustatus_mgn='満貫';pay0=50; pay1=100;}else pay1=pay0 << 1;}if(zhuangjia==jia){ pay2=pay1+pay1+pay1; pay0=pay1; }else pay2=pay1+pay0+pay0;yakustatus_pts=pay2*10;return(pay2);}function BOO_SCORING(){var scc=[sc[0], sc[1], sc[2], sc[3]];var py, i, r, s, t, blw, ef, sb1, sb2;if(ronghe){py=pay2+(tsumi+boo_ydora+boo_menqian)*30;scc[dajia]-=py;scc[jiaBuff]+=py;}else {i=4; while(--i>-1){if(i==jiaBuff) continue;py=pay0; if(i==zhuangjia) py=pay1;py+=(tsumi+boo_ydora+boo_menqian)*10;scc[i]-=py;scc[jiaBuff]+=py;}}if(gameMode==GAMEMODE_EASTERN_BOO) scc[jiaBuff]+=kyotaku;if(boo_yakuman) return('');sb1=s=200, sb2=399; if(gameMode==GAMEMODE_EASTERN_BOO){ sb1=s=80, sb2=159; }t=-1; blw=ef=0; i=4; while(--i>-1){if(scc[i]<1 || scc[i]>sb2) ef=1;if(scc[i]<sb1){ blw++; continue; }if(scc[i]>s){ s=scc[i]; t=i; }}if(ef || (kyoku>6 && jiaBuff!=zhuangjia)){if(blw<2) return('マルＣになる和了');if(sc[jiaBuff]<sb1 && scc[jiaBuff]<sb1) return('浮上出来ない和了');if(sc[jiaBuff]>=sb1 && t!=jiaBuff) return('一位になれない和了');}return('');}function GM_QIDUI(jia){var i, j, k, sg=0, md, dy=0, zp=0, str;var hb=new Array();var noWuzi=0;var noQiduizi=0;SHUPAI_MOVE(jia);yakutbl_ctr=fan=0;if(fc[jia]) return(0);i=38; j=-1; while(--i>=0){if(pai_tbl[i] % 2) return(0);if(pai_tbl[i]<1) continue;md=i;if(i>30 || (i % 10)==1 || (i % 10)==9) dy+=pai_tbl[i] >> 1;if(i>30) zp+=pai_tbl[i] >> 1;if(pai_tbl[i]>3) sg+=2;}zp=pai_tbl[31]+pai_tbl[32]+pai_tbl[33]+pai_tbl[34]+pai_tbl[35]+pai_tbl[36]+pai_tbl[37];if(!ronghe){if(zampai<1){yakutbl[yakutbl_ctr]='門前清';if(lang=='en') yakutbl[yakutbl_ctr]='Concealed';yfantbl[yakutbl_ctr++]=2;fan+=2;}else {yakutbl[yakutbl_ctr]='不求人';if(lang=='en') yakutbl[yakutbl_ctr]='Fully Concealed';yfantbl[yakutbl_ctr++]=4;fan+=4;}}if(zampai<1){str='妙手回春';if(ronghe){str='海底撈月';if(lang=='en') yakutbl[yakutbl_ctr]='Last Tile Claim';}else if(lang=='en') yakutbl[yakutbl_ctr]='Last Tile Draw';yakutbl[yakutbl_ctr]=str;yfantbl[yakutbl_ctr++]=8;fan+=8;}if(pai_tbl[2]+pai_tbl[3]+pai_tbl[4]+pai_tbl[6]+pai_tbl[8]+pai_tbl[36]>13){yakutbl[yakutbl_ctr]='緑一色';if(lang=='en') yakutbl[yakutbl_ctr]='All Green';yfantbl[yakutbl_ctr++]=88;fan+=88;}else if((i=pai_tbl[1]+pai_tbl[9]+pai_tbl[11]+pai_tbl[19]+pai_tbl[21]+pai_tbl[29])>13){yakutbl[yakutbl_ctr]='清&#20040;九';if(lang=='en') str='All Terminals';yfantbl[yakutbl_ctr++]=64;fan+=64;}else {if(i+zp>13){yakutbl[yakutbl_ctr]='混&#20040;九';if(lang=='en') str='All Terminals and Honors';yfantbl[yakutbl_ctr++]=32;fan+=32;}if(sg>0){yakutbl[yakutbl_ctr]='四帰一';if(lang=='en') yakutbl[yakutbl_ctr]='Tile Hog';yfantbl[yakutbl_ctr++]=sg;fan+=sg;}}if(md>30){yakutbl[yakutbl_ctr]='字一色';if(lang=='en') yakutbl[yakutbl_ctr]='All Honors';yfantbl[yakutbl_ctr++]=64;fan+=64;}else {i=7; j=md-1; while(--i>-1){if(pai_tbl[++j]!=2) break;}if(i<0){yakutbl[yakutbl_ctr]='連七対';if(lang=='en') yakutbl[yakutbl_ctr]='Seven Shifted Pairs';yfantbl[yakutbl_ctr++]=88;fan+=88;noWuzi=1;noQiduizi=1;}else {j=Math.floor(md / 10)*10; i=9; k=0; while(--i>-1) k+=pai_tbl[++j];if(k>13){yakutbl[yakutbl_ctr]='清一色';if(lang=='en') yakutbl[yakutbl_ctr]='Full Flush';yfantbl[yakutbl_ctr++]=24;fan+=24;noWuzi=1;}else if(k+zp>13){yakutbl[yakutbl_ctr]='混一色';if(lang=='en') yakutbl[yakutbl_ctr]='Half Flush';yfantbl[yakutbl_ctr++]=6;fan+=6;}}if(pai_tbl[2]+pai_tbl[4]+pai_tbl[5]+pai_tbl[6]+pai_tbl[8]+pai_tbl[9]+pai_tbl[11]+pai_tbl[12]+pai_tbl[13]+pai_tbl[14]+pai_tbl[15]+pai_tbl[18]+pai_tbl[19]+pai_tbl[37]>13){yakutbl[yakutbl_ctr]='推不倒';if(lang=='en') yakutbl[yakutbl_ctr]='Reversible Tiles';yfantbl[yakutbl_ctr++]=8;fan+=8;}else {j=0;if(pai_tbl[1]+pai_tbl[2]+pai_tbl[3]+pai_tbl[4]+pai_tbl[5]+pai_tbl[6]+pai_tbl[7]+pai_tbl[8]+pai_tbl[9]) j++;if(pai_tbl[11]+pai_tbl[12]+pai_tbl[13]+pai_tbl[14]+pai_tbl[15]+pai_tbl[16]+pai_tbl[17]+pai_tbl[18]+pai_tbl[19]) j++;if(pai_tbl[21]+pai_tbl[22]+pai_tbl[23]+pai_tbl[24]+pai_tbl[25]+pai_tbl[26]+pai_tbl[27]+pai_tbl[28]+pai_tbl[29]) j++;if(j==2){yakutbl[yakutbl_ctr]='欠一門';if(lang=='en') yakutbl[yakutbl_ctr]='One Voided Suit';yfantbl[yakutbl_ctr++]=1;fan+=1;}else if(j==3 && (i=pai_tbl[31]+pai_tbl[32]+pai_tbl[33]+pai_tbl[34])>0 && zp-i>0){yakutbl[yakutbl_ctr]='五門斉';if(lang=='en') yakutbl[yakutbl_ctr]='All Types';yfantbl[yakutbl_ctr++]=6;fan+=6;}}if((i=pai_tbl[7]+pai_tbl[8]+pai_tbl[9]+pai_tbl[17]+pai_tbl[18]+pai_tbl[19]+pai_tbl[27]+pai_tbl[28]+pai_tbl[29])>13){yakutbl[yakutbl_ctr]='全大';if(lang=='en') yakutbl[yakutbl_ctr]='Upper Tiles';yfantbl[yakutbl_ctr++]=24;fan+=24;}else if(i+pai_tbl[6]+pai_tbl[16]+pai_tbl[26]>13){yakutbl[yakutbl_ctr]='大於五';if(lang=='en') yakutbl[yakutbl_ctr]='Upper Four';yfantbl[yakutbl_ctr++]=12;fan+=12;}else if((i=pai_tbl[1]+pai_tbl[2]+pai_tbl[3]+pai_tbl[11]+pai_tbl[12]+pai_tbl[13]+pai_tbl[21]+pai_tbl[22]+pai_tbl[23])>13){yakutbl[yakutbl_ctr]='全小';if(lang=='en') yakutbl[yakutbl_ctr]='Lower Tiles';yfantbl[yakutbl_ctr++]=24;fan+=24;}else if(i+pai_tbl[4]+pai_tbl[14]+pai_tbl[24]>13){yakutbl[yakutbl_ctr]='小於五';if(lang=='en') yakutbl[yakutbl_ctr]='Lower Four';yfantbl[yakutbl_ctr++]=12;fan+=12;}else if(pai_tbl[4]+pai_tbl[5]+pai_tbl[6]+pai_tbl[14]+pai_tbl[15]+pai_tbl[16]+pai_tbl[24]+pai_tbl[25]+pai_tbl[26]>13){yakutbl[yakutbl_ctr]='全中';if(lang=='en') yakutbl[yakutbl_ctr]='Middle Tiles';yfantbl[yakutbl_ctr++]=24;fan+=24;}else if(dy<1){yakutbl[yakutbl_ctr]='断&#20040;';if(lang=='en') yakutbl[yakutbl_ctr]='All Simples';yfantbl[yakutbl_ctr++]=2;fan+=2;}else if(!noWuzi && zp<1){yakutbl[yakutbl_ctr]='無字';if(lang=='en') yakutbl[yakutbl_ctr]='No Honor Tiles';yfantbl[yakutbl_ctr++]=1;fan+=1;}}if(!noQiduizi){yakutbl[yakutbl_ctr]='七対';if(lang=='en') yakutbl[yakutbl_ctr]='Seven Pairs';yfantbl[yakutbl_ctr++]=24;fan+=24;if(fdat_disp){i=14; while(--i>=0) hb[i]=te[jia][i] % 100;i=14; while(--i>=0){if(hb[i] % 50==helepai){hb[i]+=1000; break;}}i=0; while(++i<13){if(hb[i]>hb[i+1]){j=hb[i]; hb[i]=hb[i+1]; hb[i+1]=j;i=0;}}i=14; while(--i>=0) fdat[jia].te[i]=hb[i] % 100;i=-1; while(++i<yakutbl_ctr-1){if(yfantbl[i]>yfantbl[i+1]){j=yakutbl[i]; yakutbl[i]=yakutbl[i+1]; yakutbl[i+1]=j;str=yfantbl[i]; yfantbl[i]=yfantbl[i+1]; yfantbl[i+1]=str;i=-1;}}}}if((ronghe && gm_dp[helepai % 50]>3) || (!ronghe && gm_dp[helepai % 50]>2)){yakutbl[yakutbl_ctr]='和絶張';if(lang=='en') yakutbl[yakutbl_ctr]='Last Tile';yfantbl[yakutbl_ctr++]=4;fan+=4;}return(1);}function GM_SPECIAL_HAND(jia){var i, j, k, f, nty;var str, y;var hb=new Array();var n1=n2=n3=-1;var l0=l1=l2=-1;SHUPAI_MOVE(jia);yakutbl_ctr=fan=0;if(fc[jia]<1){if(pai_tbl[1]*pai_tbl[9]*pai_tbl[11]*pai_tbl[19]*pai_tbl[21]*pai_tbl[29]*pai_tbl[31]*pai_tbl[32]*pai_tbl[33]*pai_tbl[34]*pai_tbl[35]*pai_tbl[36]*pai_tbl[37]==2){GM_YAKU_BUKAO(jia, 0);return(-1);}i=38; while(--i>-1){if(pai_tbl[i]<1) continue;if(pai_tbl[i]>1) break;}if(i<0){if(pai_tbl[1]+pai_tbl[4]+pai_tbl[7]){if(pai_tbl[2]+pai_tbl[5]+pai_tbl[8]+    pai_tbl[3]+pai_tbl[6]+pai_tbl[9]) return(0);if(pai_tbl[12]+pai_tbl[15]+pai_tbl[18]){if(pai_tbl[11]+pai_tbl[14]+pai_tbl[17]+    pai_tbl[13]+pai_tbl[16]+pai_tbl[19]) return(0);if(pai_tbl[21]+pai_tbl[24]+pai_tbl[27]+    pai_tbl[22]+pai_tbl[25]+pai_tbl[28]) return(0);}else if(pai_tbl[13]+pai_tbl[16]+pai_tbl[19]){if(pai_tbl[11]+pai_tbl[14]+pai_tbl[17]+    pai_tbl[12]+pai_tbl[15]+pai_tbl[18]) return(0);if(pai_tbl[21]+pai_tbl[24]+pai_tbl[27]+    pai_tbl[23]+pai_tbl[26]+pai_tbl[29]) return(0);}else return(0);GM_YAKU_BUKAO(jia, 1);return(1);}if(pai_tbl[2]+pai_tbl[5]+pai_tbl[8]){if(pai_tbl[1]+pai_tbl[4]+pai_tbl[7]+    pai_tbl[3]+pai_tbl[6]+pai_tbl[9]) return(0);if(pai_tbl[11]+pai_tbl[14]+pai_tbl[17]){if(pai_tbl[12]+pai_tbl[15]+pai_tbl[18]+    pai_tbl[13]+pai_tbl[16]+pai_tbl[19]) return(0);if(pai_tbl[21]+pai_tbl[24]+pai_tbl[27]+    pai_tbl[22]+pai_tbl[25]+pai_tbl[28]) return(0);}else if(pai_tbl[13]+pai_tbl[16]+pai_tbl[19]){if(pai_tbl[11]+pai_tbl[14]+pai_tbl[17]+    pai_tbl[12]+pai_tbl[15]+pai_tbl[18]) return(0);if(pai_tbl[22]+pai_tbl[25]+pai_tbl[28]+    pai_tbl[23]+pai_tbl[26]+pai_tbl[29]) return(0);}else return(0);GM_YAKU_BUKAO(jia, 1);return(1);}if(pai_tbl[3]+pai_tbl[6]+pai_tbl[9]){if(pai_tbl[1]+pai_tbl[4]+pai_tbl[7]+    pai_tbl[2]+pai_tbl[5]+pai_tbl[8]) return(0);if(pai_tbl[11]+pai_tbl[14]+pai_tbl[17]){if(pai_tbl[12]+pai_tbl[15]+pai_tbl[18]+    pai_tbl[13]+pai_tbl[16]+pai_tbl[19]) return(0);if(pai_tbl[21]+pai_tbl[24]+pai_tbl[27]+    pai_tbl[23]+pai_tbl[26]+pai_tbl[29]) return(0);}else if(pai_tbl[12]+pai_tbl[15]+pai_tbl[18]){if(pai_tbl[11]+pai_tbl[14]+pai_tbl[17]+    pai_tbl[13]+pai_tbl[16]+pai_tbl[19]) return(0);if(pai_tbl[22]+pai_tbl[25]+pai_tbl[28]+    pai_tbl[23]+pai_tbl[26]+pai_tbl[29]) return(0);}else return(0);GM_YAKU_BUKAO(jia, 1);return(1);}}}if(fc[jia]>1) return(0);nty=-1;if(pai_tbl[1]*pai_tbl[4]*pai_tbl[7]){pai_tbl[ 1]--; pai_tbl[ 4]--; pai_tbl[ 7]--; n1=0;if(helepai==1 || helepai==4 || helepai==7) nty=0;if(pai_tbl[12]*pai_tbl[15]*pai_tbl[18]*pai_tbl[23]*pai_tbl[26]*pai_tbl[29]){pai_tbl[12]--; pai_tbl[15]--; pai_tbl[18]--; n2=10;pai_tbl[23]--; pai_tbl[26]--; pai_tbl[29]--; n3=20;if(helepai==12 || helepai==15 || helepai==18) nty=0;if(helepai==23 || helepai==26 || helepai==29) nty=0;}else if(pai_tbl[13]*pai_tbl[16]*pai_tbl[19]*pai_tbl[22]*pai_tbl[25]*pai_tbl[28]){pai_tbl[13]--; pai_tbl[16]--; pai_tbl[19]--; n3=10;pai_tbl[22]--; pai_tbl[25]--; pai_tbl[28]--; n2=20;if(helepai==13 || helepai==16 || helepai==19) nty=0;if(helepai==22 || helepai==25 || helepai==28) nty=0;}else return(0);}else if(pai_tbl[2]*pai_tbl[5]*pai_tbl[8]){pai_tbl[ 2]--; pai_tbl[ 5]--; pai_tbl[ 8]--; n2=0;if(helepai==2 || helepai==5 || helepai==8) nty=0;if(pai_tbl[11]*pai_tbl[14]*pai_tbl[17]*pai_tbl[23]*pai_tbl[26]*pai_tbl[29]){pai_tbl[11]--; pai_tbl[14]--; pai_tbl[17]--; n1=10;pai_tbl[23]--; pai_tbl[26]--; pai_tbl[29]--; n3=20;if(helepai==11 || helepai==14 || helepai==17) nty=0;if(helepai==23 || helepai==26 || helepai==29) nty=0;}else if(pai_tbl[13]*pai_tbl[16]*pai_tbl[19]*pai_tbl[21]*pai_tbl[24]*pai_tbl[27]){pai_tbl[13]--; pai_tbl[16]--; pai_tbl[19]--; n3=10;pai_tbl[21]--; pai_tbl[24]--; pai_tbl[27]--; n1=20;if(helepai==13 || helepai==16 || helepai==19) nty=0;if(helepai==21 || helepai==24 || helepai==27) nty=0;}else return(0);}else if(pai_tbl[3]*pai_tbl[6]*pai_tbl[9]){pai_tbl[ 3]--; pai_tbl[ 6]--; pai_tbl[ 9]--; n3=0;if(helepai==3 || helepai==6 || helepai==9) nty=0;if(pai_tbl[11]*pai_tbl[14]*pai_tbl[17]*pai_tbl[22]*pai_tbl[25]*pai_tbl[28]){pai_tbl[11]--; pai_tbl[14]--; pai_tbl[17]--; n1=10;pai_tbl[22]--; pai_tbl[25]--; pai_tbl[28]--; n2=20;if(helepai==11 || helepai==14 || helepai==17) nty=0;if(helepai==22 || helepai==25 || helepai==28) nty=0;}else if(pai_tbl[12]*pai_tbl[15]*pai_tbl[18]*pai_tbl[21]*pai_tbl[24]*pai_tbl[27]){pai_tbl[12]--; pai_tbl[15]--; pai_tbl[18]--; n2=10;pai_tbl[21]--; pai_tbl[24]--; pai_tbl[27]--; n1=20;if(helepai==12 || helepai==15 || helepai==18) nty=0;if(helepai==21 || helepai==24 || helepai==27) nty=0;}else return(0);}else return(0);var mz=-1, dz=-1;i=0; while(++i<28){if(pai_tbl[i]>0 && pai_tbl[i+1]>=pai_tbl[i] && pai_tbl[i+2]>=pai_tbl[i]){pai_tbl[i]--;pai_tbl[i+1]--;pai_tbl[i+2]--;mz=i+1; break;}if(pai_tbl[i]==3 && pai_tbl[i+1]>0 && pai_tbl[i+2]>0){pai_tbl[i]--;pai_tbl[i+1]--;pai_tbl[i+2]--;mz=i+1; break;}}f=0; i=38; while(--i>0){if(pai_tbl[i]==2){dz=i; pai_tbl[i]-=2; break;}}if(dz<1) return(0);f=0; i=38; while(--i>0){if(pai_tbl[i]==3){mz=i+100; break;}}if(mz<0){i=28; while(--i>=0){if(pai_tbl[i]*pai_tbl[i+1]*pai_tbl[i+2]){mz=i+1; break;}}if(mz<0){if(fc[jia]<1) return(0);i=fl[jia][0] % 50;j=fl[jia][1] % 50;k=fl[jia][2] % 50;if(i!=j) mz=Math.floor((i+j+k) / 3);else mz=i+100;}}if(nty<0){if(fc[jia]<1 && mz<50){if((helepai==mz-1 && helepai % 10==7) ||    (helepai==mz+1 && helepai % 10==3)){yakutbl[yakutbl_ctr]='辺張';if(lang=='en') yakutbl[yakutbl_ctr]='Edge Wait';yfantbl[yakutbl_ctr++]=1;fan++;}else if(helepai==mz){yakutbl[yakutbl_ctr]='嵌張';if(lang=='en') yakutbl[yakutbl_ctr]='Closed Wait';yfantbl[yakutbl_ctr++]=1;fan++;}}else if(helepai==dz && (fc[jia]>0 || mz>100 || Math.abs(mz-helepai)!=1)){yakutbl[yakutbl_ctr]='単調将';if(lang=='en') yakutbl[yakutbl_ctr]='Single Wait';yfantbl[yakutbl_ctr++]=1;fan++; nty=dz; nty=1;}}else if(helepai==dz) nty=500+dz;if(!ronghe){str='自摸'; y=1;if(lang=='en') str='Self-Drawn';if(!mq[jia]){if(zampai>0 && !lingshang){str='不求人'; y=4;if(lang=='en') str='Fully Concealed';}else {str='門前清'; y=2;if(lang=='en') yakutbl[yakutbl_ctr]='Concealed';}}yakutbl[yakutbl_ctr]=str;yfantbl[yakutbl_ctr++]=y;fan++;}else if(!mq[jia]){yakutbl[yakutbl_ctr]='門前清';if(lang=='en') yakutbl[yakutbl_ctr]='Concealed';yfantbl[yakutbl_ctr++]=2;fan+=2;}if(fc[jia]>0){if(fl[jia][3]){yakutbl[yakutbl_ctr]='明槓';if(lang=='en') yakutbl[yakutbl_ctr]='Melded Kong';yfantbl[yakutbl_ctr++]=1;fan+=1;}else if(fl[jia][4]){yakutbl[yakutbl_ctr]='暗槓';if(lang=='en') yakutbl[yakutbl_ctr]='Concealed Kong';yfantbl[yakutbl_ctr++]=2;fan+=2;}}if(mz<50 && dz<30){yakutbl[yakutbl_ctr]='平和';if(lang=='en') yakutbl[yakutbl_ctr]='All Chows';yfantbl[yakutbl_ctr++]=2;fan+=2;}else if(mz % 10<30 && dz<30){yakutbl[yakutbl_ctr]='無字';if(lang=='en') yakutbl[yakutbl_ctr]='No Honor Tiles';yfantbl[yakutbl_ctr++]=1;fan+=1;}if(mz>134){str='箭刻';if(lang=='en') yakutbl[yakutbl_ctr]='Dragon Pung';yakutbl[yakutbl_ctr]=str;yfantbl[yakutbl_ctr++]=2;fan+=2;}else if(mz>130){i=mz % 50;if(zhuangfeng[0]!=i && menfeng[jia]!=i){yakutbl[yakutbl_ctr]='&#20040;九刻';if(lang=='en') yakutbl[yakutbl_ctr]='Pung of Terminals';yfantbl[yakutbl_ctr++]=1;fan+=1;}else {if(zhuangfeng[0]==i){yakutbl[yakutbl_ctr]='圏風刻';if(lang=='en') yakutbl[yakutbl_ctr]='Prevalent Wind';yfantbl[yakutbl_ctr++]=2;fan+=2;}if(menfeng[jia]==i){yakutbl[yakutbl_ctr]='門風刻';if(lang=='en') yakutbl[yakutbl_ctr]='Seat Wind';yfantbl[yakutbl_ctr++]=2;fan+=2;}}}else if(mz>100 && (mz % 10==1 || mz % 10==9)){yakutbl[yakutbl_ctr]='&#20040;九刻';if(lang=='en') yakutbl[yakutbl_ctr]='Pung of Terminals';yfantbl[yakutbl_ctr++]=1;fan+=1;}if((mz % 50>34 && dz>30 && dz<35) ||    (mz % 50>30 && mz % 50<35 && dz>34)){yakutbl[yakutbl_ctr]='五門斉';if(lang=='en') yakutbl[yakutbl_ctr]='All Types';yfantbl[yakutbl_ctr++]=6;fan+=6;}SHUPAI_MOVE(jia);k=-5; i=fc[jia]; while(--i>=0){k+=5;pai_tbl[fl[jia][k  ] % 50]++;pai_tbl[fl[jia][k+1] % 50]++;pai_tbl[fl[jia][k+2] % 50]++;}i=38; y=0; while(--i>=0){if(pai_tbl[i]>3) y+=2;}if(y>0){yakutbl[yakutbl_ctr]='四帰一';if(lang=='en') yakutbl[yakutbl_ctr]='Tile Hog';yfantbl[yakutbl_ctr++]=y;fan+=y;}if(lingshang && !ronghe){yakutbl[yakutbl_ctr]='槓上開花';if(lang=='en') yakutbl[yakutbl_ctr]='Out with Replacement Tile';yfantbl[yakutbl_ctr++]=8;fan+=8;}if(zampai<1){str='妙手回春';if(ronghe){str='海底撈月';if(lang=='en') yakutbl[yakutbl_ctr]='Last Tile Claim';}else if(lang=='en') yakutbl[yakutbl_ctr]='Last Tile Draw';yakutbl[yakutbl_ctr]=str;yfantbl[yakutbl_ctr++]=8;fan+=8;}if(qianggang && ronghe){yakutbl[yakutbl_ctr]='搶槓和';if(lang=='en') yakutbl[yakutbl_ctr]='Robbing The Kong';yfantbl[yakutbl_ctr++]=8;fan+=8;}else if((ronghe && gm_dp[helepai % 50]>3) || (!ronghe && gm_dp[helepai % 50]>2)){yakutbl[yakutbl_ctr]='和絶張';if(lang=='en') yakutbl[yakutbl_ctr]='Last Tile';yfantbl[yakutbl_ctr++]=4;fan+=4;}yakutbl[yakutbl_ctr]='組合竜';if(lang=='en') yakutbl[yakutbl_ctr]='Knitted Straight';yfantbl[yakutbl_ctr++]=12;fan+=12;i=14; while(--i>0) hb[i]=te[jia][i] % 100;l0=l1=l2=0;l=100; if(!nty && (helepai % 50==n1+1 || helepai % 50==n1+4 || helepai % 50==n1+7)) l=4000;i=14; while(--i>=0){j=hb[i];if(!nty && helepai==j % 50) continue;if(j==n1+1 && !l0){l0=1; hb[i]+=l; continue;}if(j==n1+4 && !l1){l1=1; hb[i]+=l; continue;}if(j==n1+7 && !l2){l2=1; hb[i]+=l; continue;}}l0=l1=l2=0;l=200; if(!nty && (helepai % 50==n2+2 || helepai % 50==n2+5 || helepai % 50==n2+8)) l=4000;i=14; while(--i>=0){j=hb[i];if(!nty && helepai==j % 50) continue;if(j==n2+2 && !l0){l0=1; hb[i]+=l; continue;}if(j==n2+5 && !l1){l1=1; hb[i]+=l; continue;}if(j==n2+8 && !l2){l2=1; hb[i]+=l; continue;}}l0=l1=l2=0;l=300; if(!nty && (helepai % 50==n3+3 || helepai % 50==n3+6 || helepai % 50==n3+9)) l=4000;i=14; while(--i>=0){j=hb[i];if(!nty && helepai==j % 50) continue;if(j==n3+3 && !l0){l0=1; hb[i]+=l; continue;}if(j==n3+6 && !l1){l1=1; hb[i]+=l; continue;}if(j==n3+9 && !l2){l2=1; hb[i]+=l; continue;}}if(fdat_disp){k=2400; l=2; if(nty>0){ k=3000; l=1; }i=14; while(--i>0){if(hb[i]==dz && --l>-1){hb[i]+=k; continue;}}if(nty){i=14; while(--i>0){if(hb[i]<100 && hb[i]>0){hb[i]+=2500;}}}}i=0; while(++i<13){if(hb[i]>hb[i+1]){j=hb[i]; hb[i]=hb[i+1]; hb[i+1]=j;i=0;}}if(fdat_disp){i=14; while(--i>=0) fdat[jia].te[i]=hb[i] % 100;i=-1; while(++i<yakutbl_ctr-1){if(yfantbl[i]>yfantbl[i+1]){j=yakutbl[i]; yakutbl[i]=yakutbl[i+1]; yakutbl[i+1]=j;str=yfantbl[i]; yfantbl[i]=yfantbl[i+1]; yfantbl[i+1]=str;i=-1;}}}else {i=14; while(--i>=0) gm_zuhelong_hand[i]=hb[i] % 100;}return(1);}function GM_YAKU_BUKAO(jia, mode){var i, j, str, y;var hb=new Array();if(!ronghe){str='不求人'; y=4;if(zampai<1){str='門前清'; y=2;if(lang=='en') yakutbl[yakutbl_ctr]='Concealed';}else if(lang=='en') str='Fully Concealed';yakutbl[yakutbl_ctr]=str;yfantbl[yakutbl_ctr++]=y;fan+=y;}if(zampai<1){str='妙手回春';if(ronghe){str='海底撈月';if(lang=='en') yakutbl[yakutbl_ctr]='Last Tile Claim';}else if(lang=='en') yakutbl[yakutbl_ctr]='Last Tile Draw';yakutbl[yakutbl_ctr]=str;yfantbl[yakutbl_ctr++]=8;fan+=8;}if(qianggang && ronghe){yakutbl[yakutbl_ctr]='搶槓和';if(lang=='en') yakutbl[yakutbl_ctr]='Robbing The Kong';yfantbl[yakutbl_ctr++]=8;fan+=8;}else if((ronghe && gm_dp[helepai % 50]>3) || (!ronghe && gm_dp[helepai % 50]>2)){yakutbl[yakutbl_ctr]='和絶張';if(lang=='en') yakutbl[yakutbl_ctr]='Last Tile';yfantbl[yakutbl_ctr++]=4;fan+=4;}if(mode){j=0; i=30; while(--i>0){if(pai_tbl[i]) j++;}if(j>8){yakutbl[yakutbl_ctr]='組合竜';if(lang=='en') yakutbl[yakutbl_ctr]='Knitted Straight';yfantbl[yakutbl_ctr++]=12;fan+=12;}i=30; while(++i<38){if(pai_tbl[i]<1) break;}str='全不靠'; y=12;if(i>37){str='七星不靠'; y=24;if(lang=='en') str='Greater Honors and Knitted Tiles';}else if(lang=='en') str='Lesser Honors and Knitted Tiles';yakutbl[yakutbl_ctr]=str;yfantbl[yakutbl_ctr++]=y;fan+=y;}else {yakutbl[yakutbl_ctr]='十三&#20040;';if(lang=='en') yakutbl[yakutbl_ctr]='Thirteen Orphans';yfantbl[yakutbl_ctr++]=88;fan+=88;}if(fdat_disp){i=14; while(--i>=0) fdat[jia].te[i]=te[jia][i];i=-1; while(++i<yakutbl_ctr-1){if(yfantbl[i]>yfantbl[i+1]){j=yakutbl[i]; yakutbl[i]=yakutbl[i+1]; yakutbl[i+1]=j;str=yfantbl[i]; yfantbl[i]=yfantbl[i+1]; yfantbl[i+1]=str;i=-1;}}}}function GM_YAKU_JUDGE(jia){keishikiHele=0;dundiao=0;var hp=helepai % 50;yakutbl_ctr=yakuman_tbl_ctr=0;fu=fan=0;babao=-1;gx=0;yakustatus_fu='';yakustatus_fan='';yakustatus_mgn='';yakustatus_pts='';var anke, gang;fdat[jia].fudi=0;fdat[jia].menzi=0;fdat[jia].machi=0;fdat[jia].machi_name='';fdat[jia].mohe=0;fdat[jia].mohe_note='';fdat[jia].kui_pinghe=0;fdat[jia].dat=[0,0,0,0,0,0];fdat[jia].te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];gm_zuhelong_hand=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var fdat2=new Object();fdat2.te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,];var hb=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,];var fan2=0;var mf;var qdzf=0;var a, b, c, i, j=-1, k=0, l, m, n, o, v, x, y, z;var str='';var anke=0;var gang=0;var angang=0;var liangmen=-1;var qianzhang=-1;var bianzhang=-1;var dandiao=-1;var shuangpeng=-1;var noMenqianqing, noQueyimen, noWuzi, noSiguiyi, noDuanyao, noPinghe,    noDuidui, noTingpai, noQuanqiu, noLaoshaofu, noYibeikou, noYaojiuke,    noQuantai, noXixiangfeng, noLianlyu, gm_liangshun;var ar=new Array();SHUPAI_MOVE(jia);helepai_ctr=pai_tbl[hp];if(GM_SPECIAL_HAND(jia)){if((i=ndr_ctr[jia])>0){yakutbl[yakutbl_ctr]='花牌';if(lang=='en') yakutbl[yakutbl_ctr]='Flower Tiles';yfantbl[yakutbl_ctr++]=i;fan+=i;}yakustatus_pts=yakustatus_fan=pay0=pay2=fan;keishikiHele=1;return(fan);}if(GM_QIDUI(jia)){i=yakutbl_ctr; while(--i>=0){yakutbl2[i]=yakutbl[i];yfantbl2[i]=yfantbl[i];}yakutbl_ctr2=yakutbl_ctr;fan2=fan;if(fdat_disp){i=20; while(--i>=0){fdat2.te[i]=fdat[jia].te[i];fdat[jia].te[i]=te[jia][i];}}qdzf=1;}if(!MENZI_1(jia)){if(qdzf){if((i=ndr_ctr[jia])>0){yakutbl[yakutbl_ctr]='花牌';if(lang=='en') yakutbl[yakutbl_ctr]='Flower Tiles';yfantbl[yakutbl_ctr++]=i;fan+=i;}yakustatus_pts=yakustatus_fan=pay0=pay2=fan;keishikiHele=1;return(fan);}return(0);}mm=0; keishikiHele=1;for(;;){SHUPAI_MOVE(jia);yakutbl_ctr=fan=0;i=16; while(--i>0) fdat[jia].te[i]=te[jia][i];anke=0;var pos=-1, pos2=-1;var mnm=mnm2=mnme='';mf=[0, 0, 0, 0, 0, 0];i=5; while(--i>=0){j=mz[i];if(!j) continue;if(j<100){if(hp+1==j){if(j % 10==8){if(pos<0 || mnm=='嵌張'){pos=mz[i]; mnm='辺張'; mnme='Edge Wait';}}else {++l; pos2=mz[i];}continue;}if(hp-1==j){if(j % 10==2){if(pos<0 || mnm=='嵌張'){pos=mz[i]; mnm='辺張'; mnme='Edge Wait';}}else {++l; pos2=mz[i];}continue;}if(hp==j){if(pos<0){pos=mz[i]; mnm='嵌張'; mnme='Closed Wait';}}continue;}if(j>200){j%=50; n=0;if(hp==j){dundiao=1;pos=mz[i]; mnm='単調将'; mnme='Single Wait';}continue;}j%=50; ++anke;if(hp==j && helepai_ctr<4){pos2=mz[i];if(ronghe) --anke;}}i=-1; k=-5; gang=angang=0;while(++i<fc[jia]){k+=5;j=fl[jia][k] % 50;l=fl[jia][k+1] % 50;n=fl[jia][k+2] % 50;if(j!=l){mz[4-i]=(j+l+n) / 3;continue;}mz[4-i]=j+100;if(fl[jia][k+4]){ ++anke; ++angang; ++gang; }if(fl[jia][k+3]){ ++gang; }}if(fdat_disp){if(pos<0) pos=pos2;i=20; while(--i>0) hb[i]=te[jia][i];i=-1; while(++i<4-fc[jia]){if(mz[i]<=mz[i+1]) continue;j=mz[i]; mz[i]=mz[i+1]; mz[i+1]=j;j=mf[i]; mf[i]=mf[i+1]; mf[i+1]=j;i=-1;}var n=0;k=fc[jia]; l=fc[jia]*3+1;pos2=-1; i=-1; while(++i<5-fc[jia]){if(mz[i]<1) continue;if(pos==(j=mz[i]) && pos2<0){ pos2=i; continue; }if(j<100){j--; m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}j++; m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}j++; m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}continue;}if(j<200){j %= 50; m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}continue;}j %= 50; m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}m=0; while(++m<14){if(hb[m] % 50==j){fdat[jia].te[l++]=hb[m]; hb[m]=0; break;}}}if(pos2>-1){m=0; while(++m<20){if(m==14) continue;if(hb[m]>0) fdat[jia].te[l++]=hb[m];}fdat[jia].te[14]=hb[14];j=3000; if(mz[pos2]>200) j=2000;}}i=-1; while(++i<4){if(mz[i]<=mz[i+1]) continue;j=mz[i]; mz[i]=mz[i+1]; mz[i+1]=j;i=-1;}noMenqianqing=0;noQueyimen=0;noWuzi=0;noSiguiyi=0;noDuanyao=0;noPinghe=0;noDuidui=0;noTingpai=0;noQuanqiu=0;noLaoshaofu=0;noYibeikou=0;noYaojiuke=0;noQuantai=0;noXixiangfeng=0;noLianlyu=0;gm_liangshun=0;if(ronghe && fc[jia]>3 && anke<1){yakutbl[yakutbl_ctr]='全求人';if(lang=='en') yakutbl[yakutbl_ctr]='Melded Hand';yfantbl[yakutbl_ctr++]=6; fan+=6;noTingpai=1;}if(gang>3){yakutbl[yakutbl_ctr]='四槓';if(lang=='en') yakutbl[yakutbl_ctr]='Four Kongs';yfantbl[yakutbl_ctr++]=88; fan+=88;noDuidui=1;noTingpai=1;}else if(gang>2){yakutbl[yakutbl_ctr]='三槓';if(lang=='en') yakutbl[yakutbl_ctr]='Three Kongs';yfantbl[yakutbl_ctr++]=32; fan+=32;}else if(gang>1 && gang>angang){yakutbl[yakutbl_ctr]='双明槓';if(lang=='en') yakutbl[yakutbl_ctr]='Two Melded Kongs';yfantbl[yakutbl_ctr++]=4; fan+=4;}else if(gang==1 && angang<1){yakutbl[yakutbl_ctr]='明槓';if(lang=='en') yakutbl[yakutbl_ctr]='Melded Kong';yfantbl[yakutbl_ctr++]=1; fan+=1;}if(angang>1){yakutbl[yakutbl_ctr]='双暗槓';if(lang=='en') yakutbl[yakutbl_ctr]='Two Concealed Kongs';yfantbl[yakutbl_ctr++]=8; fan+=8;}else if(angang>0){yakutbl[yakutbl_ctr]='暗槓';if(lang=='en') yakutbl[yakutbl_ctr]='Concealed Kong';yfantbl[yakutbl_ctr++]=2; fan+=2;}if(anke>3){yakutbl[yakutbl_ctr]='四暗刻';if(lang=='en') yakutbl[yakutbl_ctr]='Four Concealed Pungs';yfantbl[yakutbl_ctr++]=64; fan+=64;noDuidui=1;noQuanqiu=1;noMenqianqing=1;}else if(anke>2){yakutbl[yakutbl_ctr]='三暗刻';if(lang=='en') yakutbl[yakutbl_ctr]='Three Concealed Pungs';yfantbl[yakutbl_ctr++]=16; fan+=16;}else if(anke>1){yakutbl[yakutbl_ctr]='双暗刻';if(lang=='en') yakutbl[yakutbl_ctr]='Two Concealed Pungs';yfantbl[yakutbl_ctr++]=2; fan+=2;}if(!yixun && !ronghe && zhuangjia==jia) noTingpai=1;if(!noTingpai && mnm!='' && mp_ctr[jia]==1){yakutbl[yakutbl_ctr]=mnm;if(lang=='en') yakutbl[yakutbl_ctr]=mnme;yfantbl[yakutbl_ctr++]=1;fan+=1;}if(mz[0]>130 && mz[4]>230){yakutbl[yakutbl_ctr]='字一色';if(lang=='en') yakutbl[yakutbl_ctr]='All Honors';yfantbl[yakutbl_ctr++]=64; fan+=64;noDuidui=1;noYaojiuke=1;noQuantai=1;}else if((j=Math.floor((mz[4] % 50) / 10)*10)<30 && mz[4]==j+205 &&          mz[0]==j+2 && mz[1]==j+2 && mz[2]==j+8 && mz[3]==j+8){yakutbl[yakutbl_ctr]='一色双竜会';if(lang=='en') yakutbl[yakutbl_ctr]='Pure Terminal Chows';yfantbl[yakutbl_ctr++]=64; fan+=64;noPinghe=1;noXixiangfeng=1;noLaoshaofu=1;noYibeikou=1;noWuzi=1;}else {if(!noTingpai && fc[jia]<1 && (i=Math.floor((helepai % 50) / 10)*10)<30 &&    pai_tbl[i+1]>2 && pai_tbl[i+2]>0 && pai_tbl[i+3]>0 && pai_tbl[i+4]>0 && pai_tbl[i+5]>0 && pai_tbl[i+6]>0 && pai_tbl[i+7]>0 && pai_tbl[i+8]>0 && pai_tbl[i+9]>2 &&    !(pai_tbl[helepai] & 1)){yakutbl[yakutbl_ctr]='九蓮宝燈';if(lang=='en') yakutbl[yakutbl_ctr]='Nine Gates';yfantbl[yakutbl_ctr++]=88; fan+=88;noYaojiuke=1;noMenqianqing=1;noWuzi=1;j=-1; while(++j<20) fdat[jia].te[j]=te[jia][j];}else {i=5; j=-1; k=0;while(--i>=0){l=mz[i] % 50;if(l>30){ ++k; continue; }if(j<0){ j=Math.floor(l / 10)*10; continue; }if(Math.floor(l / 10)*10!=j) break;}if(i<0){i=24; n='清一色';if(lang=='en') n='Full Flush';if(k){i=6; n='混一色';if(lang=='en') n='Half Flush';}yakutbl[yakutbl_ctr]=n;yfantbl[yakutbl_ctr++]=i;fan+=i;noWuzi=1;i=5;while(--i>=0){l=mz[i];if(l<100){if(l!=3) break;continue;}l=l % 100;if(l!=36 && l!=8 && l!=6 && l!=4 && l!=3 && l!=2) break;}if(i<0){yakutbl[yakutbl_ctr]='緑一色';if(lang=='en') yakutbl[yakutbl_ctr]='All Green';yfantbl[yakutbl_ctr++]=88;fan+=88;}}}}if(mz[0]>130 && mz[3]<135){yakutbl[yakutbl_ctr]='大四喜';if(lang=='en') yakutbl[yakutbl_ctr]='Big Four Winds';yfantbl[yakutbl_ctr++]=88; fan+=88;noDuidui=1;noYaojiuke=1;}else {if(mz[4]>230 && mz[4]<235 &&    ((mz[0]>130 && mz[2]<135) || (mz[1]>130 && mz[3]<135))){yakutbl[yakutbl_ctr]='小四喜';if(lang=='en') yakutbl[yakutbl_ctr]='Little Four Winds';yfantbl[yakutbl_ctr++]=64; fan+=64;noYaojiuke=1;}else if((mz[0]>130 && mz[2]<135) || (mz[1]>130 && mz[3]<135)){yakutbl[yakutbl_ctr]='三風刻';if(lang=='en') yakutbl[yakutbl_ctr]='Big Three Winds';yfantbl[yakutbl_ctr++]=12; fan+=12;}k=zhuangfeng[0];i=4; while(--i>=0){if((mz[i] % 50)==k) break;}if(i>-1){yakutbl[yakutbl_ctr]='圏風刻';if(lang=='en') yakutbl[yakutbl_ctr]='Prevalent Wind';yfantbl[yakutbl_ctr++]=2; fan+=2;}k=menfeng[jia];i=4; while(--i>=0){if((mz[i] % 50)==k) break;}if(i>-1){yakutbl[yakutbl_ctr]='門風刻';if(lang=='en') yakutbl[yakutbl_ctr]='Seat Wind';yfantbl[yakutbl_ctr++]=2; fan+=2;}}if(mz[1]>134){yakutbl[yakutbl_ctr]='大三元';if(lang=='en') yakutbl[yakutbl_ctr]='Big Three Dragons';yfantbl[yakutbl_ctr++]=88; fan+=88;}else {if(mz[2]>134 && mz[4]>234){yakutbl[yakutbl_ctr]='小三元';if(lang=='en') yakutbl[yakutbl_ctr]='Little Three Dragons';yfantbl[yakutbl_ctr++]=64; fan+=64;}else if(mz[2]>134){yakutbl[yakutbl_ctr]='双箭刻';if(lang=='en') yakutbl[yakutbl_ctr]='Two Dragon Pungs';yfantbl[yakutbl_ctr++]=6; fan+=6;}else if((j=mz[3] % 50)>34){str='箭刻';if(lang=='en') str='Dragon Pung';yakutbl[yakutbl_ctr]=str; yfantbl[yakutbl_ctr++]=2; fan+=2;}}var yaojiuke=0, quanwu=0;var big=mid=sma=0;var hig=low=0;var yao=zipai=0;var tuibudao=0;i=5; while(--i>=0){j=mz[i];if(j<1) continue;if(j<50){if(j==12 || j==13 || j==14 || j==5) tuibudao++;switch (j % 10){case 2: yao++;sma++;low++;break;case 3: low++;break;case 4: quanwu++;break;case 5: mid++;quanwu++;break;case 6: quanwu++;break;case 7: hig++;break;case 8: big++;hig++;yao++;break;}continue;}if((k=j % 50)==37 || (k<20 && k!=1 && k!=3 && k!=7 && k!=16 && k!=17)) tuibudao++;if((j % 50)>30){zipai++; yao++;if(j<130 && (j % 50)!=zhuangfeng[0] && (j % 50)!=menfeng[jia]) yaojiuke++;continue;}else {switch (j % 10){case 1: yao++;sma++;low++;break;case 2: sma++;low++;break;case 3: low++;sma++;break;case 4: low++;mid++;break;case 5: quanwu++;mid++;break;case 6: hig++;mid++;break;case 7: big++;hig++;break;case 8: big++;hig++;break;case 9: big++;hig++;yao++;break;}}}if(tuibudao>4){yakutbl[yakutbl_ctr]='推不倒';if(lang=='en') yakutbl[yakutbl_ctr]='Reversible Tiles';yfantbl[yakutbl_ctr++]=8; fan+=8;noQueyimen=1;}if(mz[0]>100 && mz[3]<130 && mz[4]<230){i=5; while(--i>=0){if(mz[i] & 1) break;}if(i<0){yakutbl[yakutbl_ctr]='全双刻';if(lang=='en') yakutbl[yakutbl_ctr]='All Even Pungs';yfantbl[yakutbl_ctr++]=24; fan+=24;noWuzi=1;noDuidui=1;noDuanyao=1;}}if(!noQuantai && yao>4 && mz[0]>100){str='清&#20040;九'; v=64;if(lang=='en') str='All Terminals';if(zipai>0){str='混&#20040;九'; v=32;if(lang=='en') str='All Terminals and Honors';}yakutbl[yakutbl_ctr]=str; yfantbl[yakutbl_ctr++]=v; fan+=v;noDuidui=1;noYaojiuke=1;noQuantai=1;noWuzi=1;}else if(yao>4 && !noQuantai){yakutbl[yakutbl_ctr]='全帯&#20040;';if(lang=='en') yakutbl[yakutbl_ctr]='Outside Hand';yfantbl[yakutbl_ctr++]=4; fan+=4;}if(big>4){yakutbl[yakutbl_ctr]='全大';if(lang=='en') yakutbl[yakutbl_ctr]='Upper Tiles';yfantbl[yakutbl_ctr++]=24; fan+=24;noWuzi=1;}else if(hig>4){yakutbl[yakutbl_ctr]='大於五';if(lang=='en') yakutbl[yakutbl_ctr]='Upper Four';yfantbl[yakutbl_ctr++]=12; fan+=12;noWuzi=1;}if(sma>4){yakutbl[yakutbl_ctr]='全小';if(lang=='en') yakutbl[yakutbl_ctr]='Lower Tiles';yfantbl[yakutbl_ctr++]=24; fan+=24;noWuzi=1;}else if(low>4){str='小於五';yakutbl[yakutbl_ctr]='小於五';if(lang=='en') yakutbl[yakutbl_ctr]='Lower Four';yfantbl[yakutbl_ctr++]=12; fan+=12;noWuzi=1;}if(mid>4){yakutbl[yakutbl_ctr]='全中';if(lang=='en') yakutbl[yakutbl_ctr]='Middle Tiles';yfantbl[yakutbl_ctr++]=24; fan+=24;noDuanyao=1;noWuzi=1;}if(quanwu>4){yakutbl[yakutbl_ctr]='全帯五';if(lang=='en') yakutbl[yakutbl_ctr]='All Fives';yfantbl[yakutbl_ctr++]=16; fan+=16;noDuanyao=1;noWuzi=1;}if(noDuanyao<1 && yao<1){yakutbl[yakutbl_ctr]='断&#20040;';if(lang=='en') yakutbl[yakutbl_ctr]='All Simples';yfantbl[yakutbl_ctr++]=2; fan+=2;noWuzi=1;}if(mz[0]==mz[3]){yakutbl[yakutbl_ctr]='一色四同順';if(lang=='en') yakutbl[yakutbl_ctr]='Quadruple Chow';yfantbl[yakutbl_ctr++]=48; fan+=48;noYibeikou=1;noSiguiyi=1;}else if(mz[0]==mz[2] || mz[1]==mz[3]){yakutbl[yakutbl_ctr]='一色三同順';if(lang=='en') yakutbl[yakutbl_ctr]='Pure Triple Chow';yfantbl[yakutbl_ctr++]=24; fan+=24;noYibeikou=1;gm_liangshun=2;}if(mz[0]<100 && mz[4]<230){i=mz[0]; j=mz[2]; k=mz[4] % 50;if((i % 10)==2 && i+6==mz[1] && (j % 10)==2 && j+6==mz[3] && (k % 10)==5 &&    Math.floor(i / 10)!=Math.floor(j / 10) &&    Math.floor(j / 10)!=Math.floor(k / 10) &&    Math.floor(i / 10)!=Math.floor(k / 10)){yakutbl[yakutbl_ctr]='三色双竜会';if(lang=='en') yakutbl[yakutbl_ctr]='Three-Suited Terminal Chows';yfantbl[yakutbl_ctr++]=16; fan+=16;noLaoshaofu=1;noPinghe=1;noXixiangfeng=1;noWuzi=1;}}if((i=mz[0])<100 &&    ((i+1==mz[1] && i+2==mz[2] && i+3==mz[3]) ||     (i+2==mz[1] && i+4==mz[2] && i+6==mz[3]))){yakutbl[yakutbl_ctr]='一色四歩高';if(lang=='en') yakutbl[yakutbl_ctr]='Four Shifted Chows';yfantbl[yakutbl_ctr++]=32; fan+=32;noLaoshaofu=1;}else if(((l=mz[0])<100 && l+1==mz[1] && (l+2==mz[2] || l+2==mz[3])) ||         ((j=mz[3])<100 && j-1==mz[2] && (j-2==(l=mz[1]) || j-2==(l=mz[0])))){yakutbl[yakutbl_ctr]='一色三歩高';if(lang=='en') yakutbl[yakutbl_ctr]='Pure Shifted Chows';yfantbl[yakutbl_ctr++]=16; fan+=16;gm_liangshun=2;}else if(((l=mz[0])<100 && l+2==mz[1] && (l+4==mz[2] || l+4==mz[3])) ||         ((j=mz[3])<100 && j-2==mz[2] && (j-4==(l=mz[1]) || j-4==(l=mz[0])))){yakutbl[yakutbl_ctr]='一色三歩高';if(lang=='en') yakutbl[yakutbl_ctr]='Pure Shifted Chows';yfantbl[yakutbl_ctr++]=16; fan+=16;gm_liangshun=2;}if(((l=mz[0])+10==mz[1] && (l+20==mz[2] || l+20==mz[3]) && (l % 50<10)) ||    ((((j=mz[3]) % 50)<30) && j-10==mz[2] && (j-20==(l=mz[1]) || j-20==(l=mz[0])))){str='三同刻'; v=16;if(mz[2]<100){str='三色三同順'; v=8; gm_liangshun=2; noXixiangfeng=1;if(lang=='en') str='Mixed Triple Chow';}else if(lang=='en') str='Triple Pung';yakutbl[yakutbl_ctr]=str; yfantbl[yakutbl_ctr++]=v; fan+=v;}else {v=0; x=y=-1;i=-1; while(++i<4){if((l=mz[i])<100) continue;if(l>130) break;j=i; while(++j<5){if((m=mz[j])<100) continue;if(m>130) break;if(l % 10!=m % 10) continue;x=l; y=m; v+=2;}}if(v>0){yakutbl[yakutbl_ctr]='双同刻';if(lang=='en') yakutbl[yakutbl_ctr]='Double Pung';yfantbl[yakutbl_ctr++]=v; fan+=v;}}if(((i=mz[0])<30 && i+3==mz[1] && (i+6==mz[2] || i+6==mz[3])) ||    ((i=mz[3])<30 && i-3==mz[2] && (i-6==mz[1] || i-6==mz[0]))){yakutbl[yakutbl_ctr]='清竜';if(lang=='en') yakutbl[yakutbl_ctr]='Pure Straight';yfantbl[yakutbl_ctr++]=16; fan+=16;noLianlyu=1;noLaoshaofu=1;gm_liangshun=2;}if((i=mz[0])>100 && (j=mz[3])<130 && i+3==j){yakutbl[yakutbl_ctr]='一色四節高';if(lang=='en') yakutbl[yakutbl_ctr]='Four Pure Shifted Pungs';yfantbl[yakutbl_ctr++]=48; fan+=48;noDuidui=1;}else if(((i=mz[0])>100 && (j=mz[2])<130 && i+2==j) ||         ((i=mz[1])>100 && (j=mz[3])<130 && i+2==j)){yakutbl[yakutbl_ctr]='一色三節高';if(lang=='en') yakutbl[yakutbl_ctr]='Pure Shifted Pungs';yfantbl[yakutbl_ctr++]=24; fan+=24;}o=0; x=-1; while(++x<3){i=mz[x];if(i!=2 && i!=5 && i!=8) continue;l=1;if(i==5) l=2;if(i==8) l=4;y=x; while(++y<4){i=mz[y];if(i!=12 && i!=15 && i!=18) continue;m=1;if(i==15) m=2;if(i==18) m=4;z=y; while(++z<5){i=mz[z];if(i!=22 && i!=25 && i!=28) continue;n=1;if(i==25) n=2;if(i==28) n=4;if((l | m | n)==7){ o++; break; }}if(o) break;}if(o) break;}if(o){yakutbl[yakutbl_ctr]='花竜';if(lang=='en') yakutbl[yakutbl_ctr]='Mixed Straight';yfantbl[yakutbl_ctr++]=8;fan+=8;gm_liangshun=2;}o=0;var t=[0, 0, 0, 0], u=[0, 0, 0, 0];a=-1; x=-1; while(++x<3){i=mz[x];if(i==a) continue;a=i;if(i<1 || i>130) continue;if(i % 50>10) continue;l=i-i % 10; b=-1;y=x; while(++y<4){i=mz[y];if(i==b) continue;b=i;if(i<1 || i>130) continue;if(i-i % 10!=l+10) continue;c=-1;z=y; while(++z<5){i=mz[z];if(i==c) continue;c=i;if(i<1 || i>130) continue;if(i-i % 10!=l+20) continue;u[0]=mz[x]; t[0]=mz[x] % 10;u[1]=mz[y]; t[1]=mz[y] % 10;u[2]=i; t[2]=i % 10;for(;;){if(t[0]>t[1]){k=t[0]; t[0]=t[1]; t[1]=k;k=u[0]; u[0]=u[1]; u[1]=k;continue;}if(t[1]<=t[2]) break;k=t[1]; t[1]=t[2]; t[2]=k;k=u[1]; u[1]=u[2]; u[2]=k;}if(t[0]+1==t[1] && t[1]+1==t[2]){str='三色三節高'; v=8;if(u[0]<100){str='三色三歩高';if(lang=='en') str='Mixed Shifted Chows';gm_liangshun=2; v=6;}else if(lang=='en') str='Mixed Shifted Pungs';yakutbl[yakutbl_ctr]=str; yfantbl[yakutbl_ctr++]=v; fan+=v;o=-1;break;}}if(o) break;}if(o) break;}if(!noDuidui && mz[0]>100){yakutbl[yakutbl_ctr]='&#30896;々和';if(lang=='en') yakutbl[yakutbl_ctr]='All Pungs';yfantbl[yakutbl_ctr++]=6; fan+=6;}l=m=n=o=0; w=0;a=x=-1; while(++x<3){if((i=mz[x])>100) break;if(i==a) continue;a=i; b=-1; y=x; while(++y<4){if((i=mz[y])>100) break;if(i==b) continue;b=i;if(a==b){if(noYibeikou>0) continue;if(gm_liangshun>2) continue;l++; gm_liangshun++;continue;}if(a % 10<6 && a+3==b){if(noLianlyu>0) continue;if(gm_liangshun>2) continue;m++; gm_liangshun++;continue;}if(a % 10==2 && a+6==b){if(noLaoshaofu>0) continue;if(gm_liangshun>2) continue;n++; gm_liangshun++;continue;}if(a % 10!=b % 10)  continue;if(noXixiangfeng>0) continue;if(gm_liangshun>2) continue;o++; gm_liangshun++;}}if((v=l)>0){yakutbl[yakutbl_ctr]='一般高';if(lang=='en') yakutbl[yakutbl_ctr]='Pure Double Chow';yfantbl[yakutbl_ctr++]=v; fan+=v;}if((v=m)>0){yakutbl[yakutbl_ctr]='連六';if(lang=='en') yakutbl[yakutbl_ctr]='Short Straight';yfantbl[yakutbl_ctr++]=v; fan+=v;}if((v=n)>0){yakutbl[yakutbl_ctr]='老少副';if(lang=='en') yakutbl[yakutbl_ctr]='Two Terminal Chows';yfantbl[yakutbl_ctr++]=v; fan+=v;}if((v=o)>0){yakutbl[yakutbl_ctr]='喜相逢';if(lang=='en') yakutbl[yakutbl_ctr]='Mixed Double Chow';yfantbl[yakutbl_ctr++]=v; fan+=v;}if(!noPinghe && mz[3]<100 && mz[4]<230){yakutbl[yakutbl_ctr]='平和';if(lang=='en') yakutbl[yakutbl_ctr]='All Chows';yfantbl[yakutbl_ctr++]=2; fan+=2;noWuzi=1;}if(!noWuzi && zipai<1){yakutbl[yakutbl_ctr]='無字';if(lang=='en') yakutbl[yakutbl_ctr]='No Honor Tiles';yfantbl[yakutbl_ctr++]=1; fan+=1;}if(!noYaojiuke){v=0; i=4; while(--i>=0){j=mz[i]-100;if(j<1 || j>34) continue;if(j>30){if(j!=zhuangfeng[0] && j!=zhuangfeng[1] && j!=menfeng[jia]) v++;continue;}if(j % 10==1 || j % 10==9) v++;}if(v>0){yakutbl[yakutbl_ctr]='&#20040;九刻';if(lang=='en') yakutbl[yakutbl_ctr]='Pung of Terminals';yfantbl[yakutbl_ctr++]=v; fan+=v;}}ar[0]=ar[1]=ar[2]=ar[3]=ar[4]=0;i=5; while(--i>=0){if((j=mz[i] % 50)>34){ ar[4]++; continue; }ar[Math.floor(j / 10)]++;}i=5; j=0; while(--i>=0){if(ar[i]>0) j++;}if(j>4){yakutbl[yakutbl_ctr]='五門斉';if(lang=='en') yakutbl[yakutbl_ctr]='All Types';yfantbl[yakutbl_ctr++]=6; fan+=6;}if(!noQueyimen){i=3; j=0; k=-1; while(--i>=0){if(ar[i]<1){ k=i; j++; }}if(j==1){yakutbl[yakutbl_ctr]='欠一門';if(lang=='en') yakutbl[yakutbl_ctr]='One Voided Suit';yfantbl[yakutbl_ctr++]=1; fan++;}}if(!noSiguiyi){i=38; while(--i>=0) ar[i]=pai_tbl[i];k=-5; i=fc[jia]; while(--i>=0){k+=5;ar[fl[jia][k  ] % 50]++;ar[fl[jia][k+1] % 50]++;ar[fl[jia][k+2] % 50]++;}v=0; i=0; while(++i<38){if(ar[i]>3) v+=2;}if(v>0){yakutbl[yakutbl_ctr]='四帰一';if(lang=='en') yakutbl[yakutbl_ctr]='Tile Hog';yfantbl[yakutbl_ctr++]=v; fan+=v;}}if(lingshang>0 && !ronghe){yakutbl[yakutbl_ctr]='槓上開花';if(lang=='en') yakutbl[yakutbl_ctr]='Out with Replacement Tile';yfantbl[yakutbl_ctr++]=8;fan+=8;}if(!mq[jia] && (!noMenqianqing || !ronghe)){str='不求人'; y=4;if(ronghe || lingshang>0 || zampai<1){str='門前清'; y=2;if(lang=='en') str='Concealed';}else if(lang=='en') str='Fully Concealed';yakutbl[yakutbl_ctr]=str;yfantbl[yakutbl_ctr++]=y;fan+=y;}else if(!ronghe && lingshang<1 && zampai>1){yakutbl[yakutbl_ctr]='自摸';if(lang=='en') yakutbl[yakutbl_ctr]='Self-Drawn';yfantbl[yakutbl_ctr++]=1;fan+=1;}if(zampai<1){str='妙手回春';if(ronghe){str='海底撈月';if(lang=='en') str='Last Tile Claim';}else if(lang=='en') str='Last Tile Draw';yakutbl[yakutbl_ctr]=str;yfantbl[yakutbl_ctr++]=8;fan+=8;}if(qianggang && ronghe){yakutbl[yakutbl_ctr]='搶槓和';if(lang=='en') yakutbl[yakutbl_ctr]='Robbing The Kong';yfantbl[yakutbl_ctr++]=8;fan+=8;}else if((ronghe && gm_dp[helepai % 50]>3) || (!ronghe && gm_dp[helepai % 50]>2)){yakutbl[yakutbl_ctr]='和絶張';if(lang=='en') yakutbl[yakutbl_ctr]='Last Tile';yfantbl[yakutbl_ctr++]=4;fan+=4;}if(fan<1){yakutbl[yakutbl_ctr]='無番和';if(lang=='en') yakutbl[yakutbl_ctr]='Chicken Hand';yfantbl[yakutbl_ctr++]=8;fan+=8;}if(fan2<fan){i=yakutbl_ctr; while(--i>=0){yakutbl2[i]=yakutbl[i];yfantbl2[i]=yfantbl[i];}yakutbl_ctr2=yakutbl_ctr;fan2=fan;if(fdat_disp){i=20; while(--i>=0){fdat2.te[i]=fdat[jia].te[i];fdat[jia].te[i]=te[jia][i];}}}if(++mm>1) break;MENZI_3(jia);}if((fan=fan2)<8) return(0);i=yakutbl_ctr2; while(--i>=0){yakutbl[i]=yakutbl2[i];yfantbl[i]=yfantbl2[i];}yakutbl_ctr=yakutbl_ctr2;if(fdat_disp){i=20; while(--i>=0) fdat[jia].te[i]=fdat2.te[i];i=-1; while(++i<yakutbl_ctr-1){if(yfantbl[i]>yfantbl[i+1]){j=yakutbl[i]; yakutbl[i]=yakutbl[i+1]; yakutbl[i+1]=j;str=yfantbl[i]; yfantbl[i]=yfantbl[i+1]; yfantbl[i+1]=str;i=-1;}}}if((i=ndr_ctr[jia])>0){yakutbl[yakutbl_ctr]='花牌';if(lang=='en') yakutbl[yakutbl_ctr]='Flower Tiles';yfantbl[yakutbl_ctr++]=i;fan+=i;}yakustatus_pts=yakustatus_fan=pay0=pay2=fan;return(pay2);}function TM_YAKU_JUDGE(jia){keishikiHele=0;dundiao=0;var hp=helepai % 50;yakutbl_ctr=yakuman_tbl_ctr=0;fu=fan=0;babao=-1;gx=0;yakustatus_fu='';yakustatus_fan='';yakustatus_mgn='';yakustatus_pts='';var anke, gang;fdat[jia].fudi=0;fdat[jia].menzi=0;fdat[jia].machi=0;fdat[jia].machi_name='';fdat[jia].mohe=0;fdat[jia].mohe_note='';fdat[jia].kui_pinghe=0;fdat[jia].dat=[0,0,0,0,0,0];fdat[jia].te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var fdat2=new Object();fdat[jia].dat=[0,0,0,0,0,0];fdat2.te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,];var hb=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,];var mf;var tbf=new Array();SHUPAI_MOVE(jia);helepai_ctr=pai_tbl[hp];var fan2=0;if(!MENZI_1(jia)){if(tm_baxianguohai[jia] && !ronghe){yakutbl_ctr=0;yakutbl[yakutbl_ctr]='八仙過海';yfantbl[yakutbl_ctr++]=8;if(lang=='en'){--yakutbl_ctr;yakutbl[yakutbl_ctr++]='Eight Flower Tiles';yakutbl[yakutbl_ctr]='Belonging';yfantbl[yakutbl_ctr++]=0;}yakustatus_fan=fan=8;pay0=pay2=fan+5;yakustatus_pts=pay2;return(pay2);}return(0);}mm=0; for(;;){keishikiHele=1;yakutbl_ctr=fan=0;if(tm_baxianguohai[jia]){yakutbl[yakutbl_ctr]='八仙過海';yfantbl[yakutbl_ctr++]=8;if(lang=='en'){--yakutbl_ctr;yakutbl[yakutbl_ctr++]='Eight Flower Tiles';yakutbl[yakutbl_ctr]='Belonging';yfantbl[yakutbl_ctr++]=0;}fan+=8;}if(!yixun && (!ndr_ctr[jia] || ndr[jia][0]>37)){i='地胡'; j='Blessing of Earth';if(!tianhe){if(!ronghe){ i='天胡'; j='Blessing of Heaven'; }}else {if(ronghe){ i='人胡'; j='Blessing of Man' }}yakutbl[yakutbl_ctr]=i;yfantbl[yakutbl_ctr++]=12;fan+=12;}else {if(reach[jia]){j='天聴'; i=8;if(jia!=zhuangjia){j='地聴'; i=4;}if(lang=='en') j='Declaration of Winning Hand';yakutbl[yakutbl_ctr]=j;yfantbl[yakutbl_ctr++]=i;fan+=i;}else {if(!mq[jia]){yakutbl[yakutbl_ctr]='門清';if(lang=='en') yakutbl[yakutbl_ctr]='No Melding';yfantbl[yakutbl_ctr++]=1;fan++;}if(!mq[jia] && !ronghe){yakutbl[yakutbl_ctr]='不求';if(lang=='en') yakutbl[yakutbl_ctr]='Self Tiles Only';yfantbl[yakutbl_ctr++]=1;fan++;}}if(!ronghe){yakutbl[yakutbl_ctr]='自摸';if(lang=='en') yakutbl[yakutbl_ctr]='Completion by Draw';yfantbl[yakutbl_ctr++]=1;fan++;}}fu=0; k=l=anke=0;var pos=-1, pos2=-1;var mnm=mnm2='';mf=[0, 0, 0, 0, 0, 0];i=6; while(--i>=0){j=mz[i];if(!j) continue;if(j<100){if(hp+1==j){if(j % 10==8){++k;if(pos<0 || mnm=='嵌張'){pos=mz[i]; mnm='辺張';}}else {++l; pos2=mz[i];}continue;}if(hp-1==j){if(j % 10==2){++k;if(pos<0 || mnm=='嵌張'){pos=mz[i]; mnm='辺張';}}else {++l; pos2=mz[i];}continue;}if(hp==j){++k;if(pos<0){pos=mz[i]; mnm='嵌張';}}continue;}if(j>200){j%=50;if(hp==j){++k; dundiao=1;pos=mz[i]; mnm='単騎';}continue;}j%=50; ++anke;if(hp==j && helepai_ctr<4){pos2=mz[i];if(ronghe) --anke;}}i=-1; k=-5; gang=0;while(++i<fc[jia]){k+=5;j=fl[jia][k] % 50;l=fl[jia][k+1] % 50;n=fl[jia][k+2] % 50;if(j!=l){mz[5-i]=(j+l+n) / 3;continue;}mz[5-i]=j+100;if(fl[jia][k+4]){ ++anke; ++gang; }if(fl[jia][k+3]){ ++gang; }}i=6; while(--i>=0) mf[i]=mz[i];i=-1; while(++i<5){if(mz[i]<=mz[i+1]) continue;j=mz[i]; mz[i]=mz[i+1]; mz[i+1]=j;i=-1;}if(ndr_ctr[jia]<1 && mz[4]<100 && mz[5]<230 && pos2>-1 && ronghe){yakutbl[yakutbl_ctr]='平胡';if(lang=='en') yakutbl[yakutbl_ctr]='Simple Sequence Hand';yfantbl[yakutbl_ctr++]=2;fan+=2;fdat[jia].machi_name=mnm2; pos=pos2; dundiao=0;}else if(pos>-1){yakutbl[yakutbl_ctr]='独聴';if(lang=='en') yakutbl[yakutbl_ctr]='Single, Edge, or Closed Wait';yfantbl[yakutbl_ctr++]=1;fan++;}if(fc[jia]>4 && anke<1){i='半求'; j=1;if(lang=='en') i='Melded Hand except a Pair';if(ronghe){i='全求'; j=2;if(lang=='en') i='Fully Melded Hand';}yakutbl[yakutbl_ctr]=i;yfantbl[yakutbl_ctr++]=j;fan+=j;}if(fdat_disp){i=20; while(--i>0){ fdat[jia].te[i]=tbf[i]=0; hb[i]=te[jia][i]; }i=-1; while(++i<5-fc[jia]){if(mf[i]<=mf[i+1]) continue;j=mf[i]; mf[i]=mf[i+1]; mf[i+1]=j;i=-1;}var n=0;k=fc[jia]; l=fc[jia]*3+1;if(pos<0) pos=pos2;pos2=-1; i=-1; while(++i<6-fc[jia]){if(mf[i]<1) continue;if(pos==(j=mf[i]) && pos2<0){ pos2=i; continue; }if(j<100){j--; m=0; while(++m<20){if(m==14) continue;if(hb[m] % 50==j){tbf[l++]=hb[m]; hb[m]=0; break;}}j++; m=0; while(++m<20){if(m==14) continue;if(hb[m] % 50==j){tbf[l++]=hb[m]; hb[m]=0; break;}}j++; m=0; while(++m<20){if(m==14) continue;if(hb[m] % 50==j){tbf[l++]=hb[m]; hb[m]=0; break;}}continue;}if(j<200){j %= 50; m=0; while(++m<20){if(m==14) continue;if(hb[m] % 50==j){tbf[l++]=hb[m]; hb[m]=0; break;}}m=0; while(++m<20){if(m==14) continue;if(hb[m] % 50==j){tbf[l++]=hb[m]; hb[m]=0; break;}}m=0; while(++m<20){if(m==14) continue;if(hb[m] % 50==j){tbf[l++]=hb[m]; hb[m]=0; break;}}continue;}j %= 50; m=0; while(++m<20){if(m==14) continue;if(hb[m] % 50==j){tbf[l++]=hb[m]; hb[m]=0; break;}}m=0; while(++m<20){if(m==14) continue;if(hb[m] % 50==j){tbf[l++]=hb[m]; hb[m]=0; break;}}}m=0; while(++m<20){if(m==14) continue;if(hb[m]>0) tbf[l++]=hb[m];}tbf[17]=hb[14];fdat[jia].te[17]=tbf[1];fdat[jia].te[18]=tbf[2];fdat[jia].te[19]=tbf[3];i=0; while(++i<15) fdat[jia].te[i]=tbf[i+3];}if(mz[0]>130 && mz[5]>230){yakutbl[yakutbl_ctr]='字一色';if(lang=='en') yakutbl[yakutbl_ctr]='All Honors';yfantbl[yakutbl_ctr++]=8;fan+=8;}else {i=6; j=-1; k=0;while(--i>=0){l=mz[i] % 50;if(l>30){ ++k; continue; }if(j<0){ j=Math.floor(l / 10)*10; continue; }if(Math.floor(l / 10)*10!=j) break;}if(i<0){i=8; n='清一色';if(k){ i=4; n='混一色';if(lang=='en') n='Half Flush';}else if(lang=='en') n='Full Flush';yakutbl[yakutbl_ctr]=n;yfantbl[yakutbl_ctr++]=i;fan+=i;}}if(mz[0]>100){yakutbl[yakutbl_ctr]='&#30896;々胡';if(lang=='en') yakutbl[yakutbl_ctr]='All Pungs';yfantbl[yakutbl_ctr++]=4;fan+=4;}if(anke==5){yakutbl[yakutbl_ctr]='五暗刻';if(lang=='en') yakutbl[yakutbl_ctr]='Five Concealed Pungs';yfantbl[yakutbl_ctr++]=8;fan+=8;}else if(anke==4){yakutbl[yakutbl_ctr]='四暗刻';if(lang=='en') yakutbl[yakutbl_ctr]='Four Concealed Pungs';yfantbl[yakutbl_ctr++]=5;fan+=5;}else if(anke==3){yakutbl[yakutbl_ctr]='三暗刻';if(lang=='en') yakutbl[yakutbl_ctr]='Three Concealed Pungs';yfantbl[yakutbl_ctr++]=2;fan+=2;}n=0; if((mz[0]>130 && mz[3]<135) || (mz[1]>130 && mz[4]<135)){yakutbl[yakutbl_ctr]='大四喜';if(lang=='en') yakutbl[yakutbl_ctr]='Big Four Winds';yfantbl[yakutbl_ctr++]=12;fan+=12; n|=2;}else {i=-1; k=0; while(++i<6){j=mz[i] % 100;if(j>30 && j<35) ++k;}if(k==4){yakutbl[yakutbl_ctr]='小四喜';if(lang=='en') yakutbl[yakutbl_ctr]='Little Four Winds';yfantbl[yakutbl_ctr++]=8;fan+=8;}}if(mz[2]==135){yakutbl[yakutbl_ctr]='大三元';if(lang=='en') yakutbl[yakutbl_ctr]='Big Three Dragons';yfantbl[yakutbl_ctr++]=8;fan+=8; n |= 1;}else if(mz[3]>134 && mz[5]>234){yakutbl[yakutbl_ctr]='小三元';if(lang=='en') yakutbl[yakutbl_ctr]='Little Three Dragons';yfantbl[yakutbl_ctr++]=4;fan+=4; n |= 1;}i=-1; while(++i<5){j=mz[i]-100; k=0;if(j<0 || j>100) continue;if(j>34 || j==zhuangfeng[0] || j==zhuangfeng[1]) ++k;if(j==menfeng[jia]) k++;if(k==0) continue;if((n & 1) && j>34) continue;if((n & 2) && j<35) continue;if(j==35){m='紅中';if(lang=='en') m='Red Dragon Pung.';}else if(j==36){m='緑発';if(lang=='en') m='Green Dragon Pung.';}else if(j==37){m='白板';if(lang=='en') m='White Dragon Pung.';}else {if(lang=='en'){m='East';if(j==32) m='South';else if(j==33) m='West';else if(j==34) m='North';else m=m+' Wind';}else {m='東';if(j==32) m='南';else if(j==33) m='西';else if(j==34) m='北';if(k>1) m=m+'連風';else m=m+'風';}}yakutbl[yakutbl_ctr]=m;yfantbl[yakutbl_ctr++]=k;fan+=k;}if(!tm_baxianguohai[jia]){hb=[0, 0, 0, 0, 0, 0, 0, 0];tbf=[0, 0, 0, 0, 0, 0, 0, 0];i=ndr_ctr[jia]; while(--i>=0){if((j=ndr[jia][i])>39 && j<48) tbf[j-40]++;}hb[menfeng[jia]-31]++;if((k=hb[0])>0 && tbf[0]>0){yakutbl[yakutbl_ctr]='春牌';if(lang=='en') yakutbl[yakutbl_ctr]='Spring Flower Tile';yfantbl[yakutbl_ctr++]=k;fan+=k;}if((k=hb[1])>0 && tbf[1]>0){yakutbl[yakutbl_ctr]='夏牌';if(lang=='en') yakutbl[yakutbl_ctr]='Summer Flower Tile';yfantbl[yakutbl_ctr++]=k;fan+=k;}if((k=hb[2])>0 && tbf[2]>0){yakutbl[yakutbl_ctr]='秋牌';if(lang=='en') yakutbl[yakutbl_ctr]='Autumn Flower Tile';yfantbl[yakutbl_ctr++]=k;fan+=k;}if((k=hb[3])>0 && tbf[3]>0){yakutbl[yakutbl_ctr]='冬牌';if(lang=='en') yakutbl[yakutbl_ctr]='Winter Flower Tile';yfantbl[yakutbl_ctr++]=k;fan+=k;}if((k=hb[0])>0 && tbf[4]>0){yakutbl[yakutbl_ctr]='梅牌';if(lang=='en') yakutbl[yakutbl_ctr]='Plum Flower Tile';yfantbl[yakutbl_ctr++]=k;fan+=k;}if((k=hb[1])>0 && tbf[5]>0){yakutbl[yakutbl_ctr]='蘭牌';if(lang=='en') yakutbl[yakutbl_ctr]='Orchid Flower Tile';yfantbl[yakutbl_ctr++]=k;fan+=k;}if((k=hb[2])>0 && tbf[6]>0){yakutbl[yakutbl_ctr]='菊牌';if(lang=='en') yakutbl[yakutbl_ctr]='Chrysanthemum Flower Tile';yfantbl[yakutbl_ctr++]=k;fan+=k;}if((k=hb[3])>0 && tbf[7]>0){yakutbl[yakutbl_ctr]='竹牌';if(lang=='en') yakutbl[yakutbl_ctr]='Bamboo Flower Tile';yfantbl[yakutbl_ctr++]=k;fan+=k;}k=0;if(tbf[0]+tbf[1]+tbf[2]+tbf[3]>3) k+=2;if(tbf[4]+tbf[5]+tbf[6]+tbf[7]>3) k+=2;if(k>0){yakutbl[yakutbl_ctr]='花槓';if(lang=='en'){yakutbl[yakutbl_ctr]='A Set of Four Flower Tiles';if(k>2) yakutbl[yakutbl_ctr]='Sets of Four Flower Tiles';}yfantbl[yakutbl_ctr++]=k;fan+=k;}}if(mm) break;i=yakutbl_ctr; while(--i>=0){yakutbl2[i]=yakutbl[i];yfantbl2[i]=yfantbl[i];}yakutbl_ctr2=yakutbl_ctr;fan2=fan;fan=0;if(fdat_disp){i=20; while(--i>=0) fdat2.te[i]=fdat[jia].te[i];i=20; while(--i>0) fdat[jia].te[i]=te[jia][i];}MENZI_3(jia);++mm;}if(fan2>fan){i=yakutbl_ctr2; while(--i>=0){yakutbl[i]=yakutbl2[i];yfantbl[i]=yfantbl2[i];}yakutbl_ctr=yakutbl_ctr2;fan=fan2;if(fdat_disp){i=20; while(--i>=0) fdat[jia].te[i]=fdat2.te[i];}}if(lingshang!=0 && ronghe==0){yakutbl[yakutbl_ctr]='槓上開花';if(lang=='en') yakutbl[yakutbl_ctr]='Out with Replacement Tile';yfantbl[yakutbl_ctr++]=1;fan++;}else {if(qianggang!=0 && ronghe!=0){yakutbl[yakutbl_ctr]='搶槓胡';if(lang=='en') yakutbl[yakutbl_ctr]='Robbing The Kong';yfantbl[yakutbl_ctr++]=1;fan++;}if(zampai==0){i='海底摸月';if(ronghe!=0){i='河底撈魚';if(lang=='en') i='Last Tile Claim';}else if(lang=='en') i='Last Tile Draw';yakutbl[yakutbl_ctr]=i;yfantbl[yakutbl_ctr++]=1;fan++;}}if(yakutbl_ctr<1){yakutbl[yakutbl_ctr]='役無し';if(lang=='en') yakutbl[yakutbl_ctr]='No Points';yfantbl[yakutbl_ctr++]=0;}yakustatus_fan=fan;pay0=pay2=fan+5;yakustatus_pts=pay2;return(pay2);}
