function newTextArea_2(id, x, y, w, h, fontSize, bgColor, fgColor){x1=x;if(grMode) x1=x1-(dWidthP >> 1)+(dWidthL >> 1);newTextArea(id, x1, y, w, h, fontSize, bgColor, fgColor);}function drawText_2(txt, x, y, w, h, bold, fontSize, lineHeight, bgColor, fgColor, alignment){var x1=x;if(grMode) x1=x1-(dWidthP >> 1)+(dWidthL >> 1);drawText(txt, x1, y, w, h, bold, fontSize, lineHeight, bgColor, fgColor, alignment);}function drawTextMincho_2(txt, x, y, w, h, bold, fontSize, lineHeight, bgColor, fgColor, alignment){var x1=x;if(grMode) x1=x1-(dWidthP >> 1)+(dWidthL >> 1);drawTextMincho(txt, x1, y, w, h, bold, fontSize, lineHeight, bgColor, fgColor, alignment)}function makeClickable_2(inputKeyNumber, x, y, w, h, aKey){var x1=x;if(grMode) x1=x1-(dWidthP >> 1)+(dWidthL >> 1);makeClickable(inputKeyNumber, x1, y, w, h, aKey);}function makeClickable2_2(inputKeyNumber, x, y, w, h, aKey){var x1=x;if(grMode) x1=x1-(dWidthP >> 1)+(dWidthL >> 1);makeClickable2(inputKeyNumber, x1, y, w, h, aKey);}function putRectangleAbs_2(dx, dy, ex, ey, color){var dx1=dx;var ex1=ex;if(grMode){dx1=dx1-(dWidthP >> 1)+(dWidthL >> 1);ex1=ex1-(dWidthP >> 1)+(dWidthL >> 1);}putRectangleAbs(dx1, dy, ex1, ey, color);}function putRectangle_2(dx, dy, w, h, color){var dx1=dx;if(grMode){dx1=dx1-(dWidthP >> 1)+(dWidthL >> 1);}putRectangle(dx1, dy, w, h, color);}function PAI_DISP(pc, x, y, d, dark){var i, j, sx, sy, p=pc % 100, dw, dh, bh;if(gameMode==GAMEMODE_TAIWAN || gameMode==GAMEMODE_GUOJI){if(gameMode==GAMEMODE_GUOJI && p>=40 && p<44) p=38;else if(p==37) p=48;else if(p==35) p=37;}if(d==16 || d==66 || d==-1){dw=25; dh=31; bh=8;if(d==66){ dw=30; dh=36; bh=12; }if(d<0){ dw=60; dh=72; bh=17; }if(pc<0){putPartOfImage(image, 270, 320, 29, 10, x, y, dw, bh);putPartOfImage(image, 270, 330, 29, 39, x, y+bh-1, dw, dh);return;}sx=-30; sy=0;i=p % 10; j=Math.floor((p % 50) / 10);if(p==55 || p==65 || p==75) i=10;sx+=30*i; sy=j*40;if(p>39 && p<50){sy=376; sx=30*(p-40);}putPartOfImage(image, 270, 133, 29, 12, x, y, dw, bh);putPartOfImage(image,  sx,  sy, 29, 39, x, y+bh-1, dw, dh);if(dark) putRectangle(x, y, pw, ph+bh, 'rgba(0, 0, 0, 0.20)');return;}if(d==20){sx=330; sy=300;i=p % 10; j=Math.floor((p % 50) / 10);if(p==55 || p==65 || p==75) i=10;sy-=30*i; sx+=j*40;if(p>39 && p<50){sx=608; sy=565-30*(p-40);}putPartOfImage(image, 330, 340, 39, 10, x, y, 31, 12);putPartOfImage(image,  sx,  sy, 39, 29, x, y+9, 31, 25);return;}if(d==-3){sx=330; sy=300;i=p % 10; j=Math.floor((p % 50) / 10);if(p==55 || p==65 || p==75) i=10;sy-=30*i; sx+=j*40;if(p>39 && p<50){sx=608; sy=565-30*(p-40);}putPartOfImage(image, 330, 340, 39, 10, x, y, 72, 18);putPartOfImage(image,  sx,  sy, 39, 29, x, y+18, 72, 59);return;}if(d==-10){if(pc<0){putPartOfImage(image, 330, 300, 39, 29, x, y, 72, 60);return;}sx=330; sy=300;i=p % 10; j=Math.floor((p % 50) / 10);if(p==55 || p==65 || p==75) i=10;sy-=30*i; sx+=j*40;if(p>39 && p<50){sx=608; sy=565-30*(p-40);}putPartOfImage(image,  sx,  sy, 39, 29, x, y, 72, 59);return;}dw=25; dh=31; bh=12;if(d>39){ dw=30; dh=36; bh=15; }if(d<0){ dw=60; dh=72; bh=28; }if(pc<0 && !(d & 1)){putPartOfImage(image, 240, 359, 29, 10, x, y+dh-1, dw, bh);putPartOfImage(image, 240, 320, 29, 39, x, y, dw, dh);return;}if(d==0 || d==40 || d==-50 || d==-2){sx=-30; sy=0;i=p % 10; j=Math.floor((p % 50) / 10);if(p==55 || p==65 || p==75) i=10;sx+=30*i; sy=j*40;if(p>39 && p<50){sy=376; sx=30*(p-40);}if(d>-50) putPartOfImage(image, 300, 0, 29, 10, x, y+dh-1, dw, bh);putPartOfImage(image, sx,  sy, 29, 39, x, y, dw, dh);if(dark) putRectangle(x, y, dw, dh+bh-1, 'rgba(0, 0, 0, 0.20)');return;}if(d==2 || d==42){sx=300; sy=280;i=p % 10; j=Math.floor((p % 50) / 10);if(p==55 || p==65 || p==75) i=10;sx-=30*i; sy-=j*40;if(p>39 && p<50){sy=416; sx=240-30*(p-40);}putPartOfImage(image,  300, 0, 29, 10, x, y+dh-1, dw, bh);putPartOfImage(image,  sx,  sy, 29, 39, x, y, dw, dh);if(dark) putRectangle(x, y, dw, dh+bh-1, 'rgba(0, 0, 0, 0.20)');return;}i=dw; dw=dh; dh=i;if(pc<0){putPartOfImage(image, 330, 329, 39, 10, x, y+dh-1, dw, bh);putPartOfImage(image, 330, 300, 39, 29, x, y, dw, dh);return;}if(d==1 || d==41 || d==-51){sx=330; sy=300;i=p % 10; j=Math.floor((p % 50) / 10);if(p==55 || p==65 || p==75) i=10;sy-=30*i; sx+=j*40;if(p>39 && p<50){sx=608; sy=565-30*(p-40);}if(d>-50) putPartOfImage(image, 370, 300, 39, 10, x, y+dh-1, dw, bh);putPartOfImage(image,  sx,  sy, 39, 29, x, y, dw, dh);if(dark) putRectangle(x, y, dw, dh+bh-1, 'rgba(0, 0, 0, 0.20)');return;}sx=610; sy=-30;i=p % 10; j=Math.floor((p % 50) / 10);if(p==55 || p==65 || p==75) i=10;sy+=30*i; sx-=j*40;if(p>39 && p<50){sx=608; sy=595+30*(p-40);}putPartOfImage(image, 370, 300, 39, 10, x, y+dh-1, dw, bh);putPartOfImage(image,  sx,  sy, 39, 29, x, y, dw, dh);if(dark) putRectangle(x, y, dw, dh+bh-1, 'rgba(0, 0, 0, 0.20)');}blink_ctr=0;function DAPAI_DISP(jia){var i, j, k, l, x, y, x1, y1, w, h, xx, yy, yy1, yy2, dk;var dx, dy=0, d=tm_dapaiBuff;var pw=26, ph=31, bh=12, pmode=0;if(grMode){ pw=31; ph=37; bh=15; pmode=40; }if(d<1 || (d %= 50)<1 || d>40) d=-1;if(gameMode==GAMEMODE_TAIWAN){var w1=65, h1=43;var w2=33, h2=68;var xo=33, dy=0;dx=0; if(grMode){dx=200; dy=-50;h1=54;w2=38; h2=74;xo=40;}putRectangle(63+dx, 92, w1, h1, bg_color);if(jia==2 && d>0){x=63+dx; y=92;PAI_DISP(d, x, y, pmode+2, false);tm_arrowX=63+dx+pw;tm_arrowY=92;tm_arrowD=0;}x=383; y=130;if(grMode) x=700;putRectangle(x, y, w2, h2, bg_color);if(jia==1 && d>0){PAI_DISP(d, x, y, pmode+1, false);tm_arrowX=x;tm_arrowY=158;tm_arrowD=3;}x=63; y=348;if(grMode) x=214;putRectangle(x, y, w2, h2-6, bg_color);if(jia==3 && d>0){PAI_DISP(d, x, y, pmode+3, false);tm_arrowX=x;tm_arrowY=y-pw;tm_arrowD=1;}if(grMode){y=92+dy+xo; i=0; while(++i<10){x=260;if(i<2) x-=xo*3;j=-1; while(++j<11){x1=x; y1=y;if(tm_dapaiDir[i][j] & 1) y1+=tm_dapaiDxy[i][j];else x1+=tm_dapaiDxy[i][j];if((k=tm_dapai[i][j])>0){PAI_DISP(k % 100, x1, y1, pmode+tm_dapaiDir[i][j], false);}x+=xo;}y+=xo;}}else {y=92; i=-1; while(++i<11){x=63; j=-1; while(++j<11){x1=x; y1=y;if(tm_dapaiDir[i][j] & 1) y1+=tm_dapaiDxy[i][j];else x1+=tm_dapaiDxy[i][j];if((k=tm_dapai[i][j])>0){PAI_DISP(k % 100, x1, y1, pmode+tm_dapaiDir[i][j], false);}x+=xo;}y+=xo;}}x=383; y=403;if(grMode) x=690;putRectangle(x, y, pw+1, h1, bg_color);if(jia==0 && d>0){PAI_DISP(d, x, y, pmode+0, false);tm_arrowX=x-pw;tm_arrowY=y;tm_arrowD=2;}TM_NUKIDORA_2();TM_NUKIDORA_1();TM_NUKIDORA_3();TM_NUKIDORA_0();return;}var tp=new Array(), tpc=0;tpc=-1; while(++tpc<dc[jia]) tp[tpc]=dp[jia][tpc];i=21;if(gameMode==GAMEMODE_PENGLI) i=24;else if(gameMode==GAMEMODE_SAMMA) i=18;else if(players==3) i=19;if(tpc>=i){tp[i-1]=tp[tpc-1];tp[i]=dp[jia][tpc];tpc=i;}else {tp[tpc]=dp[jia][tpc];}if(jia==0){if(tpc<0) return;xx=(dWidth >> 1)-pw*3;yy1=328;if(grMode){ yy1=342; }yy2=yy1+2*ph;putRectangle(xx, yy1, pw*5+ph+2, ph*3+bh, bg_color);if(gameMode==GAMEMODE_PENGLI){putRectangle(xx, yy2, pw*9+ph+2, ph+bh, bg_color);}else if(gameMode==GAMEMODE_SAMMA){}else if(players==3){putRectangle(xx, yy2, pw*6+ph+2, ph+bh, bg_color);}else if(opened[1]==2 && fdat_disp && fdat[1].dat[0]>0){putRectangle(xx, yy2, pw*8.8+ph, ph+bh, bg_color);}else {putRectangle(xx, yy2, pw*9+ph+2, ph+bh, bg_color);}x=xx; y=yy1;i=-1; while(++i<tpc){if(i==6 || i==12){ y+=ph; x=xx; }j=tp[i];dk=(j>1000);if((j % 1000)>100){PAI_DISP(j % 100, x, y+ph-pw, 1+pmode, dk);x+=ph; continue;}else PAI_DISP(j, x, y, pmode, dk);x+=pw;}if((j=tp[tpc])==39 || j==79){ARROW_DISP(x, y+ph-24, 0);}return;}if(jia==2 && players!=3){xx=(dWidth >> 1)-pw*3;yy=74;pmode=2; if(grMode){pmode=42;yy=80;}putRectangle(xx-ph+pw, yy, pw*5+ph, ph*3+bh+2, bg_color);putRectangle(xx-ph-pw*2, yy, pw*3, ph+bh+2, bg_color);xx=(dWidth >> 1)+pw*2;y=yy;if(tpc>11){x=xx; i=11; while(++i<tpc){j=tp[i];dk=(j>1000);if((j % 1000)>100){PAI_DISP(j % 100, x-(ph-pw), y, pmode+1, dk);x-=ph;continue;}PAI_DISP(j, x, y, pmode, dk);x-=pw;}if(tpc>12 && (j=tp[tpc])==39 || j==79){ARROW_DISP(x, y, 2);}}y+=ph; if(tpc>5){l=tpc; if(l>12) l=12;x=xx; i=5; while(++i<l){j=tp[i];dk=(j>1000);if((j % 1000)>100){PAI_DISP(j % 100, x-(ph-pw), y, pmode+1, dk);x-=ph;continue;}PAI_DISP(j, x, y, pmode, dk);x-=pw;}if(tpc>6 && tpc<13 && ((j=tp[tpc])==39 || j==79)){ARROW_DISP(x, y, 2);}}y+=ph; l=tpc; if(l>6) l=6;x=xx; i=-1; while(++i<l){j=tp[i];dk=(j>1000);if((j % 1000)>100){PAI_DISP(j % 100, x-(ph-pw), y, pmode+1, dk);x-=ph;continue;}PAI_DISP(j, x, y, pmode, dk);x-=pw;}if(tpc<7 && ((j=tp[tpc])==39 || j==79)){ARROW_DISP(x, y, 2);}if(!grMode && gameMode==GAMEMODE_GUOJI){NUKIDORA_3();}return;}if(jia==1){xx=(dWidth >> 1)+(pw << 2)-(pw >> 1)-6;var yy=324;if(players==3){yy=303;}pmode=2; if(grMode){pmode=42;if(players!=3){yy=368;}else yy=343;xx+=(ph >> 1);if(gameMode==GAMEMODE_PENGLI) yy=388;}else if(gameMode==GAMEMODE_PENGLI) yy=317;putRectangle(xx, yy-pw*5-ph-2, ph*3+1, pw*5+ph+bh+2, bg_color);if(gameMode==GAMEMODE_PENGLI){putRectangle(xx+2*ph-2, yy-pw*10-ph, ph+3, yy-pw*5-ph-2, bg_color);}else if(gameMode==GAMEMODE_BEINUKI){putRectangle(xx+2*ph-2, yy-pw*6-ph, ph+3, pw*5-ph-2, bg_color);}else {putRectangle(xx+2*ph-2, yy-pw*8-ph, ph+3, pw*5-ph-2, bg_color);}if(tpc>11){x=xx+ph+ph; y=yy;i=11; while(++i<tpc){j=tp[i];if((j % 1000)>100){ y-=ph; continue; }y-=pw;}if(tpc>11 && (j=tp[tpc])==39 || j==79){ARROW_DISP(x, y-ph, 1);}i=tpc; while(--i>11){j=tp[i];dk=(j>1000);if((j % 1000)>100){PAI_DISP(j % 100, x+ph-pw, y, pmode, dk);y+=ph; continue;}PAI_DISP(j, x, y, pmode-1, dk);y+=pw;}}if(tpc>5){x=xx+ph; y=yy;if((l=tpc)>12) l=12;i=l; while(--i>5){j=tp[i];if((j % 1000)>100){ y-=ph; continue; }y-=pw;}if(tpc>6 && (tpc<13) && (j=tp[tpc])==39 || j==79){ARROW_DISP(x, y-ph, 1);}i=l; while(--i>5){j=tp[i];dk=(j>1000);if((j % 1000)>100){PAI_DISP(j % 100, x+ph-pw, y, pmode, dk);y+=ph; continue;}PAI_DISP(j, x, y, pmode-1, dk);y+=pw;}}x=xx; y=yy;if((l=tpc)>6) l=6;i=-1; while(++i<l){j=tp[i];if((j % 1000)>100){ y-=ph; continue; }y-=pw;}if(tpc<7 && (j=tp[tpc])==39 || j==79){ARROW_DISP(x, y-ph, 1);}i=l; while(--i>-1){j=tp[i];dk=(j>1000);if((j % 1000)>100){PAI_DISP(j % 100, x+ph-pw, y, pmode, dk);y+=ph; continue;}PAI_DISP(j, x, y, pmode-1, dk);y+=pw;}if(!grMode){NUKIDORA_1();FULOU_1();}return;}xx=(dWidth >> 1)-(pw << 2)-pw+6;var yy=168;if(gameMode==GAMEMODE_PENGLI){yy=102;if(grMode) yy=44;}else if(players==3){yy=96;if(grMode){yy=60;}yy+=pw+pw;}pmode=0; if(grMode){pmode=40;xx-=(ph >> 1);}x=xx; y=yy;putRectangle(x-2*ph-1, yy-1, ph*3+2, pw*5+ph+bh+1, bg_color);i=1; if(gameMode==GAMEMODE_PENGLI) i=4;if(gameMode==GAMEMODE_SAMMA) i=0;putRectangle(x-2*ph-1, yy+pw*6, ph+2, pw*i+ph+bh, bg_color);i=-1; while(++i<tpc){if(i==6 || i==12){x-=ph; y=yy;}j=tp[i];dk=(j>1000);if((j % 1000)>100){PAI_DISP(j % 100, x, y, pmode+0, dk);y+=ph;continue;}else PAI_DISP(j, x, y, pmode+3, dk);y+=pw;}if((j=tp[tpc])==39 || j==79){ARROW_DISP(x, y, 3);}return;}function SHUPAI_DISP(jia){var i, j, k, l, m, x, y, xx, yy;var pw=26, ph=32, bh=12, pmode=0;if(grMode){ pw=31; ph=37; bh=15; pmode=40; }var ndd=new Array(16);if(gameMode==GAMEMODE_TAIWAN){if(!grMode){putRectangle(0, 0, 480, 64, bg_color);putRectangle(0, 432, 480, 86, bg_color);putRectangle(-14, 0, 60, 519, bg_color);putRectangle(456, 0, 60, 519, bg_color);putRectangleAbs(-1, 555, -1, 719, bg_color);putRectangleAbs(-1, 522, -1, 555, menu_bgcolor);}else {putRectangle(258, 7, 480, 42, bg_color);putRectangle(745, 0, 92, 470, bg_color);putRectangle(140, 0, 56, 470, bg_color);putRectangleAbs(0, 480, 960, 640, bg_color);putRectangleAbs(886, 430, 960, 469, bg_color);}TM_SHUPAI_2();TM_SHUPAI_1();TM_SHUPAI_3();TM_SHUPAI_0();if(grMode){i=887; if(te[0][14]<1 && (te[0][15]<1 || fdat_disp=='' || opened[0]!=2)) i=-1;putRectangleAbs(-1, 470, -1, 471, menu_border);putRectangleAbs(-1, 472, -1, 500, menu_bgcolor);}return;}if(jia==0){if(grMode){putRectangleAbs(-1, 470, -1, 640, bg_color);putRectangleAbs(-1, 470, -1, 471, menu_border);putRectangleAbs(-1, 472, -1, 500, menu_bgcolor);NUKIDORA_0Y();x=900; y=546;if(fulou_dir) x=840-fc[0]*180;if(opened[0]!=2){i=15; while(--i>fc[0]*3){j=te[0][i] % 100;if(j>0){PAI_DISP(j, x, y, -1, false);}x-=60;}}else {i=15; if(opened[0]==2 && fdat_disp && (j=te[0][15])>0){PAI_DISP(j % 100, x, y, -2, true);--i; x-=60;}while(--i>fc[0]*3){j=te[0][i] % 100;if(j>0) PAI_DISP(j, x, y, -2, false);x-=60;}}}else {disped_player=1; if(fc[0]>1) console_mode=disped_player=0;xx=38; if(!fulou_dir) xx-=8;putRectangle(xx, 464, 394, 55, bg_color);putRectangleAbs(-1, 556, -1, 719, bg_color);if(opened[0]!=2){x=398; y=466;if(fulou_dir) x=376-fc[0]*78;i=15; while(--i>fc[0]*3){j=te[0][i] % 100;if(j>0){PAI_DISP(j, x, y, 16, false);if(i==14 ||    (!console_mode && i>6) ||    (console_mode && i>fc[0]*3 && i<fc[0]*3+8)    ){putPartOfImage(image, 300, 160, 26, 16, x, y+42, 26, 10);}}x-=26;}y=600; x=0; k=-1; i=fc[0]*3; l=15;if(!console_mode || fc[0]>2) i=6;while(++k<7){j=te[0][++i] % 100;if(j>0) PAI_DISP(j, x, y, -1, false);x+=60;}if((j=te[0][14] % 100)>0){PAI_DISP(j, 420, y, -1, false);}}else {x=398; y=458;if(fulou_dir) x=376-fc[0]*78;i=15;if(opened[0]==2 && fdat_disp && (j=te[0][15])>0){PAI_DISP(j % 100, x, y, 0, true);--i; x-=26;}while(--i>fc[0]*3){j=te[0][i] % 100;if(j>0) PAI_DISP(j, x, y, 0, false);x-=26;}y=600; x=0; k=-1; i=fc[0]*3; l=15;if(!console_mode || fc[0]>2) i=6;while(++k<7){j=te[0][++i] % 100;if(j>0) PAI_DISP(j, x, y, -2, false);x+=60;}if((j=te[0][14] % 100)>0){PAI_DISP(j, 420, y, -2, false);}}}x=0; y=502; if(!grMode){y=558;if(fc[0]<2){if(console_mode){putRectangle(0, y, 89, 43, button_color);s=(lang=='') ? '[*]右側' : 'Right'+String.fromCharCode(9654);drawText(s, 45, y+9, 60, 24, false, 24, 24, null, button_text, 'center');makeClickable_callback(HAND_CHANGER, 0, y, 89, 43, '*');}else  {putRectangle(0, y, 89, 43, button_color);s=(lang=='') ? '[*]左側' : String.fromCharCode(9664)+' Left';drawText(s, 45, y+9, 60, 24, false, 24, 24, null, button_text, 'center');makeClickable_callback(HAND_CHANGER, 0, y, 89, 43, '*');}x=90;}}if(gameMode==GAMEMODE_GUOJI && fc[0]<2){if(lang==''){if(!grMode){i='[9]理牌';}else {i='理　牌';}}else {i='Sort';}putRectangle(x, y, 89, 43, button_color);drawText(i, x+45, y+9, 60, 24, false, 24, 24, null, button_text, 'center');makeClickable_callback(SORT_CHANGER, x, y, 89, 43, '9');}if(grMode){x=0; y=570;if(fulou_dir) x=dWidth;k=-5; i=fc[0]; while(--i>=0){k+=5;if((j=fl[0][k+4])>0){var yy=y;if(fulou_dir) x-=192;var p1=fl[0][k+0];var p2=fl[0][k+1];var p3=fl[0][k+2];var p4=fl[0][k+4];q=-50;if(gameMode==GAMEMODE_GUOJI){if(opened[0]==2 && fdat_disp) p1=p3=-1;else if(!opened[0]) p2=p3=p4=-1, q=-1, yy=y-18;}else p1=p3=-1;PAI_DISP(p1, x, yy, q, false);PAI_DISP(p2, x+60, y-48, -10, false);PAI_DISP(p4, x+60, y+12, -10, false);PAI_DISP(p3, x+132, y, -50, false);if(p4>2000){if(!fulou_dir){ARROW_DISP(x+134, y-50, -202);}else {ARROW_DISP(x+12, y-50, -200);}}if(!fulou_dir) x+=192;continue;}var x1=x-192;if(fulou_dir) x=x1;if((m=fl[0][k])>100){if((j=fl[0][k+3])>0){PAI_DISP(j % 100, x, y-48, -10, false);if(j>2000){if(!fulou_dir){ARROW_DISP(x+74, y-50, -202);}else {ARROW_DISP(x-40, y-50, -200);}}}PAI_DISP(m % 100, x, y+12, -10, false);x+=12;}else PAI_DISP(m % 100, x, y, -50, false);x+=60; if((m=fl[0][k+1])>100){if((j=fl[0][k+3])>0){PAI_DISP(j % 100, x, y-48, -10, false);if(j>2000){if(!fulou_dir){ARROW_DISP(x+74, y-50, -202);}else {ARROW_DISP(x-40, y-50, -200);}}}PAI_DISP(m % 100, x, y+12, -10, false);x+=12;}else PAI_DISP(m % 100, x, y, -50, false);x+=60; if((m=fl[0][k+2])>100){if((j=fl[0][k+3])>0){PAI_DISP(j % 100, x, y-48, -10, false);if(j>2000){if(!fulou_dir){ARROW_DISP(x+74, y-50, -202);}else {ARROW_DISP(x-40, y-50, -200);}}}PAI_DISP(m % 100, x, y+12, -10, false);x+=12;}else PAI_DISP(m % 100, x, y, -50, false);x+=60;if(fulou_dir) x=x1;}}else {FULOU_0();NUKIDORA_0();}if(opened[0]==2 && fdat_disp && fdat[0].dat[0]>0){if(grMode){x=960; y=518;if(fulou_dir) x=900-fc[0]*180;i=5; while(--i>fc[0]-1){if((j=fdat[0].dat[i])==0) break;j=Math.floor(j / 1000);putRectangle(x-60*j, y, 60*j, 30, "rgba(0,0,0,0.6)");putRectangle(x-60*j+2, y+15, 60*j-5, 2, "#fff");putRectangle(x-60*j+2, y+15, 2, 15, "#fff");putRectangle(x-4, y+15, 2, 15, "#fff");drawText(fdat[0].dat[i] % 100, x-(60*j/2), y, 30, 30, true, 30, 30, '#000', '#fff', 'center');x-=60*j;}x=0; y=542;if(fulou_dir) x=dWidth;i=-1; while(++i<fc[0]){if(fulou_dir) x-=192;putRectangle(x, y, 192, 30, "rgba(0,0,0,0.6)");putRectangle(x+2, y+15, 189, 2, "#fff");putRectangle(x+2, y+15, 2, 15, "#fff");putRectangle(x+190, y+15, 2, 15, "#fff");drawText(fdat[0].dat[i] % 100, x+96, y, 30, 30, true, 30, 30, "#000", "#fff", 'center');if(!fulou_dir) x+=192;}}else {x=424; y=458;if(fulou_dir) x=402-fc[0]*78;i=5; while(--i>fc[0]-1){if((j=fdat[0].dat[i])==0) break;j=Math.floor(j / 1000);putRectangle(x-26*j, y+32, 26*j, 24, "rgba(0,0,0,0.6)");putRectangle(x-26*j+2, y+44, 26*j-4, 2, "#fff");putRectangle(x-26*j+2, y+32, 2, 12, "#fff");putRectangle(x-4, y+32, 2, 12, "#fff");drawText(fdat[0].dat[i] % 100, x-(26*j/2)+1, y+32, 24, 24, true, 24, 24, '#000', '#fff', 'center');x-=26*j;}x=28; y=478;if(fulou_dir) x=427;i=-1; while(++i<fc[0]){if(fulou_dir) x-=84;putRectangle(x, y-24, 84, 24, "rgba(0,0,0,0.6)");putRectangle(x+2, y-12, 79, 2, "#fff");putRectangle(x+2, y-12, 2, 12, "#fff");putRectangle(x+80, y-12, 2, 12, "#fff");drawText(fdat[0].dat[i] % 100, x+42, y-24, 24, 24, true, 24, 24, "#000", "#fff", 'center');if(!fulou_dir) x+=84;}}}return;}if(jia==2 && players!=3){xx=(dWidth >> 1)-7*pw;i=(fulou_dir) ? 10.1 : 9.8;putRectangle(xx, 1, pw*i+ph*4, pw+pw+bh+2, bg_color);if(fulou_dir){if(!grMode && fc[1]>0){FULOU_1();}xx+=pw+fc[2]*3*pw;}if(!opened[2]){pmode=16; if(grMode) pmode=66;x=xx; y=2; i=15; while(--i>fc[2]*3){j=te[2][i] % 100;if(j>0) PAI_DISP(-1, x, y, pmode, false);x+=pw;}}else {pmode=2; if(grMode) pmode=42;x=xx; y=6; i=15; while(--i>fc[2]*3){j=te[2][i] % 100;if(j>0) PAI_DISP(j, x, y, pmode, opened[2]!=2);x+=pw;}if(opened[2]==2 && fdat_disp && (j=te[2][15])>0){PAI_DISP(j % 100, xx, y, pmode, true);}}FULOU_2();NUKIDORA_2();if(opened[2]==2 && fdat_disp && fdat[2].dat[0]>0){x=xx; y=12; i=5; while(--i>fc[2]-1){if((j=fdat[2].dat[i])==0) break;j=Math.floor(j / 1000);putRectangle(x, y+ph, pw*j, 24, "rgba(0,0,0,0.6)");putRectangle(x+2, y+ph+11, pw*j-4, 2, "#fff");putRectangle(x+2, y+ph, 2, 12, "#fff");putRectangle(x+pw*j-3, y+ph, 2, 12, "#fff");drawText(fdat[2].dat[i] % 100, x+(pw*j/2), y+ph, 24, 24, true, 24, 24, '#000', '#fff', 'center');x+=pw*j;}}return;}pmode=0; if(grMode){ pmode=40; }if(jia==1){xx=450;yy=38; y=37; i=519;if(grMode){y=yy=0; i=470+pw;xx=784;if(fulou_dir) yy=fc[1]*(pw+pw+pw)-4;}else if(fulou_dir){y=458-pw*14;yy=y+fc[1]*3*pw;}putRectangle(xx+(pw-bh)-2, y, bh+6, pw, bg_color);putRectangleAbs(xx, y+pw, xx+pw+pw+2, i-pw, bg_color);if(fulou_dir) FULOU_1();if(!opened[1]){x=xx+(ph >> 1);y=yy;i=15; while(--i>fc[1]*3){j=te[1][i] % 100;if(j>0){putPartOfImage(image, 510, 299, 12, 39, x, y+pw, bh, ph);putPartOfImage(image, 510, 270, 12, 29, x, y, bh, pw);}y+=pw;}}else {x=xx;y=yy+ph-bh+3; i=15;if(opened[1]==2 && fdat_disp){if((j=te[1][15] % 100)>0){PAI_DISP(j, x, y, pmode+1, true);--i; y+=pw;}}while(--i>fc[1]*3){j=te[1][i] % 100;if(j>0) PAI_DISP(j, x, y, pmode+1, opened[1]!=2);y+=pw;}}if(!fulou_dir) FULOU_1();NUKIDORA_1();if(opened[1]==2 && fdat_disp && fdat[1].dat[0]>0){x=xx-24;y=yy+pw-bh+8;i=5; while(--i>fc[1]-1){if((j=fdat[1].dat[i])==0) break;j=Math.floor(j / 1000);putRectangle(x, y, 24, pw*j, "rgba(0,0,0,0.6)");putRectangle(x+10, y+2, 2, pw*j-4, "#fff");putRectangle(x+10, y+2, 12, 2, "#fff");putRectangle(x+10, y+pw*j-3, 12, 2, "#fff");drawText(fdat[1].dat[i] % 100, x+12, y+(pw*j/2)-12, 24, 24, true, 24, 24, '#000', '#fff', 'center');y+=pw*j;}}return;}var jj=players-1;xx=0; yy=490;if(grMode){xx=138; yy=468;}else if(!fulou_dir) yy=450;putRectangleAbs(xx-pw+pw-2, 0, xx+ph, yy+1, bg_color);NUKIDORA_3();if(!fulou_dir) FULOU_3();if(!opened[jj]){x=xx+(ph >> 1)-bh;y=yy-(14-fc[jj]*3)*pw-ph;if(!grMode){y=54+fc[jj]*78;if(fulou_dir) y=36;}else if(fulou_dir){y=-6;}i=fc[jj]*3; while(++i<15){j=te[jj][i] % 100;if(j>0){putPartOfImage(image, 490, 299, 12, 39, x, y+pw, bh, ph);putPartOfImage(image, 490, 270, 12, 29, x, y, bh, pw);}y+=pw;}}else {x=xx;y=yy-(14-fc[jj]*3)*pw-bh+4;if(!grMode){y=60+fc[jj]*78;if(fulou_dir) y=42;}else if(fulou_dir){y=0;}i=fc[jj]*3; while(++i<15){j=te[jj][i] % 100;if(j>0) PAI_DISP(j, x, y, pmode+3, opened[jj]!=2);y+=pw;}if(opened[jj]==2 && fdat_disp && (j=te[jj][15])>0){PAI_DISP(j % 100, x, y-pw, pmode+3, true);}}if(fulou_dir) FULOU_3();if(opened[jj]==2 && fdat_disp && fdat[jj].dat[0]>0){x=xx+ph;y=60+fc[jj]*78;if(fulou_dir){y=0;if(!grMode) y=42;}else if(grMode) y=yy-(14-fc[jj]*3)*pw-bh+4;i=fc[jj]-1; while(++i<5){if((j=fdat[jj].dat[i])==0) break;j=Math.floor(j / 1000);putRectangle(x, y, 24, pw*j, "rgba(0,0,0,0.6)");putRectangle(x+12, y+2, 2, pw*j-4, "#fff");putRectangle(x, y+2, 12, 2, "#fff");putRectangle(x, y+pw*j-3, 12, 2, "#fff");drawText(fdat[jj].dat[i] % 100, x+12, y+(pw*j/2)-12, 24, 24, true, 24, 24, '#000', '#fff', 'center');y+=pw*j;}}}function SORT_CHANGER(){var p=te[0][14];te[0][14]=0;gm_lipai_sw=1;LIPAI(0);gm_lipai_sw=0;te[0][14]=p;if(console_disped) console_disped();}function FULOU_2(){var x, y, xx, yy, ph;var pw=26, ph=32, bh=12, pmode=2;if(grMode){ pw=31; ph=37; bh=15; pmode=42; }var fx=(dWidth >> 1)+4*ph;if(fulou_dir){fx=(dWidth >> 1)-pw-5*ph;}y=1; pmode=2; if(grMode) pmode=42;x=fx;k=-5; i=-1; while(++i<fc[2]){k+=5; var x1=x-pw*2-ph;if((j=fl[2][k+4])>0){var p1=fl[2][k+0];var p2=fl[2][k+1];var p3=fl[2][k+2];var p4=fl[2][k+4];if(gameMode==GAMEMODE_GUOJI){if(opened[2]==2 && fdat_disp) p1=p3=-1;else if(!opened[2]) p1=p2=p3=p4=-1;}else p1=p3=-1;PAI_DISP(p1, x, y, pmode, false);PAI_DISP(p2, x+pw, y, pmode-1, false);PAI_DISP(p4, x+pw, y+pw, pmode-1, false);PAI_DISP(p3, x+pw+ph, y, pmode, false);if(fl[2][k+4]>2000) ARROW_DISP(x+pw, y+pw+pw, 3);x+=pw*2+ph;if(!fulou_dir) x=x1;continue;}var kk=3; while(--kk>-1){if((m=fl[2][k+kk])>100){PAI_DISP(m % 100, x, y, pmode-1, false);if((j=fl[2][k+3])>0){PAI_DISP(j % 100, x, y+pw, pmode-1, false);if(j>2000) ARROW_DISP(x, y+pw+pw, 3);}x+=ph; continue;}PAI_DISP(m % 100, x, y, pmode, false);x+=pw;}if(!fulou_dir) x=x1;}if(opened[2]==2 && fdat_disp && fdat[2].dat[0]>0 && !_fu_disped[2]){x=xx; y=12; i=5; while(--i>fc[2]-1){if((j=fdat[2].dat[i])==0) break;j=Math.floor(j / 1000);putRectangle(x, y+ph, pw*j, 24, "rgba(0,0,0,0.6)");putRectangle(x+2, y+ph+11, pw*j-4, 2, "#fff");putRectangle(x+2, y+ph, 2, 12, "#fff");putRectangle(x+pw*j-3, y+ph, 2, 12, "#fff");drawText(fdat[2].dat[i] % 100, x+(pw*j/2), y+ph, 24, 24, true, 24, 24, '#000', '#fff', 'center');x+=pw*j;}y=1; x=fx;i=-1; while(++i<fc[2]){putRectangle(x, y+ph, pw+pw+ph, 24, "rgba(0,0,0,0.6)");putRectangle(x+2, y+ph+11, pw+pw+ph-4, 2, "#fff");putRectangle(x+2, y+ph, 2, 12, "#fff");putRectangle(x+pw+pw+ph-3, y+ph, 2, 12, "#fff");drawText(fdat[2].dat[i] % 100, x+(pw+pw+ph) / 2, y+ph, 24, 24, true, 24, 24, "#000", "#fff", 'center');if(fulou_dir) x+=pw+pw+ph;else x-=pw*2+ph;}_fu_disped[2]=1;}}function NUKIDORA_2(){var x, y, xx, yy, ph;var pw=26, ph=32, bh=12, pmode=2;if(grMode){ pw=31; ph=37; bh=15; pmode=42; }if(ndr_ctr[2]>0){x=(dWidth >> 1)+Math.floor(pw*4.2);y=64; if(grMode) y=72;PAI_DISP(ndr[2][0], x, y, pmode, false);drawText(ndr_ctr[2], x-Math.floor(pw*0.6), y+6, pw-2, pw-2, true, pw-2, pw-2, bg_color, '#fff', 'center');}}function NUKIDORA_1(){var x, y, xx, yy, ph, i, j, k, l, m;var pw=26, ph=32, bh=12, pmode=0;if(grMode){ pw=31; ph=37; bh=15; pmode=40; }var ndd=new Array(16);xx=440; x=458;if(grMode){xx=784;}if(fulou_dir){y=64;}if(gameMode!=GAMEMODE_SAMMA){if(ndr_ctr[1]>0){x=xx-ph+4-pw;y=390;if(!grMode){y=390-pw-(pw >> 1);if(fulou_dir){y=64;}}else {y=0;if(!fulou_dir){y=426;}}i=34; if(gameMode==GAMEMODE_GUOJI) i=38;PAI_DISP(i, x, y, pmode+1, false);drawText(ndr_ctr[1], x-Math.floor(pw * .6), y, pw-2, pw-2, true, pw-2, pw-2, bg_color, '#fff', 'center');if(ndr[1][ndr_ctr[1]-1]>2000){ARROW_DISP(x-ph, y, 2);}}}else {m=0; i=ndr_ctr[1]; while(--i>-1){ndd[i]=ndr[1][i] % 40;if(ndr[1][i]>2000){m=ndr[1][i] % 40;}}var nd2p=new Array(4), nd2n=new Array(4), nd2=0;i=-1; while(++i<ndr_ctr[1]){if((k=ndd[i])<1) continue;l=0; j=ndr_ctr[1]; while(--j>-1){if(k==ndd[j]){ndd[j]=0; ++l;}}nd2p[nd2]=k;nd2n[nd2++]=l;}if(!fulou_dir){x=xx-ph-4;yy=440; if(grMode) yy=457;y=yy-nd2*pw;i=nd2; while(--i>-1){PAI_DISP(nd2p[i], x, y, pmode+1, false);drawText(nd2n[i], x-Math.floor(pw * .6), y, pw-2, pw-2, true, pw-2, pw-2, bg_color, '#fff', 'center');if(m==nd2p[i]) ARROW_DISP(x-ph, y, 2);y+=pw;}}else {x=xx-ph-4;yy=0; y=yy; i=-1;while(++i<nd2){PAI_DISP(nd2p[i], x, y, pmode+1, false);drawText(nd2n[i], x-Math.floor(pw * .6), y, pw-2, pw-2, true, pw-2, pw-2, bg_color, '#fff', 'center');if(m==nd2p[i]) ARROW_DISP(x-ph, y, 2);y+=pw;}}}}function FULOU_1(){var i, j, k, l, m, x, y, xx, yy;var pw=26, ph=32, bh=12, pmode=0;if(grMode){ pw=31; ph=37; bh=15; pmode=40; }x=450; y=480-fc[1]*(pw+pw+ph);if(grMode){x=863; y=456-fc[1]*(pw+pw+ph);if(fulou_dir){ y=0; }}var dk=-5; k=fc[1]*5;if(fulou_dir){y=66;if(grMode && players==3) y=0;dk=5; k=-5;}i=fc[1]; while(--i>=0){k+=dk;if((j=fl[1][k+4])>0){var p1=fl[1][k+0];var p2=fl[1][k+1];var p3=fl[1][k+2];var p4=fl[1][k+4];if(gameMode==GAMEMODE_GUOJI){if(opened[1]==2 && fdat_disp) p1=p3=-1;else if(!opened[1]) p1=p2=p3=p4=-1;}else p1=p3=-1;PAI_DISP(p1, x, y, pmode+1, false);PAI_DISP(p2, x+ph-pw, y+pw, pmode+2, false);PAI_DISP(p4, x+ph-pw-pw, y+pw, pmode+2, false);PAI_DISP(p3, x, y+pw+ph, pmode+1, false);if(j>2000) ARROW_DISP(x+ph-pw*3, y+pw+((ph-pw >> 1)), 2);y+=pw+pw+ph;continue;}var kk=3; while(--kk>-1){if((m=fl[1][k+kk])>100){PAI_DISP(m % 100, x+ph-pw, y, pmode+2, false);if((j=fl[1][k+3])>0){PAI_DISP(j % 100, x+ph-pw-pw, y, pmode+2, false);if(j>2000) ARROW_DISP(x+ph-pw*3, y+((ph-pw >> 1)), 2);}y+=ph; continue;}PAI_DISP(m % 100, x, y, pmode+1, false);y+=pw;}}if(opened[1]==2 && fdat_disp && fdat[1].dat[0]>0 && !_fu_disped[1]){x=426; y=480-fc[1]*(pw+pw+ph);if(grMode){x=840; y=456-fc[1]*(pw+pw+ph);}dk=pw+pw+ph;if(fulou_dir){y=64+dk*(fc[1]-1);if(grMode && players==3) y=0;dk=-dk; k=-5;}i=fc[1]; while(--i>-1){putRectangle(x, y, 24, pw+pw+ph, "rgba(0,0,0,0.6)");putRectangle(x+10, y+2, 2, pw+pw+ph-4, "#fff");putRectangle(x+10, y+2, 12, 2, "#fff");putRectangle(x+10, y+pw+pw+ph-3, 12, 2, "#fff");drawText(fdat[1].dat[i] % 100, x+12, y+((pw+pw+ph) >> 1)-12, 24, 24, true, 24, 24, '#000', '#fff', 'center');y+=dk;}_fu_disped[1]=1;}}function NUKIDORA_3(){var i, j, k, l, m, x, y, xx, yy;var pw=26, ph=32, bh=12, pmode=0;if(grMode){ pw=31; ph=37; bh=15; pmode=40; }ndd=new Array();var jj=players-1;if(ndr_ctr[jj]<1) return;xx=0; yy=490;if(grMode){xx=138; yy=468;}else if(!fulou_dir) yy=450;if(gameMode!=GAMEMODE_SAMMA){x=xx+ph+8;y=110;if(!grMode){x+=pw;if(players==3){y=80; if(fulou_dir) y=405;}}else {y=0;if(fulou_dir){y=426;}}i=34; if(gameMode==GAMEMODE_GUOJI) i=38;PAI_DISP(i, x, y, pmode+3, false);drawText(ndr_ctr[jj], x+ph+((pw-2) >> 1), y+3, pw-2, pw-2, true, pw-2, pw-2, bg_color, '#fff', 'center');if(ndr[jj][ndr_ctr[jj]-1]>2000){ARROW_DISP(x+ph+2, y+4, 0);}}else {if(ndr_ctr[jj]>0){m=0; i=ndr_ctr[jj]; while(--i>-1){ndd[i]=ndr[jj][i] % 40;if(ndr[jj][i]>2000){m=ndr[jj][i] % 40;}}var nd2p=new Array(4), nd2n=new Array(4), nd2=0;i=-1; while(++i<ndr_ctr[jj]){if((k=ndd[i])<1) continue;l=0; j=ndr_ctr[jj]; while(--j>-1){if(k==ndd[j]){ndd[j]=0; ++l;}}nd2p[nd2]=k;nd2n[nd2++]=l;}x=xx+ph+pw+4;if(grMode) x=xx+ph+4;if(!fulou_dir){y=0;i=-1; while(++i<nd2){PAI_DISP(nd2p[i], x, y, pmode+3, false);drawText(nd2n[i], x+ph+((pw-2) >> 1), y+3, pw-2, pw-2, true, pw-2, pw-2, bg_color, '#fff', 'center');if(nd2p[i]==m) ARROW_DISP(x+ph+2, y+4, 0);y+=pw;}}else {y=457-nd2*pw;if(!grMode) y=436-nd2*pw;i=nd2; while(--i>-1){PAI_DISP(nd2p[i], x, y, pmode+3, false);drawText(nd2n[i], x+ph+((pw-2) >> 1), y+3, pw-2, pw-2, true, pw-2, pw-2, bg_color, '#fff', 'center');if(nd2p[i]==m) ARROW_DISP(x+ph+2, y+4, 0);y+=pw;}}}}}function FULOU_3(){var i, j, k, l, m, x, y, xx, yy;var pw=26, ph=32, bh=12, pmode=0;if(grMode){ pw=31; ph=37; bh=15; pmode=40; }var jj=players-1;xx=x=0; y=15;if(grMode){ xx=x=114-ph; y=0; }var dk=5; k=-5;if(fulou_dir){dk=-5; k=fc[jj]*5;y=497-bh-fc[jj]*(pw+pw+ph);if(!grMode) y=466-bh-fc[jj]*(pw+pw+ph);}i=fc[jj]; while(--i>-1){k+=dk;if((j=fl[jj][k+4])>0){var p1=fl[jj][k+0];var p2=fl[jj][k+1];var p3=fl[jj][k+2];var p4=fl[jj][k+4];if(gameMode==GAMEMODE_GUOJI){if(opened[jj]==2 && fdat_disp) p1=p3=-1;else if(!opened[jj]) p1=p2=p3=p4=-1;}else p1=p3=-1;PAI_DISP(p1, x, y, pmode+3, false);PAI_DISP(p2, x, y+pw, pmode+0, false);PAI_DISP(p4, x+pw, y+pw, pmode+0, false);PAI_DISP(p3, x, y+ph+pw, pmode+3, false);if(j>2000) ARROW_DISP(x+pw+pw, y+pw+((ph-pw >> 1)), 0);y+=pw+ph+pw;continue;}kk=-1; while(++kk<3){if((m=fl[jj][k+kk])>100){PAI_DISP(m % 100, x, y,pmode+ 0, false);if((j=fl[jj][k+3])>0){PAI_DISP(j % 100, x+pw, y, pmode+0, false);if(j>2000) ARROW_DISP(x+pw+pw, y+((ph-pw >> 1)), 0);}y+=ph;continue;}else PAI_DISP(m % 100, x, y, pmode+3, false);y+=pw;}}if(opened[jj]==2 && fdat_disp && fdat[jj].dat[0]>0 && !_fu_disped[jj]){x=xx+ph;if(!fulou_dir){y=15;if(grMode) y=0;i=-1; while(++i<fc[jj]){putRectangle(x, y, 24, pw+pw+ph, "rgba(0,0,0,0.6)");putRectangle(x+10, y+2, 2, pw+pw+ph-4, "#fff");putRectangle(x, y+2, 12, 2, "#fff");putRectangle(x, y+pw+pw+ph-3, 12, 2, "#fff");drawText(fdat[jj].dat[i] % 100, x+12, y+((pw+pw+ph) >> 1)-12, 24, 24, true, 24, 24, '#000', '#fff', 'center');y+=pw+pw+ph;}}else {y=497-bh-fc[jj]*(pw+pw+ph);if(!grMode) y=466-bh-fc[jj]*(pw+pw+ph);i=fc[jj]; while(--i>-1){putRectangle(x, y, 24, pw+pw+ph, "rgba(0,0,0,0.6)");putRectangle(x+10, y+2, 2, pw+pw+ph-4, "#fff");putRectangle(x, y+2, 12, 2, "#fff");putRectangle(x, y+pw+pw+ph-3, 12, 2, "#fff");drawText(fdat[jj].dat[i] % 100, x+12, y+((pw+pw+ph) >> 1)-12, 24, 24, true, 24, 24, '#000', '#fff', 'center');y+=pw+pw+ph;}}_fu_disped[jj]=1;}}function NUKIDORA_0Y(){var x, y, i, pw=31, ph=37;var i, j, k, l, m, dx;var ndd=new Array(16);x=(dWidth >> 1)-Math.floor(pw*6.5); y=420;if(gameMode!=GAMEMODE_SAMMA){if(ndr_ctr[0]>0){if(players==3 && fulou_dir){ x=(dWidth >> 1)+pw*7; }if(gameMode==GAMEMODE_GUOJI) x+=pw;i=34; if(gameMode==GAMEMODE_GUOJI) i=38;PAI_DISP(i, x, y, 40, false);drawText(ndr_ctr[0], x+Math.floor(pw*1.5), y+ph-pw, pw-2, pw-2, true, pw-2, pw-2, bg_color, '#fff', 'center');if(ndr[0][ndr_ctr[0]-1]>2000){ARROW_DISP(x, y-34, 1);}}}else {if(ndr_ctr[0]>0){m=0; i=ndr_ctr[0]; while(--i>-1){ndd[i]=ndr[0][i] % 40;if(ndr[0][i]>2000) m=ndr[0][i] % 40;}x=(dWidth >> 1)-pw*8; y=420; dx=pw;if(fulou_dir){x=(dWidth >> 1)+pw*7; dx=-pw;}i=-1; while(++i<ndr_ctr[0]){if((k=ndd[i])<1) continue;l=0; j=ndr_ctr[0]; while(--j>-1){if(ndd[j]==k){ndd[j]=0; l++;}}PAI_DISP(k, x, y, 40, false);drawText(l, x+(pw >> 1), y-pw-2, pw-2, pw-2, true, pw-2, pw-2, bg_color, '#fff', 'center');if(m==k) ARROW_DISP(x, y-34, 1);x+=dx;}}}}function NUKIDORA_0(){var x, y, pw=26, ph=31;var i, j, k, l, m;var ndd=new Array(16);if(gameMode==GAMEMODE_PENGLI) return;if(gameMode!=GAMEMODE_SAMMA){if(ndr_ctr[0]>0){x=90; y=410;if(players==3 && fulou_dir){ x=360; }i=34; if(gameMode==GAMEMODE_GUOJI) i=38;PAI_DISP(i, x, y, 0, false);drawText(ndr_ctr[0], x+Math.floor(pw*1.5), y+ph-pw / 2, pw-2, pw-2, true, pw-2, pw-2, bg_color, '#fff', 'center');if(ndr[0][ndr_ctr[0]-1]>2000){ARROW_DISP(x, y-30, 1);}}}else {if(ndr_ctr[0]>0){x=52; y=410; var dx=pw;if(fulou_dir){ x=400; dx=-pw; }m=0; i=ndr_ctr[0]; while(--i>-1){ndd[i]=ndr[0][i] % 40;if(ndr[0][i]>2000) m=ndr[0][i] % 40;}i=-1; while(++i<ndr_ctr[0]){if((k=ndd[i])<1) continue;l=0; j=ndr_ctr[0]; while(--j>-1){if(ndd[j]==k){ndd[j]=0; ++l;}}PAI_DISP(k, x, y, 0, false);drawText(l, x+(pw >> 1), y-pw-2, pw-2, pw-2, true, pw-2, pw-2, bg_color, '#fff', 'center');if(m==k) ARROW_DISP(x, y-30, 1);x+=dx;}}}}function FULOU_0(){var x, y, i, j, k, m;if(gameMode==GAMEMODE_TAIWAN || grMode) return;x=28; y=478;if(fulou_dir) x=427;k=-5; i=fc[0]; while(--i>=0){k+=5;if((j=fl[0][k+4])>0){var p1=fl[0][k+0];var p2=fl[0][k+1];var p3=fl[0][k+2];var p4=fl[0][k+4];var q=0;if(fulou_dir) x-=84;if(gameMode==GAMEMODE_GUOJI){if(opened[0]==2 && fdat_disp) p1=p3=-1;else if(!opened[0]) p2=p3=p4=-1, q=16;}else p1=p3=-1;PAI_DISP(p1, x, y, q, false);PAI_DISP(p4, x+25, y-21, 1, false);PAI_DISP(p2, x+26, y+6, 1, false);PAI_DISP(p3, x+57, y, 0, false);if(fl[0][k+4]>2000) ARROW_DISP(x+26, y-46, 1);if(!fulou_dir) x+=84;continue;}if(fulou_dir) x-=84;var x1=x;if((m=fl[0][k])>100){if((j=fl[0][k+3])>0){PAI_DISP(j % 100, x, y-21, 1, false);if(j>2000) ARROW_DISP(x, y-46, 1);}PAI_DISP(m % 100, x, y+6, 1, false);x+=7;}else PAI_DISP(m % 100, x, y, 0, false);x+=26; if((m=fl[0][k+1])>100){if((j=fl[0][k+3])>0){PAI_DISP(j % 100, x, y-21, 1, false);if(j>2000) ARROW_DISP(x, y-46, 1);}PAI_DISP(m % 100, x, y+6, 1, false);x+=7;}else PAI_DISP(m % 100, x, y, 0, false);x+=26; if((m=fl[0][k+2])>100){if((j=fl[0][k+3])>0){PAI_DISP(j % 100, x, y-21, 1, false);if(j>2000) ARROW_DISP(x, y-46, 1);}PAI_DISP(m % 100, x, y+6, 1, false);x+=7;}else PAI_DISP(m % 100, x, y, 0, false);x+=26;if(fulou_dir) x=x1;}}function TM_NUKIDORA_0(){var x, y, i, j, k, l, m, p, q, dx;var pw=26, pmode=0;if(grMode){ pw=31; pmode=40; }x=84; y=380; dx=pw;if(grMode){x=240; y=386;if(fulou_dir){ x=620; y=386; dx=-pw; }}else if(fulou_dir){ x=346; y=380; dx=-pw; }y+=32; i=-1; while(++i<ndr_ctr[0]){PAI_DISP(ndr[0][i], x, y, pmode, false);x+=dx;}}function TM_SHUPAI_0 (){var x, y, i, j, k, l, m, p, q, dx;var pw=26, pmode=0;if(grMode){ pw=31; pmode=40; }TM_NUKIDORA_0();if(opened[0]!=2){if(grMode){x=900; y=546;l=0; if(fc[0]>1) l=fc[0]*3-6;i=14; while(--i>l){j=te[0][i] % 100;if(j>0){PAI_DISP(j, x, y, -1, false);}x-=60;}if(fc[0]<1){i=20; while(--i>16){j=te[0][i] % 100;if(j>0){PAI_DISP(j, x, y, -1, false);}x-=60;}}if((j=te[0][14] % 100)!=0){putPartOfImage(image, 330, 340, 39, 10, 888, 474, 72, 18);PAI_DISP(j, 888, 492, -10, false);}}else {disped_player=1; if(fc[0]>2) console_mode=disped_player=0;x=420; if(fulou_dir){x-=fc[0]*78;}if((j=te[0][14] % 100)>0){PAI_DISP(j, x, 436, 20, false);}x=36; y=466;if(fulou_dir){x-=fc[0]*78;}if((j=te[0][17] % 100)!=0){PAI_DISP(j, x, y, 16, false);if(console_mode && fc[0]<1) putPartOfImage(image, 300, 160, 26, 16, x, y+42, 26, 10);}x+=26; if((j=te[0][18] % 100)!=0){PAI_DISP(j, x, y, 16, false);if(console_mode && fc[0]<1) putPartOfImage(image, 300, 160, 26, 16, x, y+42, 26, 10);}x+=26; if((j=te[0][19] % 100)!=0){PAI_DISP(j, x, y, 16, false);if(console_mode && fc[0]<1) putPartOfImage(image, 300, 160, 26, 16, x, y+42, 26, 10);}i=0; while(++i<14){x+=26; j=te[0][i] % 100;if(j>0){PAI_DISP(j, x, y, 16, false);if((!console_mode && i>5) ||    (console_mode && i>fc[0]*3-3 && i<fc[0]*3+6)    ){putPartOfImage(image, 300, 160, 26, 16, x, y+42, 26, 10);}}}y=600; x=-60; l=8; i=fc[0]*3-3;if(!console_mode || fc[0]>2) i=5;if(console_mode && fc[0]<1){x+=60; if((j=te[0][17] % 100)!=0) PAI_DISP(j, x, y, -1, false);x+=60; if((j=te[0][18] % 100)!=0) PAI_DISP(j, x, y, -1, false);x+=60; if((j=te[0][19] % 100)!=0) PAI_DISP(j, x, y, -1, false);l=5; i=0;}while(--l>-1){++i; x+=60;if((j=te[0][i] % 100)!=0) PAI_DISP(j, x, y, -1, false);}if((j=te[0][14] % 100)!=0) PAI_DISP(j, 406, 553, -10, false);putRectangleAbs(-1, 522, -1, 555, menu_bgcolor);}}else {if(grMode){if(opened[0]==2 && fdat_disp && (j=te[0][15])>0){PAI_DISP(j % 100, 888, 486, -51, true);}else if((j=te[0][14])>0){PAI_DISP(j % 100, 888, 486, -51, false);}x=900; y=546;l=0; if(fc[0]>1) l=fc[0]*3-6;i=14; while(--i>l){j=te[0][i] % 100;if(j>0) PAI_DISP(j, x, y, -2, false);x-=60;}if(fc[0]<1){i=20; while(--i>16){j=te[0][i] % 100;if(j>0) PAI_DISP(j, x, y, -2, false);x-=60;}}}else {disped_player=1; if(fc[0]>2) console_mode=disped_player=0;x=410; if(fulou_dir){x-=fc[0]*78;}if((j=te[0][14] % 100)>0){PAI_DISP(j, x, 430, 1, false);}else if(fdat_disp && (j=te[0][15])>0){PAI_DISP(j % 100, x, 430, 1, true);}y=458;x=36;if(fulou_dir){x-=fc[0]*78;}if((j=te[0][17] % 100)!=0) PAI_DISP(j, x, y, 0, false);x+=26; if((j=te[0][18] % 100)!=0) PAI_DISP(j, x, y, 0, false);x+=26; if((j=te[0][19] % 100)!=0) PAI_DISP(j, x, y, 0, false);i=0; while(++i<14){x+=26; j=te[0][i] % 100;if(j>0)  PAI_DISP(j, x, y, 0, false);}y=600; x=-60; l=8; i=fc[0]*3-3;if(!console_mode || fc[0]>2) i=5;if(console_mode && fc[0]<1){x+=60; if((j=te[0][17] % 100)!=0) PAI_DISP(j, x, y, -1, false);x+=60; if((j=te[0][18] % 100)!=0) PAI_DISP(j, x, y, -1, false);x+=60; if((j=te[0][19] % 100)!=0) PAI_DISP(j, x, y, -1, false);l=5; i=0;}while(--l>-1){++i; x+=60;if((j=te[0][i] % 100)!=0) PAI_DISP(j, x, y, -2, false);}putRectangleAbs(-1, 522, -1, 555, menu_bgcolor);}}y=502; if(!grMode){y=558;if(fc[0]<3){if(console_mode){putRectangle(0, y, 89, 43, button_color);s=(lang=='') ? '[*]右側' : 'Right'+String.fromCharCode(9654);drawText(s, 45, y+9, 60, 24, false, 24, 24, null, button_text, 'center');makeClickable_callback(HAND_CHANGER, 0, y, 89, 43, '*');}else  {putRectangle(0, y, 89, 43, button_color);s=(lang=='') ? '[*]左側' : String.fromCharCode(9664)+' Left';drawText(s, 45, y+9, 60, 24, false, 24, 24, null, button_text, 'center');makeClickable_callback(HAND_CHANGER, 0, y, 89, 43, '*');}}}if(grMode){x=0; i=-1; y=570;k=-5; i=fc[0]; while(--i>=0){k+=5;if((j=fl[0][k+4])>0){var yy=y;var p1=p2=p3=p4=j % 50;q=-50;if(opened[0]>1 && fdat_disp) p2=p4=-1;else if(!opened[0]){p1=p3=p4=-1, q=-1, yy-=18;}PAI_DISP(p1, x+54, y-60, -10, false);PAI_DISP(p2, x, yy, q, false);PAI_DISP(p3, x+60, y, -50, false);PAI_DISP(p4, x+120, y, -50, false);x+=180;continue;}if((m=fl[0][k+3])>0){PAI_DISP(m % 100, x+54, y-60, -10, false);if(m>2000) ARROW_DISP(x+12, y-62, -200);}PAI_DISP(fl[0][k] % 100, x, y, -50, false);PAI_DISP(fl[0][k+1] % 100, x+60, y, -50, false);PAI_DISP(fl[0][k+2] % 100, x+120, y, -50, false);x+=180;continue;}}else {x=36; y=478;var dx=78;if(fulou_dir){ x=376; dx=-78; }k=-5; i=fc[0]; while(--i>=0){k+=5;if((j=fl[0][k+4])>0){var p1=p2=p3=p4=j % 50;q=0;if(opened[0]>1 && fdat_disp) p2=p4=-1;else if(!opened[0]) p1=p3=p4=-1, q=16;PAI_DISP(p1, x+23, y-26, 1, false);PAI_DISP(p2, x, y, q, false);PAI_DISP(p3, x+26, y, 0, false);PAI_DISP(p4, x+52, y, 0, false);x+=dx;continue;}if((m=fl[0][k+3])>0){PAI_DISP(m % 100, x+23, y-26, 1, false);if(m>2000) ARROW_DISP(x+23, y-56, 1);}PAI_DISP(fl[0][k] % 100, x, y, 0, false);PAI_DISP(fl[0][k+1] % 100, x+26, y, 0, false);PAI_DISP(fl[0][k+2] % 100, x+52, y, 0, false);x+=dx;continue;}if(tm_arrowD==2 && (i=tm_dapaiBuff)>0 && !grMode){PAI_DISP(i % 100, 383, 403, 0, false);}}}function TM_NUKIDORA_2(){var x, y, i, j, k, l, xx, dx;dx=-26;x=grMode ? 674 : 290;y=grMode ? 60 : 96;if(fulou_dir){x=grMode ? 414 : 108; dx=26;y=grMode ? 60 : 96;}i=-1; while(++i<ndr_ctr[2]){PAI_DISP(ndr[2][i], x, y, 2, false);x+=dx;}}function TM_SHUPAI_2 (){var x, y, i, j, k, l, xx, dx;x=grMode ? 259 : 7; y=8; dx=26;if(fulou_dir){x+=fc[2]*78;}if(!opened[2]){i=15; if((l=fc[2]-1)<0) l=0;while(--i>l*3){j=te[2][i] % 100;if(j>0) PAI_DISP(-1, x, y, 16, false);x+=dx;}if(fc[2]<1){i=20; while(--i>16){j=te[2][i] % 100;if(j>0) PAI_DISP(-1, x, y, 16, false);x+=dx;}}}else {i=15; if((l=fc[2]-1)<0) l=0;if(opened[2]==2 && fdat_disp && (j=te[2][15])>0){PAI_DISP(j % 100, x, y, 2, true);--i;x+=dx;}while(--i>l*3){j=te[2][i] % 100;if(j>0) PAI_DISP(j % 100, x, y, 2, opened[2]!=2);x+=dx;}if(fc[2]<1){i=20; while(--i>16){j=te[2][i] % 100;if(j>0) PAI_DISP(j, x, y, 2, opened[2]!=2);x+=dx;}}}dx=-5; k=fc[2]*5;if(fulou_dir){x=grMode ? 259 : 7;dx=5; k=-5;}y=1;i=fc[2]; while(--i>=0){k+=dx;if((j=fl[2][k+4])>0){var p1=p2=p3=p4=j % 50;if(opened[2]==2 && fdat_disp) p1=p3=-1;else if(!opened[2]) p1=p2=p3=p4=-1;PAI_DISP(p1, x, y, 2, false);PAI_DISP(p2, x+26, y, 2, false);PAI_DISP(p3, x+52, y, 2, false);PAI_DISP(p4, x+23, y+32, 1, false);x+=78;continue;}PAI_DISP(fl[2][k+2] % 100, x, y, 2, false);PAI_DISP(fl[2][k+1] % 100, x+26, y, 2, false);PAI_DISP(fl[2][k] % 100, x+52, y, 2, false);if((j=fl[2][k+3])>0){PAI_DISP(fl[2][k] % 100, x+23, y+32, 3, false);if(fl[2][k+3]>2000) ARROW_DISP(x+23, y+56, 3);}x+=78;continue;}TM_NUKIDORA_2();}function TM_NUKIDORA_1(){var u, x, y, i;x=grMode ? 708 : 400;if(fulou_dir){y=184; i=-1;while(++i<ndr_ctr[1]){PAI_DISP(ndr[1][i], x, y, 1, false);y+=26;}return;}i=ndr_ctr[1];y=348-i*26;while(--i>-1){PAI_DISP(ndr[1][i], x, y, 1, false);y+=26;}}function TM_FULOU_1(){var x, y, i, j, k, l;x=450; var g0=8, g1=-18;y=484-fc[1]*78;var dk=-5;if(grMode){x=854; y=458-fc[1]*78;g0=0; g1=-26;}k=fc[1]*5;if(fulou_dir){ y=0; k=-5; dk=5;if(!grMode) y=11;} i=fc[1]; while(--i>=0){k+=dk;if((j=fl[1][k+4])>0){var p1=p2=p3=p4=j % 50;if(opened[1]==2 && fdat_disp) p1=p3=-1;else if(!opened[1]) p1=p2=p3=p4=-1;PAI_DISP(p1, x+g0, y, 1, false);PAI_DISP(p2, x+g0, y+26, 1, false);PAI_DISP(p3, x+g0, y+52, 1, false);PAI_DISP(p4, x+g1, y+23, 2, false);y+=78;continue;}if((j=fl[1][k+3])>0){var p=j % 100;PAI_DISP(p, x+g0, y, 1, false);PAI_DISP(p, x+g0, y+26, 1, false);PAI_DISP(p, x+g0, y+52, 1, false);PAI_DISP(p, x+g1, y+23, 2, false);if(j>2000) ARROW_DISP(x-44, y+23, 2);y+=78;continue;}PAI_DISP(fl[1][k+2], x, y, 1, false);PAI_DISP(fl[1][k+1], x, y+26, 1, false);PAI_DISP(fl[1][k], x, y+52, 1, false);y+=78;continue;}}function TM_SHUPAI_1 (){var x, y, i, j, k, l;var ph=32;if(grMode){ ph=37; }if(fulou_dir) TM_FULOU_1();x=450; y=0;if(grMode){x=789; y=-10;}if(!opened[1]){x+=(ph >> 1);if(fulou_dir){y+=78*fc[1];if(!grMode) y+=12;}i=15; if((l=fc[1]-1)<0) l=0;while(--i>l*3){j=te[1][i] % 100;if(j>0){putPartOfImage(image, 510, 299, 12, 39, x, y+25, 12, 31);putPartOfImage(image, 510, 270, 12, 29, x, y, 12, 25);}y+=26;}i=20; while(--i>16){j=te[1][i] % 100;if(j>0){putPartOfImage(image, 510, 299, 12, 39, x, y+25, 12, 31);putPartOfImage(image, 510, 270, 12, 29, x, y, 12, 25);}y+=26;}y+=20;}else {i=15; if((l=fc[1]-1)<0) l=0;y=19;if(fulou_dir){y+=78*fc[1];if(!grMode) y+=12;}if(grMode){y+=16; --i;if((j=te[1][14])>0){PAI_DISP(j % 100, x-26, y, 2, false);}else if(opened[1]==2 && fdat_disp && (j=te[1][15])>0){PAI_DISP(j % 100, x-26, y, 2, true);}}else if(opened[1]==2 && fdat_disp && (j=te[1][15])>0){PAI_DISP(j % 100, x, y, 1, true);}while(--i>l*3){j=te[1][i] % 100;if(j>0) PAI_DISP(j, x, y, 1, opened[1]!=2);y+=26;}i=20; while(--i>16){j=te[1][i] % 100;if(j>0) PAI_DISP(j, x, y, 1, opened[1]!=2);y+=26;}}if(!fulou_dir) TM_FULOU_1();TM_NUKIDORA_1();}function TM_NUKIDORA_3 (){var x, y, i, j, k, l, dk;x=48; y=170;if(grMode){x=206; y=156;}if(!fulou_dir){i=-1; while(++i<ndr_ctr[3]){PAI_DISP(ndr[3][i], x, y, 3, false);y+=26;}return;}y=336-ndr_ctr[3]*26;i=ndr_ctr[3]; while(--i>-1){PAI_DISP(ndr[3][i], x, y, 3, false);y+=26;}}function TM_FULOU_3 (){var x, y, i, j, k, l, dk;x=0; y=42;var g1=-14, g2=18;if(grMode){x=78; y=0;g1=0; g2=32;}var dk=5; k=-5;if(fulou_dir){y=482-13-fc[3]*78;if(!grMode) y+=39;dk=-5; k=fc[3]*5;}i=fc[3]; while(--i>-1){k+=dk;if((j=fl[3][k+4])>0){var p1=p2=p3=p4=j % 50;if(opened[3]==2 && fdat_disp) p1=p3=-1;else if(!opened[3]) p1=p2=p3=p4=-1;PAI_DISP(p1, x+g1, y, 3, false);PAI_DISP(p2, x+g1, y+26, 3, false);PAI_DISP(p3, x+g1, y+52, 3, false);PAI_DISP(p4, x+g2, y+23, 0, false);y+=78;continue;}if((j=fl[3][k+3])>0){var p=j % 100;PAI_DISP(p, x+g1, y, 3, false);PAI_DISP(p, x+g1, y+26, 3, false);PAI_DISP(p, x+g1, y+52, 3, false);PAI_DISP(p, x+g2, y+23, 0, false);if(j>2000) ARROW_DISP(x+g2+26, y+23, 0);y+=78;continue;}PAI_DISP(fl[3][k], x, y, 3, false);PAI_DISP(fl[3][k+1], x, y+26, 3, false);PAI_DISP(fl[3][k+2], x, y+52, 3, false);y+=78;continue;}}function TM_SHUPAI_3 (){var x, y, i, j, k, l;if(!fulou_dir) TM_FULOU_3();if(!opened[3]){x=grMode ? 141 : 0;y=47;if(grMode){y=0;if(fulou_dir){++l; y=-fc[3]*3*26;}}else if(fulou_dir){y=25-fc[3]*3*26;}i=16; while(++i<20){j=te[3][i] % 100;if(j>0){putPartOfImage(image, 490, 299, 12, 39, x, y+25, 12, 31);putPartOfImage(image, 490, 270, 12, 29, x, y, 12, 25);}y+=26;}i=0; while(++i<15){j=te[3][i] % 100;if(j>0){putPartOfImage(image, 490, 299, 12, 39, x, y+25, 12, 31);putPartOfImage(image, 490, 270, 12, 29, x, y, 12, 25);}y+=26;}}else {x=grMode ? 139 : 0;y=66;var l=15;if(grMode){y=21;if(fulou_dir){y=21-fc[3]*3*26;}--l;}else if(fulou_dir){y=54-fc[3]*3*26;}i=16; while(++i<20){j=te[3][i] % 100;if(j>0) PAI_DISP(j, x, y, 3, opened[3]!=2);y+=26;}i=0; while(++i<l){j=te[3][i] % 100;if(j>0) PAI_DISP(j, x, y, 3, opened[3]!=2);y+=26;}if(grMode){var k=0, f=false;if((j=te[3][14])>0){k=1;}else if(opened[3]==2 && fdat_disp && (j=te[3][15])>0){k=1; f=true;}if(k) PAI_DISP(j % 100, x+31, y-32, 0, f);}else if(opened[3]==2 && fdat_disp && (j=te[3][15])>0){PAI_DISP(j, x, y-26, 3, true);}}if(fulou_dir) TM_FULOU_3();TM_NUKIDORA_3();return;}function HAND_CHANGER(){if(!console_mode){if(gameMode==GAMEMODE_TAIWAN){if(fc[0]<3) console_mode=1;}else if(fc[0]<2){console_mode=6;}}else {console_mode=0;}if(console_disped) console_disped();}function HAND_CHANGER_BY_FLICK(){if(!disped_player || Math.abs(flick_diffX)<20) return;if(!console_mode){if(gameMode==GAMEMODE_TAIWAN){if(fc[0]<3) console_mode=1;}else if(fc[0]<2){console_mode=6;}}else { console_mode=0;}if(console_disped) console_disped();}function POINT_STRING(v){var e, sgn, str=Math.abs(v).toString(10);if(v==0) return('0');sgn=''; if(v<0) sgn='-';var i=rule.score_unit; while(i>2){str+='0'; i=Math.floor(i / 10);}return(sgn+str);}function POINT_STRING2(v){var e, sgn, str=Math.abs(v).toString(10), ostr='';if(v==0) return('0');sgn=''; if(v<0) sgn='-';var i=rule.score_unit; while(i>2){str+='0'; i=Math.floor(i / 10);}while(str.length>3){ostr=str.substring(str.length-3, str.length)+ostr;str=str.substring(0, str.length-3);if(str.length>0) ostr=','+ostr;}return(sgn+str+ostr);}function POINT_STRING3(v){var e, sgn, str=Math.abs(v).toString(10), ostr='';if(v==0) return('0');sgn=''; if(v<0) sgn='-';while(str.length>3){ostr=str.substring(str.length-3, str.length)+ostr;str=str.substring(0, str.length-3);if(str.length>0) ostr=','+ostr;}return(sgn+str+ostr);}function SET_POINT(jia){var e=document.getElementById('SCORE'+jia+'_PTS'),    sgn, str=Math.abs(sc[jia])+'';if(str=='0'){e.innerHTML='0';return;}sgn=''; if(sc[jia]<0) sgn='-';var i=rule.score_unit; while(i>2){str+='0'; i=Math.floor(i / 10);}if(str.length<6){e.innerHTML=sgn+str;return;}var str2='';if(str.length>16){str=str.substring(0, str.length-16)+'.'+str.substring(str.length-16, str.length);str2=str.substring(0, 4)+'<span style="font-size: 50%; ">京</span>';}else if(str.length>12){str=str.substring(0, str.length-12)+'.'+str.substring(str.length-12, str.length);str2=str.substring(0, 4)+'<span style="font-size: 50%; ">兆</span>';}else if(str.length>8){str=str.substring(0, str.length-8)+'.'+str.substring(str.length-8, str.length);str2=str.substring(0, 4)+'<span style="font-size: 50%; ">億</span>';}else {str=str.substring(0, str.length-4)+'.'+str.substring(str.length-4, str.length);str2=str.substring(0, 4)+'<span style="font-size: 50%; ">万</span>';}if(str2.charAt(3)=='.'){str2=' '+str2.substring(0,3)+str2.substring(4,str2.length);}e.innerHTML=sgn+str2;}function PLAY_SCREEN(){var e, i, j, w, x, y, dx=0, dx2=0, ll=6;var pw=26, ph=32, bh=12;if(grMode){ pw=31; ph=37; bh=15; }if(gameMode==GAMEMODE_PENGLI) ll=8;initCanvas(bg_color);if(!grMode){putRectangleAbs(-1, 0, -1, 719, bg_color);putRectangleAbs(-1, 520, -1, 521, menu_border);putRectangleAbs(-1, 522, -1, 555, menu_bgcolor);}else {putRectangleAbs(-1, 0, -1, 640, bg_color);putRectangleAbs(-1, 470, -1, 471, menu_border);putRectangleAbs(-1, 472, -1, 500, menu_bgcolor);}var sgf=(gameMode==GAMEMODE_REACH && lang!='en' && (rule.goshugi || rule.yakitori));var sgd=(rule.goshugi || rule.yakitori>1);var sah=sgf ? 51 : 27
var sst='';if(gameMode==GAMEMODE_GUOJI){ dx=24; }if(gameMode==GAMEMODE_SAMMA){ dx=24; }if(gameMode==GAMEMODE_TAIWAN){ dx2=24; }var s2px=Math.floor(2*rRatio)+'px';var s20px=Math.floor(20*rRatio)+'px';var s23px=Math.floor(23*rRatio)+'px';var s27px=Math.floor(27*rRatio)+'px';gif_chip='<img style="width: '+s20px+'; height: auto; " src="data:image/gif;base64,R0lGODlhEAAOAMT/AP/'+'/'+'/'+'/'+'/'+'/Cf7+Cfr6CfT0CcrKCcLCCcHBCcDACb+/Cb29CZ+fDH59CHRyBjY1BS8vBSYmAyAeAgcFAgMFAgEBBAEAAgAAAwAAAgAAAQAAAMDAwAAAAAAAAAAAAAAAAAAAACH5BAEAABoALAAAAAAQAA4AAAVQoCaKS2mOqFYaLJuU6eIGtJHcyyjbBu0HOBXPFuAlXC/ZMVFbOkvL3g/YWh0DhJb0ZrAab1eXlVmcUbvCRIF2Lb90vJ/tjVK2uLmUysRHhQAAOw==" alt="" />';gif_yakitori='<img style="width: '+s20px+'; height: auto; " src="data:image/gif;base64,R0lGODlhIwAQAKL/AP/'+'/'+'/'+'/'+'/3zvezVwAAAMDAwAAAAAAAAAAAACH5BAEAAAQALAAAAAAjABAAAANMSLrc/jDKGYW16mKiRdYVyIndd4XnmJbq9rAwKb7yWrtEoOsdr/kXoGVHFAqMyEBv14jZnrjmzdOismhQ6xS1cXZnDq82Symbz2hGAgA7" alt="" />';var e;x=(dWidth >> 1)-pw*3-(104-dx);y=390;if(players==3){y=380;if(gameMode==GAMEMODE_SAMMA){y-=48;}if(gameMode==GAMEMODE_PENGLI){y=420;if(grMode) y=360;}}if(gameMode==GAMEMODE_TAIWAN){y-=8;}newTextArea('SCORE0', x, y, 100-dx, sah, 23, score_bgcolor, '#fff');spbX[0]=x; spbY[0]=y+26;e=document.getElementById('SCORE0');sst=''; if(sgf){sst='<div id="SCORE0_YAKITORI" style="position: absolute; left: 0; top: '+s27px+'; background: transparent; width: 100%; height: '+s20px+'; text-align: left; font-size:'+s20px+' line-height: 1em; certical-align: text-top: ">';if(rule.yakitori && yktr[0]) sst+=gif_yakitori;sst+='</div><div id="SCORE0_CHIPS" style="position: absolute; left: 0; top: '+s27px+'; background: transparent; width: 100%; height: '+s20px+'; text-align: right; font-size:'+s20px+' line-height: 1em; certical-align: text-top: ">';if(sgd) sst+=gif_chip+' '+shugi[0];sst+='</div>';}e.innerHTML=''+'<div id="SCORE0_FENG" style="position: absolute; top: '+s2px+'; left: 0; background: transparent; width: 100%; height: '+s23px+'; text-align: left; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+'<div id="SCORE0_PTS"  style="position: absolute; top: '+s2px+'; left: 0; background: transparent; width: 100%; height: '+s23px+'; text-align: right; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+sst;x=(dWidth >> 1)+pw*3+6;y=324;if(grMode){x=(dWidth >> 1)+Math.floor(pw*3.5)+(pw >> 1);if(players==3){y=343;}else {y=368;}if(gameMode==GAMEMODE_PENGLI) y=388;}else {if(gameMode==GAMEMODE_PENGLI) y=317;else if(players==3){y=303;}else if(gameMode==GAMEMODE_TAIWAN){y+=24;}}newTextArea('SCORE1', x, y, 100-dx, sah, 23, score_bgcolor, '#fff');spbX[1]=x; spbY[1]=y+32;e=document.getElementById('SCORE1');sst=''; if(sgf){sst='<div id="SCORE1_YAKITORI" style="position: absolute; left: 0; top: '+s27px+'; background: transparent; width: 100%; height: '+s20px+'; text-align: left; font-size:'+s20px+' line-height: 1em; certical-align: text-top: ">';if(rule.yakitori && yktr[1]) sst+=gif_yakitori;sst+='</div><div id="SCORE1_CHIPS" style="position: absolute; left: 0; top: '+s27px+'; background: transparent; width: 100%; height: '+s20px+'; text-align: right; font-size:'+s20px+' line-height: 1em; certical-align: text-top: ">';if(sgd) sst+=gif_chip+' '+shugi[1];sst+='</div>';}e.innerHTML=''+'<div id="SCORE1_FENG" style="position: absolute; top: '+s2px+'; left: 0; background: transparent; width: 100%; height: '+s23px+'; text-align: left; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+'<div id="SCORE1_PTS"  style="position: absolute; top: '+s2px+'; left: 0; background: transparent; width: 100%; height: '+s23px+'; text-align: right; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+sst;if(players>3){x=(dWidth >> 1)+pw*3;y=96;if(gameMode==GAMEMODE_TAIWAN) y=92;if(gameMode==GAMEMODE_GUOJI){y=120;if(!grMode) y=92;}if(sgf) y-=24;newTextArea('SCORE2', x, y, 100-dx, sah, 23, score_bgcolor, '#fff');spbX[2]=x; spbY[2]=y-40;e=document.getElementById('SCORE2');sst=''; if(sgf){sst='<div id="SCORE2_YAKITORI" style="position: absolute; left: 0; top: '+s27px+'; background: transparent; width: 100%; height: '+s20px+'; text-align: left; font-size:'+s20px+' line-height: 1em; certical-align: text-top: ">';if(rule.yakitori && yktr[2]) sst+=gif_yakitori;sst+='</div><div id="SCORE2_CHIPS" style="position: absolute; left: 0; top: '+s27px+'; background: transparent; width: 100%; height: '+s20px+'; text-align: right; font-size:'+s20px+' line-height: 1em; certical-align: text-top: ">';if(sgd) sst+=gif_chip+' '+shugi[2];sst+='</div>';}e.innerHTML=''+'<div id="SCORE2_FENG" style="position: absolute; top: '+s2px+'; left: 0; background: transparent; width: 100%; height: '+s23px+'; text-align: left; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+'<div id="SCORE2_PTS"  style="position: absolute; top: '+s2px+'; left: 0; background: transparent; width: 100%; height: '+s23px+'; text-align: right; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+sst;y=164-sah;x=(dWidth >> 1)-pw*3-(104-dx);if(grMode) x=(dWidth >> 1)-Math.floor(pw*(ll+2) / 2)-96+dx-(ph >> 1);newTextArea('SCORE3', x, y, 100-dx, sah, 23, score_bgcolor, '#fff');spbX[3]=x; spbY[3]=y-64;e=document.getElementById('SCORE3');sst=''; if(sgf){sst='<div id="SCORE3_YAKITORI" style="position: absolute; left: 0; top: '+s27px+'; background: transparent; width: 100%; height: '+s20px+'; text-align: left; font-size:'+s20px+' line-height: 1em; certical-align: text-top: ">';if(rule.yakitori && yktr[3]) sst+=gif_yakitori;sst+='</div><div id="SCORE3_CHIPS" style="position: absolute; left: 0; top: '+s27px+'; background: transparent; width: 100%; height: '+s20px+'; text-align: right; font-size:'+s20px+' line-height: 1em; certical-align: text-top: ">';if(sgd) sst+=gif_chip+' '+shugi[3];sst+='</div>';}e.innerHTML=''+'<div id="SCORE3_FENG" style="position: absolute; top: '+s2px+'; left: 0; background: transparent; width: 100%; height: '+s23px+'; text-align: left; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+'<div id="SCORE3_PTS"  style="position: absolute; top: '+s2px+'; left: 0; background: transparent; width: 100%; height: '+s23px+'; text-align: right; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+sst;}else {x=(dWidth >> 1)-(pw << 2)-102+dx;if(gameMode==GAMEMODE_PENGLI){y=76;if(grMode) y=16;}else {y=96-sah;x=(dWidth >> 1)-pw*3-(104-dx);if(grMode){y=60-sah;x-=(ph >> 1);}y+=pw+pw;}newTextArea('SCORE2', x, y, 100-dx, sah, 23, score_bgcolor, '#fff');spbX[2]=x; spbY[2]=y-64;e=document.getElementById('SCORE2');sst=''; if(sgf){sst='<div id="SCORE2_YAKITORI" style="position: absolute; left: 0; top: '+s27px+'; background: transparent; width: 100%; height: '+s20px+'; text-align: left; font-size:'+s20px+' line-height: 1em; certical-align: text-top: ">';if(rule.yakitori && yktr[2]) sst+=gif_yakitori;sst+='</div><div id="SCORE2_CHIPS" style="position: absolute; left: 0; top: '+s27px+'; background: transparent; width: 100%; height: '+s20px+'; text-align: right; font-size:'+s20px+' line-height: 1em; certical-align: text-top: ">';if(sgd) sst+=gif_chip+' '+shugi[2];sst+='</div>';}e.innerHTML=''+'<div id="SCORE2_FENG" style="position: absolute; top: '+s2px+'; left: 0; background: transparent; width: 100%; height: '+s23px+'; text-align: left; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+'<div id="SCORE2_PTS"  style="position: absolute; top: '+s2px+'; left: 0; background: transparent; width: 100%; height: '+s23px+'; text-align: right; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+sst;}if(gameMode==GAMEMODE_BEINUKI || gameMode==GAMEMODE_PENGLI){i=-1; while(++i<players){e=document.getElementById('SCORE'+i+'_FENG');e.style.color='#fff';j='散'; if(i==zhuangjia) j='荘';e.innerHTML=j;SET_POINT(i);}}else {i=-1; while(++i<players){if(lang==''){j='東';if(menfeng[i]==32) j='南';else if(menfeng[i]==33) j='西';else if(menfeng[i]==34) j='北';}else {j='E.';if(menfeng[i]==32) j='S.';else if(menfeng[i]==33) j='W.';else if(menfeng[i]==34) j='N.';}e=document.getElementById('SCORE'+i+'_FENG');e.style.color='#fff';e.innerHTML=j;SET_POINT(i);}}if(gameMode==GAMEMODE_GUOJI || gameMode==GAMEMODE_ARSHIAR){if(lang==''){y=230; if(grMode) y=260;newTextArea_2('HAND_INFO', 160, y, 162, 26, 23, score_bgcolor, '#fff');e=document.getElementById('HAND_INFO');e.style.textAlign='center';e.style.lineHeight=Math.floor(23*rRatio)+'px';e.style.padding=Math.floor(4*rRatio)+'px 0';e.style.fontFamily='serif';var str='';i='東';if(zhuangfeng[0]==32) i='南';if(zhuangfeng[0]==33) i='西';if(zhuangfeng[0]==34) i='北';str+=i+'場';e.innerHTML=str+((kyoku % players)+1)+'局';}else {y=208; if(grMode) y+=32;newTextArea_2('HAND_INFO', 164, y, 152, 56, 23, score_bgcolor, '#fff');e=document.getElementById('HAND_INFO');e.style.textAlign='center';e.style.lineHeight=Math.floor(28*rRatio)+'px';e.style.padding=Math.floor(4*rRatio)+'px 0';e.style.fontFamily='serif';var str='';if(kyoku % players==0) str='1st';if(kyoku % players==1) str='2nd';if(kyoku % players==2) str='3rd';if(kyoku % players==3) str='4th';str+=' Hand of ';i='East.';if(zhuangfeng[0]==32) i='South.';if(zhuangfeng[0]==33) i='West.';if(zhuangfeng[0]==34) i='North.';e.innerHTML=str+i;}}else if(gameMode==GAMEMODE_TAIWAN){x=46; y=60;if(grMode){x=(dWidth >> 1)-Math.floor(pw*(ll+2) / 2)-96+dx-(ph >> 1);}newTextArea('HAND_INFO', x, y, 162, 26, 23, score_bgcolor, '#fff');e=document.getElementById('HAND_INFO');e.style.textAlign='center';e.style.lineHeight=Math.floor(23*rRatio)+'px';e.style.padding=Math.floor(4*rRatio)+'px 0';e.style.fontFamily='serif';i='東';if(zhuangfeng[0]==32) i='南';if(zhuangfeng[0]==33) i='西';if(zhuangfeng[0]==34) i='北';e.innerHTML=i+((kyoku % players)+1)+'局 '+tsumi+'本場';}else if(gameMode==GAMEMODE_BOO){y=280; if(grMode) y=290;newTextArea_2('HAND_INFO', 160, y, 162, 26, 23, score_bgcolor, '#fff');e=document.getElementById('HAND_INFO');e.style.textAlign='center';e.style.lineHeight=Math.floor(23*rRatio)+'px';e.style.padding=Math.floor(4*rRatio)+'px 0';e.style.fontFamily='serif';i='東';if(zhuangfeng[0]==32) i='南';if(zhuangfeng[0]==33) i='西';if(zhuangfeng[0]==34) i='北';e.innerHTML=i+'場'+((kyoku % players)+1)+'局 '+tsumi+'本場';}else if(gameMode==GAMEMODE_SAMMA){y=280; if(grMode) y=290;newTextArea_2('HAND_INFO', 160, y, 162, 26, 23, score_bgcolor, '#fff');e=document.getElementById('HAND_INFO');e.style.textAlign='center';e.style.lineHeight=Math.floor(23*rRatio)+'px';e.style.padding=Math.floor(4*rRatio)+'px 0';e.style.fontFamily='serif';e.innerHTML='東場'+(kyoku +1)+'局 '+tsumi+'本場';}else if(gameMode==GAMEMODE_BEINUKI){y=280; if(grMode) y=290;newTextArea_2('HAND_INFO', 160, y, 162, 26, 23, score_bgcolor, '#fff');e=document.getElementById('HAND_INFO');e.style.textAlign='center';e.style.lineHeight=Math.floor(23*rRatio)+'px';e.style.padding=Math.floor(4*rRatio)+'px 0';e.style.fontFamily='serif';e.innerHTML='第'+(kyoku +1)+'局 '+tsumi+'本場';}else if(gameMode==GAMEMODE_PENGLI){y=280; if(grMode) y=290;newTextArea_2('HAND_INFO', 160, y, 162, 26, 23, score_bgcolor, '#fff');e=document.getElementById('HAND_INFO');e.style.textAlign='center';e.style.lineHeight=Math.floor(23*rRatio)+'px';e.style.padding=Math.floor(4*rRatio)+'px 0';e.style.fontFamily='serif';e.innerHTML='第'+(kyoku +1)+'局';}else {if(lang==''){y=280; if(grMode) y=290;newTextArea_2('HAND_INFO', 160, y, 162, 26, 23, score_bgcolor, '#fff');e=document.getElementById('HAND_INFO');e.style.textAlign='center';e.style.lineHeight=Math.floor(28*rRatio)+'px';e.style.padding=Math.floor(4*rRatio)+'px 0';e.style.fontFamily='serif';var str='';if(rule.zhuangfeng==3){str='表'; if(kyoku>=players) str='裏';}else if(kyoku>=players*4) str='返';i='東';if(zhuangfeng[0]==32) i='南';if(zhuangfeng[0]==33) i='西';if(zhuangfeng[0]==34) i='北';str+=i; i='場';if(zhuangfeng[1]==31) i='東';if(zhuangfeng[1]==32) i='南';if(zhuangfeng[1]==33) i='西';if(zhuangfeng[1]==34) i='北';str+=i;e.innerHTML=str+((kyoku % players)+1)+'局 '+tsumi+'本場';x=(dWidth >> 1)+pw*3+6;y=322;if(grMode){x=(dWidth >> 1)+Math.floor(pw*3.5)+(pw >> 1);y=368;if(players==3) y=342;}else if(players==3) y=302;y+=4+sah;newTextArea('HAND_INFO2', x, y, 100, 27, 23, score_bgcolor, '#fff');e=document.getElementById('HAND_INFO2');e.style.fontFamily='serif';e.innerHTML='<div style="position: absolute; top: '+s2px+'; left: 0; width: 100%; height: '+s23px+'; text-align: left; line-height: 1em; certical-align: text-top: ">供託</div>'+'<div style="position: absolute; top: '+s2px+'; left: 0; width: 100%; height: '+s23px+'; text-align: right; line-height: 1em; certical-align: text-top: " id="KYOTAKU_INFO">'+(kyotaku*rule.score_unit)+'</div>';}else {y=280;if(grMode){ y+=10;}newTextArea_2('HAND_INFO', 160, y, 162, 28, 23, score_bgcolor, '#fff');e=document.getElementById('HAND_INFO');e.style.textAlign='center';e.style.lineHeight=Math.floor(28*rRatio)+'px';e.style.padding=Math.floor(4*rRatio)+'px 0';e.style.fontFamily='serif';var str='East';if(zhuangfeng[0]==32) str='South';if(zhuangfeng[0]==33) str='West';if(zhuangfeng[0]==34) str='North';e.innerHTML=str+' '+(1+kyoku % players)+', Ctr.'+tsumi;x=(dWidth >> 1)+Math.floor(pw*3.5);y=322;if(grMode){x+=pw >> 1;y=360;}y+=4+sah;newTextArea('HAND_INFO2', x, y, 100, 56, 23, score_bgcolor, '#fff');e=document.getElementById('HAND_INFO2');e.style.padding='0'+Math.floor(2*rRatio)+'px';e.style.lineHeight=Math.floor(23*rRatio)+'px';e.style.fontFamily='serif';e.innerHTML='<div style="padding: 4px 0; ">Bet:<div style="display: block; text-align: right; margin-top: .2em; line-height: 1em; certical-align: text-top: " id="KYOTAKU_INFO">'+(+kyotaku*rule.score_unit)+'</div></div>';}}}function MENFENG_COLOR(jia, f){var e=document.getElementById('SCORE'+jia+'_FENG');if(!e) return;if(f==2) e.style.color='#ff0';else if(f==1) e.style.color='#880';else if(f<0) e.style.color='#0ff';else e.style.color='#fff';}function DORA_DISP(){var y;y=220;if(grMode){y=232;}DORA_DISP_SUB(0, y);}function DORA_DISP_SUB(xOffset, y1){var i, x, y=y1;var pw=26, ph=31, bh=12, pmode=0;if(gameMode==GAMEMODE_TAIWAN || gameMode==GAMEMODE_GUOJI || gameMode==GAMEMODE_ARSHIAR) return;if(grMode){pw=31; ph=37; bh=15; pmode=40;}if(gameMode==GAMEMODE_PENGLI){x=(dWidth >> 1)-Math.floor(pw*0.5)+xOffset*pw;if(zampai<1){putRectangle(x, y, pw, ph+bh, bg_color);return;}i=doraD[0];if(i<1) i=-1;PAI_DISP(i, x, y, pmode, false);return;}i=5; x=(dWidth >> 1)-Math.floor(pw*2.5)+xOffset*pw;if(gameMode==GAMEMODE_BEINUKI){x=(dWidth >> 1)-pw*3+xOffset*pw;if(xOffset) x-=pw << 1;if(bn_lingshangdoraD[0]<1){PAI_DISP(-1, x, y+12, pmode, false);PAI_DISP(-1, x, y, pmode, false);}else {PAI_DISP(bn_lingshangdoraD[0], x, y-16, pmode, true);PAI_DISP(bn_lingshangdoraD[1], x, y+ph-16, pmode, true);}x+=pw;}else if(gameMode==GAMEMODE_SAMMA && xOffset && fulou_dir && !grMode){x-=32;}i=-1; while(++i<5){if(i<uradora_opened && uradoraD[i]){PAI_DISP(doraD[i], x, y-16, pmode, false);PAI_DISP(uradoraD[i], x, y+ph-16, pmode, true);x+=pw;continue;}if(!doraD[i]){PAI_DISP(-1, x, y+12, pmode, false);PAI_DISP(-1, x, y, pmode, false);x+=pw;continue;}PAI_DISP(-1, x, y+12, pmode, false);if(i<=gangCtr) PAI_DISP(doraD[i], x, y, pmode, false);else PAI_DISP(-1, x, y, pmode, false);x+=pw;}doraCtr=0; i=-1; while(++i<5){if(doraD[i]) ++doraCtr;}}function REACH_STICK_DISP(j){var y, x, jia=j, w=89, h=5;if(grMode){w=106; h=6;}if(players==3 && jia==2) jia=3;if(!(jia & 1)){x=(dWidth >> 1)-(w >> 1);y=316; if(jia==2){ y=185; }if(grMode){y=326; if(jia==2){ y=212; }if(players==3) y-=40;}putPartOfImage(image, 0, 321, 89, 5, x, y, w, h);return;}x=313; y=218;if(jia==3){ y=218; x=161; }if(grMode){x=354; y=218;if(jia==1){ x=592; y=218; }if(players==3) y-=45;}putPartOfImage(image, 530, 300, 5, 89, x, y, h, w);}function YAKU_DISP(jia, str){var i, j, y, x, x1, y1;var e, f;x=64; y=120;if(grMode){y=128;if(lang=='en') y=74;}else if(lang=='en') y=70;if(gameMode!=GAMEMODE_TAIWAN && gameMode!=GAMEMODE_GUOJI && gameMode!=GAMEMODE_ARSHIAR){if(dc[0]>-1){var pw=26, ph=31, bh=13;var y1=220;if(grMode){pw=31; ph=37; bh=15; y1=232;}var x1=(dWidth >> 1)-Math.floor(pw*3);putRectangle(x1, y1, pw*6, ph+bh+bh, bg_color);dc[0]=0;DAPAI_DISP(0);dc[0]=-1;}var y1=396;if(grMode){ y1=402; }i=3;if(gameMode==GAMEMODE_SAMMA){i=0.5;if(!grMode){ i=2.5; }}if(gameMode==GAMEMODE_PENGLI) i=6;if(lang=='en') i=0;else if(grMode){if(gameMode==GAMEMODE_REACH && players==4) i=0;}DORA_DISP_SUB(i, y1);}if(str!=''){x1=x; y1=y-52;i=48;if(lang=='en'){if(grMode || (players==4 && jia==2)){x+=50; i=100; x1=x-100; y1=y;}}newTextArea_2('YAKU_POS', x1, y1, i, 24, 24, '#000', '#fff');var e=document.getElementById('YAKU_POS');e.style.border='solid '+Math.floor(2*rRatio)+'px rgb(255, 247, 206)';e.style.padding=Math.floor(14*rRatio)+'px';e.style.fontFamily='serif';e.innerHTML=str;}if(gameMode==GAMEMODE_GUOJI){x-=24; i=224;if(lang=='en'){ i+=56; }newTextArea_2('YAKU_TBL', x, y, 368, i, 24, '#000', '#fff');var e=document.getElementById('YAKU_TBL');e.style.border='solid '+Math.floor(2*rRatio)+'px rgb(255, 247, 206)';e.style.padding=Math.floor(14*rRatio)+'px';y=16;i=''; if(lang==''){var c=-1, yy=y; while(++c<7){i+='<div id="YAKU_N'+c+'"  style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(16*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(120*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #0ff; font-size: '+Math.floor(24*rRatio)+'px; text-align: left; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+'<div id="YAKU_V'+c+'"  style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(132*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(52*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #fff; font-size: '+Math.floor(24*rRatio)+'px; text-align: right; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+'<div id="YAKU_N'+(c+7)+'"  style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(200*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(120*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #0ff; font-size: '+Math.floor(24*rRatio)+'px; text-align: left; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+'<div id="YAKU_V'+(c+7)+'"  style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(316*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(52*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #fff; font-size: '+Math.floor(24*rRatio)+'px; text-align: right; font-family: serif; line-height: 1em; certical-align: text-top: "></div>';y+=28;}i+='<div id="YAKU_RESULT"  style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(288*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(96*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #fff; font-size: '+Math.floor(24*rRatio)+'px; text-align: right; font-family: serif; line-height: 1em; certical-align: text-top: "></div>';}else {var c=-1, yy=y; while(++c<9){i+='<div id="YAKU_N'+c+'" style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(16*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(300*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #0ff; font-size: '+Math.floor(22*rRatio)+'px; text-align: left; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+'<div id="YAKU_V'+c+'"  style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(316*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(52*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #fff; font-size: '+Math.floor(22*rRatio)+'px; text-align: right; font-family: serif; line-height: 1em; certical-align: text-top: "></div>';y+=28;}i+='<div id="YAKU_RESULT" style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(288*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(96*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #fff; font-size: '+Math.floor(22*rRatio)+'px; text-align: right; font-family: serif; line-height: 1em; certical-align: text-top: "></div>';}e.innerHTML=i;var i=-1; while(++i<yakutbl_ctr){e=document.getElementById('YAKU_N'+i);f=document.getElementById('YAKU_V'+i);if(!e || !f) break;e.innerHTML='<span style="color: #0ff; ">'+yakutbl[i]+'</span>';if(yfantbl[i]){f.innerHTML='<span style="color: #fff; ">'+yfantbl[i]+'</span>';if(lang==''){f.innerHTML+='<span style="color: #ff0; ">分</span>';}}}e=document.getElementById('YAKU_RESULT');if(e){i='<span style="color: #ff0; ">点</span>';if(lang!='') i='<span style="color: #ff0; ">Pts.</span>';if(yakustatus_pts) e.innerHTML='<span style="color: #fff; ">'+yakustatus_pts+'</span>'+i+' ';}return;}j=224; if(lang=='en'){ j+=56; }newTextArea_2('YAKU_TBL', x, y, 320, j, 24, '#000', '#fff');var e=document.getElementById('YAKU_TBL');e.style.border='solid '+Math.floor(2*rRatio)+'px rgb(255, 247, 206)';e.style.padding=Math.floor(14*rRatio)+'px';y=16;if(fdat[jia].dat[0]  && lang==''){i='<div id="FU_GUIDE"  style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(156*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(144*rRatio)+'px; color: #ccc; font-size: '+Math.floor(18*rRatio)+'px; text-align: left; font-family: serif; font-family: monospace; line-height: 1em; certical-align: text-top: "></div>';var c=-1; while(++c<7){i+='<div id="YAKU_N'+c+'" style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(16*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(120*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #0ff; font-size: '+Math.floor(24*rRatio)+'px; text-align: left; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+'<div id="YAKU_V'+c+'" style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(108*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(52*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #fff; font-size: '+Math.floor(24*rRatio)+'px; text-align: right; font-family: serif; line-height: 1em; certical-align: text-top: "></div>';y+=28;}i+='<div id="YAKU_FF" style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(16*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(224*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #0ff; font-size: '+Math.floor(24*rRatio)+'px; text-align: left; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+'<div id="YAKU_RESULT"  style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(136*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(200*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #fff; font-size: '+Math.floor(24*rRatio)+'px; text-align: right; font-family: serif; line-height: 1em; certical-align: text-top: "></div>';e.innerHTML=i;e=document.getElementById('FU_GUIDE');if(e){i='<table border="0" style="width: '+Math.floor(140*rRatio)+'px; margin: 0 0 auto '+Math.floor(40*rRatio)+'px; line-height: 1em; certical-align: text-top: ">';i+='<tr><td style="width: 4.2em; height: 1.1em; ">副底</td><td style="text-align: right; height: 1.1em; ">'+fdat[jia].fudi+'符</td></tr>';i+='<tr><td style="width: 4.2em; height: 1.1em; ">門子</td><td style="text-align: right; height: 1.1em; ">'+fdat[jia].menzi+'符</td></tr>';i+='<tr><td style="width: 4.2em; height: 1.1em; ">'+fdat[jia].machi_name+'</td><td style="text-align: right; height: 1.1em; ">'+fdat[jia].machi+'符</td></tr>';if(fdat[jia].mohe || fdat[jia].mohe_note!=''){i+='<tr><td style="width: 4.2em; height: 1.1em; ">摸和</td><td style="text-align: right; height: 1.1em; ">'+fdat[jia].mohe+'符</td></tr>';if(fdat[jia].mohe_note!=''){i+='<tr><td colspan="2" style="text-align: right; height: 0.5em; ">'+fdat[jia].mohe_note+'</td></tr>';}}if(fdat[jia].kui_pinghe>0) i+='<tr><td style="width: 4.2em; height: 1.1em; ">喰い平和</td><td style="text-align: right; height: 1.1em; ">'+fdat[jia].kui_pinghe+'符</td></tr>';if(fdat[jia].arshiar_qinyise>0) i+='<tr><td style="width: 4.2em; height: 1.1em; ">清一色</td><td style="text-align: right; height: 1.1em; ">'+fdat[jia].arshiar_qinyise+'符</td></tr>';i+='<tr><td colspan="2" style="height: 0.5em; "><hr /></td></tr><tr><td style="width: 4.2em; vertical-align: top; ">合計</td><td style="text-align: right; vertical-align: top; ">'+fdat[jia].total+'符</td></tr></table>';e.innerHTML=i;}}else {i=''; if(lang==''){var c=-1; while(++c<7){i+='<div id="YAKU_N'+c+'"  style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(16*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(120*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #0ff; font-size: '+Math.floor(24*rRatio)+'px; text-align: left; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+'<div id="YAKU_V'+c+'"  style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(108*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(52*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #fff; font-size: '+Math.floor(24*rRatio)+'px; text-align: right; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+'<div id="YAKU_N'+(c+7)+'"  style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(176*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(120*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #0ff; font-size: '+Math.floor(24*rRatio)+'px; text-align: left; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+'<div id="YAKU_V'+(c+7)+'"  style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(268*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(52*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #fff; font-size: '+Math.floor(24*rRatio)+'px; text-align: right; font-family: serif; line-height: 1em; certical-align: text-top: "></div>';y+=28;}i+='<div id="YAKU_FF"  style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(16*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(224*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #0ff; font-size: '+Math.floor(24*rRatio)+'px; text-align: left; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+'<div id="YAKU_RESULT"  style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(136*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(200*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #fff; font-size: '+Math.floor(24*rRatio)+'px; text-align: right; font-family: serif; line-height: 1em; certical-align: text-top: "></div>';}else {if(fdat[jia].dat[0]){i+='<table id="FU_GUIDE" lang="en" border="0" style="margin: 0 0 0 auto; font-family: monospace; font-size: '+Math.floor(18*rRatio)+'px; position: absolute; top: '+Math.floor((28*yakutbl_ctr+28)*rRatio)+'px; left: '+Math.floor(32*rRatio)+'px; line-height: 1em; certical-align: text-top: "><tr><tr><td style="width: 13em; height: 1.1em; ">Minipoints</td><td style="text-align: right; vertical-align: top; width: 3em; ">'+fdat[jia].total+'</td></tr></tr>';i+='<tr><td style="width: 13em; height: 1.1em; ">&nbsp;&nbsp;For Winning</td><td style="text-align: right; height: 1.1em; width: 3em; ">'+fdat[jia].fudi+'</td></tr>';i+='<tr><td style="width: 13em; height: 1.1em; ">&nbsp;&nbsp;For Pung/Kong/Pair</td><td style="text-align: right; height: 1.1em; width: 3em; ">'+fdat[jia].menzi+'</td></tr>';if(fdat[jia].machi) i+='<tr><td style="width: 10em; height: 1.1em; ">&nbsp;&nbsp;For '+fdat[jia].machi_name+'</td><td style="text-align: right; height: 1.1em; width: 3em; ">'+fdat[jia].machi+'</td></tr>';if(fdat[jia].mohe || fdat[jia].mohe_note!=''){var ss='For Self-Draw';if(fdat[jia].mohe_note) ss+=' (Pinfu)';i+='<tr><td style="width: 13em; height: 1.1em; ">&nbsp;&nbsp;'+ss+'</td><td style="text-align: right; height: 1.1em; width: 3em; ">'+fdat[jia].mohe+'</td></tr>';}if(fdat[jia].kui_pinghe>0) i+='<tr><td style="width: 13em; height: 1.1em; ">&nbsp;&nbsp;For Open <i>Pinfu</i></td><td style="text-align: right; height: 1.1em; width: 3em; ">'+fdat[jia].kui_pinghe+'</td></tr>';i+='</table>';}var c=-1; while(++c<9){i+='<div id="YAKU_N'+c+'"  style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(16*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(250*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #0ff; font-size: '+Math.floor(22*rRatio)+'px; text-align: left; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+'<div id="YAKU_V'+c+'"  style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(268*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(52*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #fff; font-size: '+Math.floor(22*rRatio)+'px; text-align: right; font-family: serif; line-height: 1em; certical-align: text-top: "></div>';y+=28;}i+='<div id="YAKU_FF"  style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(16*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(222*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #0ff; font-size: '+Math.floor(22*rRatio)+'px; text-align: left; font-family: serif; line-height: 1em; certical-align: text-top: "></div>'+'<div id="YAKU_RESULT"  style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(216*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(120*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #fff; font-size: '+Math.floor(22*rRatio)+'px; text-align: right; font-family: serif; line-height: 1em; certical-align: text-top: "></div>';e.innerHTML=i;}e.innerHTML=i;}if(gameMode==GAMEMODE_TAIWAN){var i=-1; while(++i<yakutbl_ctr){e=document.getElementById('YAKU_N'+i);f=document.getElementById('YAKU_V'+i);if(!e || !f) break;e.innerHTML='<span style="color: #0ff; ">'+yakutbl[i]+'</span>';if(yfantbl[i]){f.innerHTML='<span style="color: #fff; ">'+yfantbl[i]+'</span><span style="color: #ff0; ">台</span>';}}e=document.getElementById('YAKU_FF');if(e){i='';if(yakustatus_fan>0) i+='<span style="color: #fff; ">'+yakustatus_fan+'</span><span style="color: #ff0; ">台</span> ';e.innerHTML=i;}e=document.getElementById('YAKU_RESULT');if(e){if(yakustatus_pts>0) e.innerHTML='<span style="color: #fff; ">'+yakustatus_pts+'</span><span style="color: #ff0; ">点</span> ';}return;}var i=-1; while(++i<yakutbl_ctr){e=document.getElementById('YAKU_N'+i);f=document.getElementById('YAKU_V'+i);if(!e || !f) break;if(yakustatus_pts<0){e.innerHTML='<span style="color: #f00; ">'+yakutbl[i]+'</span>';break;}e.innerHTML='<span style="color: #0ff; ">'+yakutbl[i]+'</span>';if(yfantbl[i]){if(lang==''){f.innerHTML='<span style="color: #fff; ">'+yfantbl[i]+'</span><span style="color: #ff0; ">翻</span>';}else {f.innerHTML='<span style="color: #fff; ">'+yfantbl[i]+'</span>';}}}e=document.getElementById('YAKU_FF');if(e){i='';if(lang==''){if(yakustatus_fu>0) i+='<span style="color: #fff; ">'+yakustatus_fu+'</span><span style="color: #ff0; ">符</span> ';if(yakustatus_fan>0) i+='<span style="color: #fff; ">'+yakustatus_fan+'</span><span style="color: #ff0; ">翻</span> ';if(yakustatus_mgn!='') i+='<span style="color: #0ff; ">'+yakustatus_mgn+'</span>';}else {if(yakustatus_fu>0) i+='<span style="color: #fff; ">'+yakustatus_fu+'</span><span style="color: #ff0; ">M.P.</span> ';if(yakustatus_fan>0) i+='<span style="color: #fff; ">'+(yakustatus_fan-2)+'</span><span style="color: #ff0; ">Fan</span> ';if(yakustatus_mgn!='') i+='<span style="color: #0ff; ">'+yakustatus_mgn+'</span>';}e.innerHTML=i;}e=document.getElementById('YAKU_RESULT');if(e){if(yakustatus_pts){if(lang==''){ e.innerHTML='<span style="color: #fff; ">'+POINT_STRING3(yakustatus_pts)+'</span><span style="color: #ff0; ">点</span> ';}else { e.innerHTML='<span style="color: #fff; ">'+POINT_STRING3(yakustatus_pts)+'</span><span style="color: #ff0; ">Pts.</span> ';}}}}function PINJU_DISP(){var i, y, x;var e, f, fs;x=64; y=160;if(grMode) y=140;newTextArea_2('YAKU_TBL', x, y, 320, 224, 24, '#000', '#fff');var e=document.getElementById('YAKU_TBL');e.style.border='solid '+Math.floor(2*rRatio)+'px rgb(255, 247, 206)';e.style.padding=Math.floor(14*rRatio)+'px';y=16;fs=22; if(lang=='') fs=24;e.innerHTML='<div id="YAKU_N0"  style="position: absolute; top: '+Math.floor(y*rRatio)+'px; left: '+Math.floor(16*rRatio)+'px; padding: 0; margin: 0; width: '+Math.floor(192*rRatio)+'px; height: '+Math.floor(28*rRatio)+'px; color: #0ff; font-size: '+Math.floor(fs*rRatio)+'px; text-align: left; font-family: serif; line-height: 1em; certical-align: text-top: ">'+yakutbl[0]+'</div>';}function YAKU_ERASE(){removeTextArea('YAKU_POS');removeTextArea('YAKU_TBL');}function SPEECH_BALOON(txt, voice, jia){if(spb_timeout){clearTimeout(spb_timeout);}var n='SPB_'+jia;var e=document.getElementById(n);if(e) e.parentNode.removeChild(e);var x, y, w, h=fs=30, ln=txt.length;if(txt.indexOf('<br>')>-1){fs=20; h=40;var sa=txt.split('<br>');var i=sa.length; h=fs*i;ln=0; while(--i>-1){if(ln<sa[i].length) ln=sa[i].length;}}w=fs*ln;if(lang=='en') w=(fs >> 1)*ln;x=spbX[jia]; y=spbY[jia];if(jia<1){y-=h+62;}else if(jia<2){if(dWidth -20 - x < h){ x=dWidth -20 - h; }y-=h+68;}else if(jia==2 && players==4){y+=72;}else if(jia>1){y+=96;}newTextArea(n, x, y, w, h, fs-2, '#000', '#fff');e=document.getElementById(n);e.style.fontFamily='serif';e.style.fontWeight='900';e.style.padding='0.5em';e.style.border='solid #888 2px';e.innerHTML='<div style="height: 1em; margin: 0; padding: 0; text-align: center; vertical-align: top; line-height: 1em; ">'+txt+'';if(voice!=''){spb_timeout=setTimeout('SPEECH_BALOON2("'+voice+'"); ', 100);}else {spb_timeout=setTimeout('SPEECH_BALOON_ERASE(); ', 900);}}function SPEECH_BALOON2(voice){clearTimeout(spb_timeout);AUDIO_OUTPUT(voice, true);spb_timeout=setTimeout('SPEECH_BALOON_ERASE(); ', 800);}function SPEECH_BALOON_ERASE(){clearTimeout(spb_timeout);var i=4, e;while(--i>-1){e=document.getElementById('SPB_'+i);if(e) e.parentNode.removeChild(e);}spb_timeout=null;}function SEL_CONFIG(){if(timeout_hnd) clearTimeout(timeout_hnd);inputKey=-1;timeout_hnd=setTimeout('SEL_CONFIG1(); ', 10);}function SEL_CONFIG1(){if(timeout_hnd) clearTimeout(timeout_hnd);var x=6, y=6, i, s, w, y1;initCanvas(bg_color);if(!grMode){putRectangleAbs(-1, 0, -1, 719, bg_color);putRectangleAbs(-1, 520, -1, 521, menu_border);putRectangleAbs(-1, 522, -1, 555, menu_bgcolor);}else {putRectangleAbs(-1, 0, -1, 640, bg_color);putRectangleAbs(-1, 470, -1, 471, menu_border);putRectangleAbs(-1, 472, -1, 500, menu_bgcolor);}x=22; y=6; w=436;var x1=240;if(grMode){x=42; x1=480; w=876;putRectangle(6, 6, 948, 463, '#000');}else {putRectangle(6, 6, 468, 514, '#000');}drawTextMincho('環境設定', x1, y+16, 48, 24, true, 24, 24, null, '#ff0', 'center');y1=y+66;s=grMode ? '' : '[0] ';drawTextMincho(s+'カラーモード', x, y1, w, 24, true, 24, 24, null, '#ff0', 'left');s='ライトモード(背景・緑)';if(dark_mode>0) s='ダークモード(背景・黒)';else if(dark_mode<0) s='ライトモード(背景・青)';drawTextMincho(s, x+w, y1, w, 24, true, 24, 24, null, '#fff', 'right');makeClickable(0, x, y1, w, 45, '0');y1+=45;s=grMode ? '' : '[1] ';s+='副露門子の置き位置';if(grMode) s+='(台湾麻将除)';drawTextMincho(s, x, y1, w, 24, true, 24, 24, null, '#ff0', 'left');s='手の左側';if(fulou_dir>0){s='手の右側';}drawTextMincho(s, x+w, y1, w, 24, true, 24, 24, null, '#fff', 'right');makeClickable(1, x, y1, w, 45, '1');y1+=45;s=grMode ? '' : '[2] ';drawTextMincho(s+'模切牌の表示(台湾麻将除)', x, y1, w, 24, true, 24, 24, null, '#ff0', 'left');s='手出し牌と同様';if(mogiri_disp){s='灰色で表示';}if(!grMode) y1+=45;drawTextMincho(s, x+w, y1, w, 24, true, 24, 24, null, '#fff', 'right');makeClickable(2, x, y1, w, 64, '2');y1+=45;if(!grMode){drawTextMincho('※変更したい項目をタップ/クリックするか、', x, y1, 276, 24, false, 24, 24, null, '#fff', 'left');drawTextMincho('項目に表示されたダイヤルを押して下さい。', x, y1+26, 276, 24, false, 24, 24, null, '#fff', 'left');}else {drawTextMincho('※変更項目をタップ/クリックすると内容が切り替わります。', x, y1, 276, 24, false, 24, 24, null, '#fff', 'left');}x=0; y=690;if(grMode){ x=240; y=610; }newTextArea('CREDIT', x, y, 480, 32, 24, 'transparent', '#fff');var e=document.getElementById('CREDIT');e.style.fontFamily='serif';e.style.textAlign='center';e.innerHTML=copyright_credit;STATUS_DISP_2('対局環境を選択してください。');x=390; y=558;if(grMode){x=870; y=502;}s=grMode ? '菜　単' : '[*]菜単';putRectangle(x, y, 89, 43, button_color);drawText(s, x+45, y+9, 60, 24, false, 24, 24, null, button_text, 'center');makeClickable(10, x, y+1, 89, 40, '*');x-=90;inputKey=-1;timeout_hnd=setTimeout('SEL_CONFIG_KEY(); ', 10);}function SEL_CONFIG_KEY(){if(timeout_hnd) clearTimeout(timeout_hnd);var x=6, y=6, i;i=Math.random();if(inputKey==0){if(++dark_mode>1) dark_mode=-1;inputKey=-1;timeout_hnd=setTimeout('SEL_CONFIG1(); ', 10);return;}if(inputKey==1){if(++fulou_dir>1) fulou_dir=0;inputKey=-1;timeout_hnd=setTimeout('SEL_CONFIG1(); ', 10);return;}if(inputKey==2){if(++mogiri_disp>1) mogiri_disp=0;inputKey=-1;timeout_hnd=setTimeout('SEL_CONFIG1(); ', 10);return;}if(inputKey<0){timeout_hnd=setTimeout('SEL_CONFIG_KEY(); ', 10);return;}try {rule_storage.setItem('GAME_TINY_MAHJONG_UI_MOGIRIDISP', mogiri_disp);rule_storage.setItem('GAME_TINY_MAHJONG_UI_DARKMODE', dark_mode);rule_storage.setItem('GAME_TINY_MAHJONG_UI_FULOUPOS', fulou_dir);}catch(e){ ; }if(inputKey==10){timeout_hnd=setTimeout('MAIN_START(); ', 10);return;}inputKey=-1;timeout_hnd=setTimeout('SEL_CONFIG_KEY(); ', 10);}function SEL_CONFIG_EN(){if(timeout_hnd) clearTimeout(timeout_hnd);var x=6, y=6, i, s, t, y1, j, x1;timeout_hnd=setTimeout('SEL_CONFIG_EN_1(); ', 10);}function SEL_CONFIG_EN_1(){if(timeout_hnd) clearTimeout(timeout_hnd);var x=6, y=6, i, s, s1, s2, t, y1, j;initCanvas(bg_color);if(!grMode){putRectangleAbs(-1, 0, -1, 719, bg_color);putRectangleAbs(-1, 520, -1, 521, menu_border);putRectangleAbs(-1, 522, -1, 555, menu_bgcolor);}else {putRectangleAbs(-1, 0, -1, 640, bg_color);putRectangleAbs(-1, 470, -1, 471, menu_border);putRectangleAbs(-1, 472, -1, 500, menu_bgcolor);}x=22; y=6; w=436;var x1=240;if(grMode){x=42; x1=480; w=876;putRectangle(6, 6, 948, 463, '#000');}else {putRectangle(6, 6, 468, 514, '#000');}t='';drawTextMincho(gmode_name+'Options.', x1, y+16, 48, 24, true, 24, 24, null, '#ff0', 'center');y1=y+66;s=grMode ? '' : '[0] ';drawTextMincho(s+'Color Mode (Background):', x, y1, w, 24, true, 24, 24, null, '#ff0', 'left');s='Light mode (green).';if(dark_mode<0) s='Light mode (blue).';else if(dark_mode>0) s='Dark mode (black).';y1+=32;drawTextMincho(s, x+48, y1, w, 24, true, 24, 24, null, '#fff', 'left');makeClickable(0, x, y1, w, 40, '0');y1+=64;s=grMode ? '' : '[1] ';drawTextMincho(s+'Where Your Medled Sets are Put:', x, y1, w, 24, true, 24, 24, null, '#ff0', 'left');s='Left side of Your hand.';if(fulou_dir){s='Right side of Your hand.';}y1+=32;drawTextMincho(s, x+48, y1, w, 24, true, 24, 24, null, '#fff', 'left');makeClickable(1, x, y1, w, 40, '1');y1+=64;s=grMode ? '' : '[2] ';if(grMode){drawTextMincho(s+'Display of Your Discarded Tiles Immediately after Drawn:', x, y1, w, 24, true, 24, 24, null, '#ff0', 'left');}else {drawTextMincho(s+'Display of Your Discarded Tiles', x, y1, w, 24, true, 24, 24, null, '#ff0', 'left');y1+=32;drawTextMincho('     Immediately after Drawn:', x, y1, w, 24, true, 24, 24, null, '#ff0', 'left');}s='Similar to Ones form Your Hand.';if(mogiri_disp){s='Darker than Ones form Your Hand.';}y1+=32;drawTextMincho(s, x+48, y1, w, 24, true, 24, 24, null, '#fff', 'left');makeClickable(2, x, y1, w, 40, '2');y1+=64;drawTextMincho('*Tap/Click the option to change.', x, y1, 276, 24, false, 24, 24, null, '#fff', 'left');x=0; y=690;if(grMode){ x=240; y=610; }newTextArea('CREDIT', x, y, 480, 32, 24, 'transparent', '#fff');var e=document.getElementById('CREDIT');e.style.fontFamily='serif';e.style.textAlign='center';e.innerHTML=copyright_credit;STATUS_DISP_2('Choose you option of rules before play.');x=390; y=558;if(grMode){x=870; y=502;}putRectangle(x, y, 89, 43, button_color);drawText('Menu', x+40, y+9, 60, 24, false, 24, 24, null, button_text, 'center');makeClickable(10, x, y+1, 89, 40, '*');x=0; y=690;if(grMode){ x=240; y=610; }newTextArea('CREDIT', x, y, 480, 32, 24, 'transparent', '#fff');var e=document.getElementById('CREDIT');e.style.fontFamily='serif';e.style.textAlign='center';e.innerHTML=en_copyright_credit;inputKey=-1;timeout_hnd=setTimeout('SEL_CONFIG_EN_KEY(); ', 10);}function SEL_CONFIG_EN_KEY(){if(timeout_hnd) clearTimeout(timeout_hnd);var x=6, y=6, i;i=Math.random();if(inputKey==0){if(++dark_mode>1) dark_mode=-1;inputKey=-1;timeout_hnd=setTimeout('SEL_CONFIG_EN_1(); ', 10);return;}if(inputKey==1){fulou_dir=(fulou_dir+1) & 1;inputKey=-1;timeout_hnd=setTimeout('SEL_CONFIG_EN_1(); ', 10);return;}if(inputKey==2){mogiri_disp=(mogiri_disp+1) & 1;inputKey=-1;timeout_hnd=setTimeout('SEL_CONFIG_EN_1(); ', 10);return;}if(inputKey<0){timeout_hnd=setTimeout('SEL_CONFIG_EN_KEY(); ', 10);return;}try {rule_storage.setItem('GAME_TINY_MAHJONG_UI_MOGIRIDISP', mogiri_disp);rule_storage.setItem('GAME_TINY_MAHJONG_UI_DARKMODE', dark_mode);rule_storage.setItem('GAME_TINY_MAHJONG_UI_FULOUPOS', fulou_dir);}catch(e){ ; }timeout_hnd=setTimeout('EN_MAIN_START(); ', 10);}
