dWidth=480;dHeight=720;rRatio=1;oWidth=1;xOffset=0;yOffset=24;canvasID='GAME_CANVAS';canvasMapID='GAME_CANVAS_MAP';hst='http:'; if(location.protocol.toLowerCase()!='http:') hst='https:';image_file=hst+'\/\/www.marguerite.jp/Games/Mobile_Mahjong/HTML5_Resouces/Tiles.GIF';image=null;bg_color='#008020';canvasContext=null;inputKey=-1;start_code='ATRACT()';menu_bordercolor='#008800';menu_bgcolor='#cccccc';menu_txcolor='#000000';menu_notxcolor='#888888';menu_border='#0f0';accesskey_flags=new Object();dWidthP=480;dHeightP=720;dWidthL=960;dHeightL=640;grMode=0;_ready=-1;game_onload=window.onload;window.onload=function(){var e, fn;if(game_onload) game_onload();_ready++;e=document.getElementById(canvasID);if(!e || !e.getContext){_ready=-65536; return;}image=new Image();fn=image_file;if('serviceWorker' in navigator) ;else if(location.protocol.toLowerCase()!='file:') fn+='?'+new Date().getTime();image.src=fn;image.onload = function(){_ready++;};e=document.getElementById(canvasID);e.ontouchstart=flick_start;e.ontouchmove=flick_moving;e.ontouchend=flick_end;};timeout_id=null;load_flg=0;loading(start_code);function loading(start_code){var e;if(timeout_id) clearTimeout(timeout_id);if(_ready<-2) return;if(!load_flg){if((e=document.getElementById(canvasID))!=null){load_flg=1;initCanvas('#050');newTextArea('TITLE', 0,40, dWidth, 160, 64, '#050', '#fff');var e=document.getElementById('TITLE');e.style.textAlign='center';e.style.lineHeight='1.0em';e.innerHTML='しらぎくさいと<br /><span style="font-size: 40%; ">HTML5 システム 3.11</span>';newTextArea('MESS', 0, Math.floor(dHeight / 3)+46, dWidth, 96, 24, '#050', '#fff');var e=document.getElementById('MESS');e.style.textAlign='center';e.style.fontWeight='bold';e.innerHTML='<p style="margin: 0; padding: 0; ">只今読込中です。</p><p style="margin: 1em 0 0; padding: 0; ">しばらくお待ちください。</p>';}timeout_id=setTimeout('loading(start_code); ', 10);return;}if(_ready>0){removeAllOfTextArea();timeout_hnd=setTimeout(start_code, 10);return;}timeout_id=setTimeout('loading(start_code); ', 10);}mapID='CANVAS_CLICKMAP';function initCanvas(bgColor){var w=document.documentElement.clientWidth || document.body.clientWidth  || window.innerWidth;var h=document.documentElement.clientHeight || document.body.clientHeight  || window.innerHeight;dWidth=dWidthP;dHeight=dHeightP;grMode=0;if(w>h){dWidth=dWidthL;dHeight=dHeightL;grMode=1;}rRatio=h / (dHeight+yOffset); xOffset=0;if(rRatio*dWidth>w){rRatio=w / dWidth;h=Math.floor((dHeight+yOffset) * rRatio);}else xOffset=(w - rRatio*dWidth) >> 1;var e=document.getElementById(canvasID);if(e && e.getContext){e.setAttribute('width', w);e.setAttribute('height', h);canvasContext=e.getContext('2d');if(bgColor!=null){canvasContext.fillStyle=bgColor;canvasContext.fillRect(0, 0, w-1, w-1);}}oWidth=w;var pe=e.parentNode;if(pe.style.position==null || e.style.position.toLowerCase()=='static'){pe.style.position='relative';pe.style.top='0';pe.style.left='0';}removeAllOfTextArea();makeNoClickable();if(!document.getElementById('___MENUBAR')){e=document.createElement('div');e.setAttribute('id', '___MENUBAR');e.style.position='fixed';e.style.top=e.style.left='0';e.style.width='100%';e.style.height=yOffset+'px';e.style.fontSize=Math.floor(yOffset * 0.8)+'px';e.style.color=menu_txcolor;e.style.background=menu_bgcolor;em=(document.getElementsByTagName('body'))[0];em.appendChild(e);}if(AUDIO_INIT) AUDIO_INIT();}function putPartOfImage(img, sx, sy, sw, sh, dx, dy, dw, dh){canvasContext.drawImage(img, sx, sy, sw, sh,Math.floor(dx*rRatio)+xOffset,Math.floor(dy*rRatio)+yOffset,Math.floor(dw*rRatio),Math.floor(dh*rRatio));}function putRectangleAbs(dx, dy, ex, ey, color){var x1=0, w=ex-dx, h=ey-dy;if(w<0) w=dx-ex;if(h<0) h=dy-ey;w=Math.floor((w+1)*rRatio);h=Math.floor((h+1)*rRatio);canvasContext.fillStyle=color;x1=dx*rRatio+xOffset;if(dx<0){x1=0;w=ex*rRatio+xOffset;if(ex<0) w=oWidth;}else if(ex<0) w=oWidth-(dx*rRatio)+1;canvasContext.fillRect(x1, Math.floor(dy*rRatio)+yOffset, w, h);}function putRectangle(dx, dy, w, h, color){var x1=0;canvasContext.fillStyle=color; x1=Math.floor(dx*rRatio)+xOffset;canvasContext.fillRect(x1, Math.floor(dy*rRatio)+yOffset, Math.floor(w*rRatio), Math.floor(h*rRatio));}function newTextArea(id, x, y, w, h, fontSize, bgColor, fgColor){var e=document.getElementById(canvasID);var ne;if(e){e=e.parentNode;if(e.style.position==null || e.style.position.toLowerCase()=='static'){e.style.position='relative';e.style.top='0';e.style.left='0';}if(!document.getElementById(id)){ne=document.createElement('div');ne.setAttribute('data-bylib', '1');ne.setAttribute('id', id);ne.style.width=Math.floor(w*rRatio)+'px';ne.style.height=Math.floor(h*rRatio)+'px';ne.style.overflow='hidden';ne.style.background=bgColor || '#000';ne.style.color=fgColor || '#fff';ne.style.fontSize=Math.floor(fontSize*rRatio)+'px';ne.style.position='absolute';ne.style.top=Math.floor(y*rRatio+yOffset)+'px';ne.style.left=Math.floor(x*rRatio+xOffset)+'px';ne.ontouchstart=flick_start;ne.ontouchmove=flick_moving;ne.ontouchend=flick_end;e.appendChild(ne);}}}function removeTextArea(id){var e=document.getElementById(id);if(e){e.parentNode.removeChild(e);}}function removeAllOfTextArea(){var e=document.getElementsByTagName('div');var i=e.length;while(--i>=0){if(!e[i].getAttribute('data-bylib')) continue;e[i].parentNode.removeChild(e[i]);}e=document.getElementsByTagName('a');i=e.length;while(--i>=0){if(!e[i].getAttribute('data-bylib')) continue;e[i].parentNode.removeChild(e[i]);}accesskey_flags=new Object();}function drawText(txt, x, y, w, h, bold, fontSize, lineHeight, bgColor, fgColor, alignment){var x2=x;if(bgColor!=null){if(alignment.toLowerCase()=='center') x2-=w / 2;else if(alignment.toLowerCase()=='right') x2-=w;canvasContext.fillStyle=bgColor;canvasContext.fillRect(Math.floor(x2*rRatio)+xOffset, Math.floor(y*rRatio)+yOffset, Math.floor(w*rRatio), Math.floor(h*rRatio));}if(fgColor!=null) canvasContext.fillStyle=fgColor;var i='normal normal 1em/1em';if(fontSize!=null && fontSize>0){i='normal normal ';if(bold) i='normal bold ';i+=Math.floor(fontSize*rRatio)+'px';if(lineHeight!=null && lineHeight>0) i+='/'+Math.floor(lineHeight*rRatio)+'px';}canvasContext.font=i+' monospace';if(alignment=='') canvasContext.textAlign='left';else canvasContext.textAlign=alignment;canvasContext.textBaseline='top';canvasContext.fillText(txt,Math.floor(x*rRatio)+xOffset,Math.floor(y*rRatio)+yOffset);}function drawTextMincho(txt, x, y, w, h, bold, fontSize, lineHeight, bgColor, fgColor, alignment){var x2=x;if(bgColor!=null){if(alignment.toLowerCase()=='center') x2-=w / 2;else if(alignment.toLowerCase()=='right') x2-=w;canvasContext.fillStyle=bgColor;canvasContext.fillRect(Math.floor(x2*rRatio)+xOffset, Math.floor(y*rRatio)+yOffset, Math.floor(w*rRatio), Math.floor(h*rRatio));}if(fgColor!=null) canvasContext.fillStyle=fgColor;var i='normal normal 1em/1em';if(fontSize!=null && fontSize>0){i='normal normal ';if(bold) i='normal bold ';i+=Math.floor(fontSize*rRatio)+'px';if(lineHeight!=null && lineHeight>0) i+='/'+Math.floor(lineHeight*rRatio)+'px';}canvasContext.font=i+' serif';if(alignment=='') canvasContext.textAlign='left';else canvasContext.textAlign=alignment;canvasContext.textBaseline='top';canvasContext.fillText(txt,Math.floor(x*rRatio)+xOffset,Math.floor(y*rRatio)+yOffset);}touched=0;audio_loading=-1;function makeClickable2(inputKeyNumber, x, y, w, h, aKey, idName){var ae=document.createElement('a');if(idName){ae.setAttribute('id', idName);}ae.setAttribute('data-bylib', 1);ae.style.display='block';ae.style.position='absolute';ae.style.cursor='pointer';ae.style.width=Math.floor(w*rRatio)+'px';ae.style.height=Math.floor(h*rRatio)+'px';ae.style.top=Math.floor(y*rRatio+yOffset)+'px';ae.style.left=Math.floor(x*rRatio+xOffset)+'px';ae.style.zIndex=2;ae.dataset.inputNumber=inputKeyNumber;ae.addEventListener('click', function(){var i=audio_url.length+audio_loaded;if(!noAudio && audio_loaded<0 && audio_loading<0){audioObj[i]=new Audio();audioObj[i].volume=1;audioObj[i].controls=false;audioObj[i].autoplay=false;audioObj[i].src=audio_url[i]+'?'+new Date().getTime();audioObj[i].play();audio_loading=i;audio_loadOK=0;setTimeout('AUDIO_LOADING(); ', 100);audioObj[i].addEventListener('ended', function(){this.currentTime=0;this.pause();}, false);}setValue2(this.dataset.inputNumber);return(false);}, false);if(aKey!=''){if(!accesskey_flags[aKey]) ae.setAttribute('accesskey', aKey);accesskey_flags[aKey]=1;}ae.innerHTML='<img alt="" style="width: 100%; height: 100%; border: none; " src="data:image/gif;base64,R0lGODlhAQABAJH/AP/'+'/'+'/wAAAMDAwAAAACH5BAEAAAIALAAAAAABAAEAAAICVAEAOw==">';ae.ontouchstart=flick_start;ae.ontouchmove=flick_moving;ae.ontouchend=flick_end;var e=document.getElementById(canvasID);if(e){e=e.parentNode;if(e.style.position==null || e.style.position.toLowerCase()=='static'){e.style.position='relative';e.style.top='0';e.style.left='0';}e.appendChild(ae);}}makeClickable=makeClickable2;function setValue(inputKeyNumber){if(touched) return;inputKey=inputKeyNumber;}function setValue2(inputKeyNumber){touched=1;inputKey=inputKeyNumber;}function makeClickable_callback(called_back_func, x, y, w, h, aKey, idName){var ae=document.createElement('a');if(idName){ae.setAttribute('id', idName);}ae.setAttribute('data-bylib', 1);ae.style.display='block';ae.style.position='absolute';ae.style.cursor='pointer';ae.style.width=Math.floor(w*rRatio)+'px';ae.style.height=Math.floor(h*rRatio)+'px';ae.style.top=Math.floor(y*rRatio+yOffset)+'px';ae.style.left=Math.floor(x*rRatio+xOffset)+'px';ae.style.zIndex=2;ae.onclick=called_back_func;ae.ontouchstart=flick_start;ae.ontouchmove=flick_moving;ae.ontouchend=flick_end;if(aKey!=''){if(!accesskey_flags[aKey]) ae.setAttribute('accesskey', aKey);accesskey_flags[aKey]=1;}ae.innerHTML='<img alt="" style="width: 100%; height: 100%; border: none; " src="data:image/gif;base64,R0lGODlhAQABAJH/AP/'+'/'+'/wAAAMDAwAAAACH5BAEAAAIALAAAAAABAAEAAAICVAEAOw==">';var e=document.getElementById(canvasID);if(e){e=e.parentNode;if(e.style.position==null || e.style.position.toLowerCase()=='static'){e.style.position='relative';e.style.top='0';e.style.left='0';}e.appendChild(ae);}}function AUDIO_LOADING (){var d=audioObj[audio_loading].duration;if(audioObj[audio_loading].readyState==4)  audioObj[audio_loading].pause();if(audioObj[audio_loading].readyState!=4 || isNaN(d) || d==100){setTimeout('AUDIO_LOADING(); ', 100);return;}audioObj[audio_loading].pause();audioObj[audio_loading].currentTime=0;AUDIO_LOADED(audio_loading);audio_loading=-1;}function makeNoClickable(){var e=document.getElementsByTagName('a');var i=e.length;while(--i>=0){if(!e[i].getAttribute('data-bylib')) continue;e[i].parentNode.removeChild(e[i]);}accesskey_flags=new Object();}function setMenuItem(mId, xPos, chars, text, link, NOlink){var xp=xPos;if(xp<0) xp=dWidth*rRatio+xp-Math.floor(yOffset*chars);var e=document.getElementById('___MENUBAR');if(!e) return;var f=document.getElementById(mId);if(!f){f=document.createElement('a');f.setAttribute('id', mId);}f.style.color=menu_txcolor;f.style.textDecoration='none';f.style.display='block';f.style.position='absolute';f.style.top=Math.floor(yOffset * 0.1)+'px';f.style.left=(xp+xOffset)+'px';f.style.width=Math.floor(yOffset*chars)+'px';f.style.height=Math.floor(yOffset*0.9)+'px';f.style.whiteSpace='noWrap';f.style.margin=f.style.padding='0px';f.innerHTML=text;if(link!=''){f.setAttribute('href', 'javascript:'+link);if(NOlink) f.style.color=menu_notxcolor;}else {f.removeAttribute('href');f.style.color=menu_notxcolor;}e.appendChild(f);}function removeMenuItem(mId){var e=document.getElementById('___MENUBAR');if(!e) return;var f=document.getElementById(mId);if(!f) return;e.removeChild(f);}callback_flick=null;disped_player=0;flick_X=-9999;flick_Y=-9999;flick_X2=-9999;flick_Y2=-9999;flick_diffX=0;flick_diffY=-0;function flick_start(e){flick_X2=flick_X=Math.floor(e.touches[0].pageX);flick_Y2=flick_Y=Math.floor(e.touches[0].pageY);flick_diffX=0;flick_diffY=0;}function flick_moving(e){flick_X2=Math.floor(e.touches[0].pageX);flick_Y2=Math.floor(e.touches[0].pageY);}function flick_end(e){flick_diffX=Math.floor((flick_X2-flick_X) / rRatio);flick_diffY=Math.floor((flick_Y2-flick_Y) / rRatio);if(callback_flick) callback_flick();}
