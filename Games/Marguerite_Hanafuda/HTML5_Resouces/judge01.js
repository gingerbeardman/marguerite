function _f_torifuda_set(seki, fuda){var i=fuda & 0xff;var j=i & 15;if(_f_gamemode==_F_GAMEMODE_600KEN){if(!j){ _f[seki].torifuda01[_f[seki].torifuda01_ctr++]=i; j=1; }else if(j==1){ _f[seki].torifuda05[_f[seki].torifuda05_ctr++]=i; j=5; }else if(j==2 && i!=0x22){ _f[seki].torifuda10[_f[seki].torifuda10_ctr++]=i; j=10; }else { _f[seki].torifuda20[_f[seki].torifuda20_ctr++]=i; j=20; }}else if(_f_gamemode==_F_GAMEMODE_SUDAOSHI){if((i & 0xf0)==0xc0 || j==0 || i==0x33){ _f[seki].torifuda10[_f[seki].torifuda10_ctr++]=i; j=10; }else if(j==1){ _f[seki].torifuda01[_f[seki].torifuda01_ctr++]=i; j=1; }else { _f[seki].torifuda05[_f[seki].torifuda05_ctr++]=i; j=5; }}else {if(i==0xc2){ _f[seki].torifuda01[_f[seki].torifuda01_ctr++]=i; j=1; }else if(!j){ _f[seki].torifuda01[_f[seki].torifuda01_ctr++]=i; j=1; }else if(j==1){ _f[seki].torifuda05[_f[seki].torifuda05_ctr++]=i; j=5; }else if(j==2){ _f[seki].torifuda10[_f[seki].torifuda10_ctr++]=i; j=10; }else { _f[seki].torifuda20[_f[seki].torifuda20_ctr++]=i; j=20; }}return(j);}function _f_normalize_code(fuda){if(fuda==0xc2 && _f_gamemode!=_F_GAMEMODE_600KEN && _f_gamemode!=_F_GAMEMODE_HACHI) return(0xc0);return(fuda);}function _f_init_balance(){var i=3;_f_88_yaku_flag=0;while(--i>=0){_f[i].torifuda_dekiyaku=0;_f[i].payback_name_ctr=0;_f[i].payback_point_total=0;_f[i].yaku_name_ctr=0;_f[i].yaku_point_total=0;_f[i].yaku_result_point=0;_f[i].torifuda_total=0;_f[i].balance_torifuda=_f[i].balance_payback=_f[i].balance=_f[i].balance_total=_f[i].nobalance=0;_f[i].score_after_balance=_f[i].score;}_f_result_after_balance();}function _f_result_after_balance(){var i=_f_players;var j, s=-10000;var r=new Array(3);var w, h;if(_f_kabu_mode) return;if(_f_gamemode==_F_GAMEMODE_600KEN || _f_gamemode==_F_GAMEMODE_HACHI){_f[0].result_after_balance=_f[1].result_after_balance=_f[2].result_after_balance=0;w=-1; h=-1; i=_f_players;while(--i>=0){if(h<=_f[i].score){ h=_f[i].score; w=i; }}if(w<0) return;i=_f_players; s=0;while(--i>=0){if(i==w) continue;j=h-_f[i].score; _f[i].result_after_balance=-j;s+=j;}_f[w].result_after_balance=s;}else {while(--i>=0){j=_f[i].result_after_balance=_f[i].score_after_balance=_f[i].score+_f[i].balance_total;if(_f_gamemode==_F_GAMEMODE_88 || _f_gamemode==_F_GAMEMODE_SUDAOSHI){if(_f_players>2){j-=120;if(_f_gamemode==_F_GAMEMODE_SUDAOSHI) j+=60;}if(j % 12>5) j+=12;j=Math.floor(j/12);r[i]=j;if(_f_gamemode==_F_GAMEMODE_SUDAOSHI) _f[i].result_after_balance=j;else _f[i].result_after_balance=0;}if(s<j) s=j;}if(_f_gamemode==_F_GAMEMODE_88){if(_f_players==3){i=3; while(--i>=0){if(r[i]==s){j=3; while(--j>=0){if(i==j) continue;_f[j].result_after_balance-=s+15;}_f[i].result_after_balance+=s*2+30;}}}else {_f[0].result_after_balance=r[0]-5;_f[1].result_after_balance=-r[0]+5;}}if(_f_gamemode==_F_GAMEMODE_SUDAOSHI){j=-1; s=-10000;var e=0;i=3; while(--i>=0){if(j<0 || s<_f[i].result_after_balance){s=_f[i].result_after_balance;j=i; e=1; continue;}if(s==_f[i].result_after_balance) ++e;}if(e==3){i=3; while(--i>=0) _f[i].result_after_balance=0;}else if(e==2){i=3; while(--i>=0){if(_f[i].result_after_balance!=s) break;}if(_f[i].result_after_balance & 1) --_f[i].result_after_balance;j=-Math.floor(_f[i].result_after_balance / 2);i=3; while(--i>=0){if(_f[i].result_after_balance==s) _f[i].result_after_balance=j;}}else {i=3; e=0; while(--i>=0){if(_f[i].result_after_balance!=s) e-=_f[i].result_after_balance;}_f[j].result_after_balance=e;}}}i=_f_players;while(--i>=0){_f[i].result[_f_game_ctr]=_f[i].result_after_balance;s=0; j=_f_game_ctr;while(--j>=0) s+=_f[i].result[j];_f[i].total_result=s;}}function _f_teyaku_judge(seki){var i, j, k, l;var te4=te3=te2=0;var te4m=te1m=te3m=0;_f[seki].yaku_name_ctr=0;_f[seki].yaku_point_total=0;_f[seki].sambon[0]=_f[seki].sambon[1]=0;_f[seki].sambon_hatto[0]=_f[seki].sambon_hatto[1]=-1;_f[seki].nukeyaku='';_f[seki].sambon_flag=0;_f[seki].tatesambon_flag=0;_f[seki].aka_flag=0;_f[seki].tan_ichi_flag=0;_f[seki].toichi_flag=0;_f[seki].karasu_flag=0;_f[seki].pikaichi_flag=0;_f[seki].kuttsuki_flag=0;_f[seki].teshi_flag=0;_f[seki].haneken_flag=0;_f[seki].ichinishi_flag=0;_f[seki].shiso_flag=0;_f_teyaku_flag=0;i=13; while(--i>=0) _f_month[i]=0;i=8; while(--i>=0){_f_month[(_f[seki].tefuda[i] >> 4) & 15]++;}i=13; j=k=l=0;while(--i>0){if(_f_month[i]==4){ ++te4; te4m=i << 4; }if(_f_month[i]==3){ ++te3; te3m=i << 4; }if(_f_month[i]==2) ++te2;if(_f_month[i]==1){ te1m=i << 4; }}if(_f_gamemode==_F_GAMEMODE_88 || _f_gamemode==_F_GAMEMODE_SUDAOSHI){if(te4 && te3){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='四三';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=240;_f[seki].yaku_point_total+=240;_f[seki].yaku_name_ctr++;i=7; while(--i>=0) _f[seki].tefuda[i] |= 0x200;_f_teyaku_flag=1;_f[seki].shiso_flag=1;_f_88_yaku_flag=1;}else if(te4 && te2){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='一二四';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=96;_f[seki].yaku_point_total+=96;_f[seki].yaku_name_ctr++;i=7; while(--i>=0) _f[seki].tefuda[i] |= 0x200;_f[seki].ichinishi_flag=1;_f_88_yaku_flag=1;}else if(te3 && te2==2){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='はねけん';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=84;_f[seki].yaku_point_total+=84;_f[seki].yaku_name_ctr++;i=7; while(--i>=0) _f[seki].tefuda[i] |= 0x200;_f[seki].haneken_flag=1;_f_88_yaku_flag=1;}else if(te4){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='手四';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=72;_f[seki].yaku_point_total+=72;_f[seki].yaku_name_ctr++;i=7; while(--i>=0){if((_f[seki].tefuda[i] & 0xf0)==te4m) _f[seki].tefuda[i] |= 0x200;}_f[seki].teshi_flag=1;_f_88_yaku_flag=1;}else if(te2==3){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='喰付';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=48;_f[seki].yaku_point_total+=48;_f[seki].yaku_name_ctr++;i=7; while(--i>=0){if((_f[seki].tefuda[i] & 0xf0)!=te1m) _f[seki].tefuda[i] |= 0x200;}_f[seki].kuttsuki_flag=1;_f_88_yaku_flag=1;}else if(te3>0){i=13; j=0; while(--i>0){if(_f_month[i]!=3) continue;l=3; while(--l>=0){if(l==seki) continue;k=7; while(--k>=0){if(((_f[l].tefuda[k] >> 4) & 15)==i){ _f[seki].sambon_hatto[j]=l; break; }}if(k>=0) break;}_f[seki].sambon[j++]=i;}i=0;if(_f_month[4]==3 || _f_month[5]==3 || _f_month[7]==3) ++i;if(_f_month[12]==3){j=7;while(--j>=0){if((_f[seki].tefuda[j] & 0xff)==0xc3) break;}if(j<0) ++i;}_f[seki].sambon_flag=te3-i;_f[seki].tatesambon_flag=i;if(te3==2 && i==2){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='二立三本';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=96;_f[seki].yaku_point_total+=96;_f[seki].yaku_name_ctr++;i=7; while(--i>=0){if((_f[seki].tefuda[i] & 0xf0)!=te1m) _f[seki].tefuda[i] |= 0x200;}}else if(te3==2 && i){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='三本立三本';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=84;_f[seki].yaku_point_total+=84;_f[seki].yaku_name_ctr++;i=7; while(--i>=0){if((_f[seki].tefuda[i] & 0xf0)!=te1m) _f[seki].tefuda[i] |= 0x200;}}else if(te3==2){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='二三本';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=72;_f[seki].yaku_point_total+=72;_f[seki].yaku_name_ctr++;i=7; while(--i>=0){if((_f[seki].tefuda[i] & 0xf0)!=te1m) _f[seki].tefuda[i] |= 0x200;}}else if(i){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='立三本';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=36;_f[seki].yaku_point_total+=36;_f[seki].yaku_name_ctr++;i=7; while(--i>=0){if((_f[seki].tefuda[i] & 0xf0)==te3m) _f[seki].tefuda[i] |= 0x200;}}else {_f[seki].yaku_name[_f[seki].yaku_name_ctr]='三本';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=24;_f[seki].yaku_point_total+=24;_f[seki].yaku_name_ctr++;i=7; while(--i>=0){if((_f[seki].tefuda[i] & 0xf0)==te3m) _f[seki].tefuda[i] |= 0x200;}}_f_88_yaku_flag=1;}i=7; k=-1;while(--i>=0){j=_f_normalize_code(_f[seki].tefuda[i] & 0xff);if((j & 15)==0 || (j & 0xf0)==0xb0) continue;if((j & 15)!=3 || k>-1) break;k=i;}if(i<0 && k>-1){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='光一';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=48;_f[seki].yaku_point_total+=48;_f[seki].yaku_name_ctr++;i=7; while(--i>=0){if(i!=k) _f[seki].tefuda[i] |= 0x200;}_f[seki].pikaichi_flag=1;_f_88_yaku_flag=1;}else {i=7; k=-1;while(--i>=0){j=_f_normalize_code(_f[seki].tefuda[i] & 0xff);if((j & 15)!=0 && (j & 0xf0)!=0xb0) break;}if(i<0){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='からす';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=48;_f[seki].yaku_point_total+=48;_f[seki].yaku_name_ctr++;i=7; while(--i>=0)  _f[seki].tefuda[i] |= 0x200;_f[seki].nukeyaku='からす';_f[seki].karasu_flag=1;_f_88_yaku_flag=1;}else {i=7; k=-1;while(--i>=0){j=_f_normalize_code(_f[seki].tefuda[i] & 0xff);if((j & 15)==0 || (j & 0xf0)==0xb0) continue;if((j & 15)!=2 || k>-1) break;k=i;}if(i<0){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='十一';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=36;_f[seki].yaku_point_total+=36;_f[seki].yaku_name_ctr++;i=7; while(--i>=0){if(i!=k) _f[seki].tefuda[i] |= 0x200;}_f[seki].nukeyaku='十一';_f[seki].toichi_flag=1;_f_88_yaku_flag=1;}else {i=7; k=0;while(--i>=0){j=_f_normalize_code(_f[seki].tefuda[i] & 0xff);if((j & 15)==0 || (j & 0xf0)==0xb0) continue;if((j & 15)!=1) break;++k;}if(i<0){if(k==1){l=_f[seki].yaku_name[_f[seki].yaku_name_ctr]='短一';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=36;_f[seki].yaku_point_total+=36;_f[seki].yaku_name_ctr++;_f[seki].tan_ichi_flag=1;}else {l=_f[seki].yaku_name[_f[seki].yaku_name_ctr]='赤';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=24;_f[seki].yaku_point_total+=24;_f[seki].yaku_name_ctr++;_f[seki].aka_flag=1;}i=7; k=0;while(--i>=0){j=_f_normalize_code(_f[seki].tefuda[i] & 0xff);if((j & 15)==0 || (j & 0xf0)==0xb0) _f[seki].tefuda[i] |= 0x200;}_f[seki].nukeyaku=l;_f_88_yaku_flag=1;}}}}}else if(_f_gamemode==_F_GAMEMODE_HANAAWASE){if(_f_rule_sel['HA_67kasu']){i=7; k=0; l=-1;while(--i>=0){j=_f_normalize_code(_f[seki].tefuda[i] & 0xff);if(j & 15){ l=i; ++k; }}if(!k){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='七カス';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=30;_f[seki].yaku_point_total+=30;_f[seki].yaku_name_ctr++;i=7; while(--i>=0)  _f[seki].tefuda[i] |= 0x200;}else if(_f_rule_sel['HA_67kasu']==2 && k==1){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='六カス';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=20;_f[seki].yaku_point_total+=20;_f[seki].yaku_name_ctr++;i=7; while(--i>=0){if(i==l) continue;_f[seki].tefuda[i] |= 0x200;}}}}else if(_f_gamemode==_F_GAMEMODE_KOIKOI){i=8; k=0;while(--i>=0){j=_f_normalize_code(_f[seki].tefuda[i] & 0xff);if(j & 15) break;}if(i<0 && !_f_rule_sel['KK_sokasu']){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='総カス';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=6;_f[seki].yaku_point_total+=6;_f[seki].yaku_name_ctr++;_f_teyaku_flag=1;i=8; while(--i>=0) _f[seki].tefuda[i] |= 0x200;}if(!_f_rule_sel['KK_kuttsuki'] && te2==4){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='喰付';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=6;_f[seki].yaku_point_total+=6;_f[seki].yaku_name_ctr++;_f_teyaku_flag=1;i=8; while(--i>=0) _f[seki].tefuda[i] |= 0x200;}if(!_f_rule_sel['KK_teshi'] && te4>0){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='手四';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=6;_f[seki].yaku_point_total+=6;_f[seki].yaku_name_ctr++;_f_teyaku_flag=1;i=8; while(--i>=0){if(!((_f[seki].tefuda[i] ^ te4m) & 0xf0)) _f[seki].tefuda[i] |= 0x200;}}if(!_f_rule_sel['KK_sansanni'] && te3==2 && te2){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='三々二';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=6;_f[seki].yaku_point_total+=6;_f[seki].yaku_name_ctr++;_f_teyaku_flag=1;i=8; while(--i>=0) _f[seki].tefuda[i] |= 0x200;}}else if(_f_gamemode==_F_GAMEMODE_600KEN){_f_600ken_te4_flag=0;_f[seki].current_point_600ken=_f[seki].point_600ken;if(te4>0){_f_600ken_te4_flag=1;i=8; while(--i>=0){if(!((_f[seki].tefuda[i] ^ te4m) & 0xf0)) _f[seki].tefuda[i] |= 0x200;}return(-1);}if(_f_month[i]==3){ ++te3; te3m=i << 4; }if(te3){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='手三';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=200;_f[seki].yaku_point_total+=200;_f[seki].current_point_600ken+=200;_f[seki].yaku_name_ctr++;i=8; if(_f_players==3) --i;while(--i>=0){if((_f[seki].tefuda[i] & 0xf0)==te3m) _f[seki].tefuda[i] |= 0x200;}}i=8; if(_f_players==3) --i;while(--i>=0){if(_f[seki].tefuda[i] & 0x0f) break;}if(i<0){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='総ガス';_f[seki].yaku_point[_f[seki].yaku_name_ctr]=400;_f[seki].yaku_point_total+=400;_f[seki].current_point_600ken+=400;_f[seki].yaku_name_ctr++;i=8; if(_f_players==3) --i;while(--i>=0) _f[seki].tefuda[i] |= 0x200;}_f[seki].point_600ken=_f[seki].current_point_600ken;if(_f_600ken_victor<0 && _f[seki].point_600ken>599) _f_600ken_victor=seki;return(_f[seki].yaku_name_ctr);}else { return(0); }if(_f[seki].yaku_name_ctr){j=_f[seki].yaku_point_total;if(_f_gamemode==_F_GAMEMODE_88){if(_f_88_ba_rate>1) j <<=1;if(_f_88_ba_rate>2) j <<=1;}if(_f_gamemode!=_F_GAMEMODE_600KEN){k=0; i=_f_players; while(--i>=0){if(i==seki) continue;_f[i].balance-=j; k+=j;_f[i].balance_total=_f[i].balance;_f[i].score_after_balance=_f[i].score+_f[i].balance_total;}}else k=j;_f[seki].balance+=k;_f[seki].balance_total=_f[seki].balance;_f[seki].score_after_balance=_f[seki].score+_f[seki].balance_total;_f_result_after_balance();}return(_f[seki].yaku_name_ctr);}function _f_dekiyaku_judge(seki){var i, j, k, f, h, t=0;_f_yaku_yakunagashi=0;if(_f_gamemode==_F_GAMEMODE_88){var y_5ko=y_40=y_aka=y_ao=y_ino=y_7tan=0;i=3; while(--i>=0){_f[i].torifuda_dekiyaku=0;_f[i].balance_payback=0;_f[i].balance=0;_f[i].balance_total=0;_f[i].score_after_balance=_f[i].score;_f[i].yaku_name_ctr=0;_f[i].payback_name_ctr=0;_f[i].yaku_point_total=0;_f[i].yaku_result_point=0;_f[i].torifuda_total=0;}var rate=1;if(_f_88_ba_rate>1) rate=2;if(_f_88_ba_rate>2) rate=4;if((h=_f_koikoi_flag)>-1 && h!=seki) _f_88_payback();else h=-1;if(_f[seki].torifuda20_ctr==5 && !_f[seki].goko_flag){t=0;_f[seki].yaku_name[_f[seki].yaku_name_ctr]='五光';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=144;_f[seki].yaku_result_point+=144;if(h>-1){t+=144*(_f_players-1)*rate;_f[h].balance-=144*(_f_players-1)*rate;}else {j=_f_players; while(--j>=0){if(j==seki) continue;_f[j].balance-=144*rate;t+=144*rate;}}_f[seki].balance+=t;i=5; while(--i>=0) _f[seki].torifuda20[i] |= 0x400;y_5ko=_f[seki].goko_flag=1;_f_88_yaku_flag=1;}else if(_f[seki].torifuda20_ctr==4 && !_f[seki].shiko_flag){t=0;i=4; while(--i>=0){if((_f[seki].torifuda20[i] & 0xf0)==0xb0) break;}if(i<0){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='四光';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=120;_f[seki].yaku_result_point+=120;if(h>-1){_f[h].balance-=120*(_f_players-1)*rate;t+=120*(_f_players-1)*rate;}else if(_f_88_hatto_shiko>=0 && _f_88_hatto_shiko!=seki){_f[_f_88_hatto_shiko].balance-=120*(_f_players-1)*rate;t+=120*(_f_players-1)*rate;}else {j=_f_players; while(--j>=0){if(j==seki) continue;_f[j].balance-=120*rate;t+=120*rate;}}_f[seki].balance+=t;i=4; while(--i>=0) _f[seki].torifuda20[i] |= 0x400;y_40=_f[seki].shiko_flag=1;_f_88_yaku_flag=1;}}if(_f[seki].torifuda10_ctr>2 && !_f[seki].inoshikacho_flag && !_f_rule_sel['HH_inoshikacho']){t=0;i=_f[seki].torifuda10_ctr; j=3; t=0;while(--i>=0){k=_f[seki].torifuda10[i] & 0xff;if(k==0x62 || k==0x72 || k==0xA2) --j;}if(!j){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='猪鹿蝶';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=84;_f[seki].yaku_result_point+=84;if(h>-1){_f[h].balance-=84*(_f_players-1)*rate;t+=84*(_f_players-1)*rate;}else if(_f_88_hatto_inoshikacho>=0 && _f_88_hatto_inoshikacho!=seki){_f[_f_88_hatto_inoshikacho].balance-=84*(_f_players-1)*rate;t+=84*(_f_players-1)*rate;}else {j=_f_players; while(--j>=0){if(j==seki) continue;_f[j].balance-=84*rate;t+=84*rate;}}_f[seki].balance+=t;i=_f[seki].torifuda10_ctr; j=3;while(--i>=0){k=_f[seki].torifuda10[i] & 0xff;if(k==0x62 || k==0x72 || k==0xA2) _f[seki].torifuda10[i] |= 0x400;}y_ino=_f[seki].inoshikacho_flag=1;_f_88_yaku_flag=1;}}if(_f[seki].torifuda05_ctr>2 && !_f[seki].akatan_flag){t=0;i=_f[seki].torifuda05_ctr; j=3; t=0;while(--i>=0){k=_f[seki].torifuda05[i] & 0xff;if(k==0x11 || k==0x21 || k==0x31) --j;}if(!j){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='赤短';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=84;_f[seki].yaku_result_point+=84;if(h>-1){_f[h].balance-=84*(_f_players-1)*rate;t+=84*(_f_players-1)*rate;}else if(_f_88_hatto_akatan>=0 && _f_88_hatto_akatan!=seki){_f[_f_88_hatto_akatan].balance-=84*(_f_players-1)*rate;t+=84*(_f_players-1)*rate;}else {j=_f_players; while(--j>=0){if(j==seki) continue;_f[j].balance-=84*rate;t+=84*rate;}}_f[seki].balance+=t;i=_f[seki].torifuda05_ctr; j=3;while(--i>=0){k=_f[seki].torifuda05[i] & 0xff;if(k==0x11 || k==0x21 || k==0x31) _f[seki].torifuda05[i] |= 0x400;}y_aka=_f[seki].akatan_flag=1;_f_88_yaku_flag=1;}}if(_f[seki].torifuda05_ctr>2 && !_f[seki].aotan_flag){t=0;i=_f[seki].torifuda05_ctr; j=3; t=0;while(--i>=0){k=_f[seki].torifuda05[i] & 0xff;if(k==0x61 || k==0x91 || k==0xA1) --j;}if(!j){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='青短';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=84;_f[seki].yaku_result_point+=84;if(h>-1){_f[h].balance-=84*(_f_players-1)*rate;t+=84*(_f_players-1)*rate;}else if(_f_88_hatto_aotan>=0 && _f_88_hatto_aotan!=seki){_f[_f_88_hatto_aotan].balance-=84*(_f_players-1)*rate;t+=84*(_f_players-1)*rate;}else {j=_f_players; while(--j>=0){if(j==seki) continue;_f[j].balance-=84*rate;t+=84*rate;}}_f[seki].balance+=t;i=_f[seki].torifuda05_ctr; j=3;while(--i>=0){k=_f[seki].torifuda05[i] & 0xff;if(k==0x61 || k==0x91 || k==0xA1) _f[seki].torifuda05[i] |= 0x400;}y_ao=_f[seki].aotan_flag=1;_f_88_yaku_flag=1;}}if(_f[seki].torifuda05_ctr>6 && !_f[seki].nanatan_flag){t=0;i=_f[seki].torifuda05_ctr; j=0; t=0;while(--i>=0){k=_f[seki].torifuda05[i] & 0xff;if(k!=0xB1) ++j;}if(j>6){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='七短';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=120;_f[seki].yaku_result_point+=120;if(h>-1){_f[h].balance-=120*(_f_players-1)*rate;t+=120*(_f_players-1)*rate;}else {j=_f_players; while(--j>=0){if(j==seki) continue;_f[j].balance-=120*rate;t+=120*rate;}}_f[seki].balance+=t;i=-1; j=0;while(++i<_f[seki].torifuda05_ctr){k=_f[seki].torifuda05[i] & 0xff;if(k==0xB1) continue;_f[seki].torifuda05[i] |= 0x400;if(++j>=7) break;}y_7tan=_f[seki].nanatan_flag=1;_f_88_yaku_flag=1;}}var f=0;if(_f[seki].goko_flag && !y_5ko){if(!f){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='以下収受済み';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=0;f=1;}_f[seki].yaku_name[_f[seki].yaku_name_ctr]='五光';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=10144;}if(_f[seki].shiko_flag && !y_40){if(!f){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='以下収受済み';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=0;f=1;}_f[seki].yaku_name[_f[seki].yaku_name_ctr]='四光';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=10120;}if(_f[seki].inoshikacho_flag && !y_ino && !_f_rule_sel['HH_inoshikacho']){if(!f){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='以下収受済み';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=0;f=1;}_f[seki].yaku_name[_f[seki].yaku_name_ctr]='猪鹿蝶';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=10084;}if(_f[seki].akatan_flag && !y_aka){if(!f){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='以下収受済み';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=0;f=1;}_f[seki].yaku_name[_f[seki].yaku_name_ctr]='赤短';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=10084;}if(_f[seki].aotan_flag && !y_ao){if(!f){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='以下収受済み';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=0;f=1;}_f[seki].yaku_name[_f[seki].yaku_name_ctr]='青短';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=10084;}if(_f[seki].nanatan_flag && !y_7tan){if(!f){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='以下収受済み';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=0;f=1;}_f[seki].yaku_name[_f[seki].yaku_name_ctr]='七短';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=10120;}i=3; while(--i>=0){_f[i].balance_total=_f[i].balance_payback+_f[i].balance;_f[i].score_after_balance=_f[i].score+_f[i].balance_total;}_f[seki].torifuda_dekiyaku=_f[seki].yaku_result_point*rate;_f_result_after_balance();return(_f[seki].yaku_result_point);}if(_f_gamemode==_F_GAMEMODE_KOIKOI){i=3;while(--i>=0){_f[i].balance_payback=0;_f[i].balance=0;_f[i].balance_total=0;_f[i].score_after_balance=_f[i].score;_f[i].yaku_name_ctr=0;_f[i].payback_name_ctr=0;_f[i].yaku_point_total=0;_f[i].yaku_result_point=0;_f[i].torifuda_total=0;_f[i].torifuda_dekiyaku=0;}if(_f[seki].torifuda20_ctr==5){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='五光';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=15;_f[seki].yaku_result_point+=15;i=5; while(--i>=0) _f[seki].torifuda20[i] |= 0x400;}else if(_f[seki].torifuda20_ctr==4){i=4; while(--i>=0){if((_f[seki].torifuda20[i] & 0xf0)==0xb0) break;}if(i<0){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='四光';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=10;_f[seki].yaku_result_point+=10;i=4; while(--i>=0) _f[seki].torifuda20[i] |= 0x400;}else if(!_f_rule_sel['KK_ameshiko']){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='雨入り四光';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=8;_f[seki].yaku_result_point+=8;i=4; while(--i>=0) _f[seki].torifuda20[i] |= 0x400;}else if(!_f_rule_sel['KK_sanko']){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='三光';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=6;_f[seki].yaku_result_point+=6;i=4; while(--i>=0){if((_f[seki].torifuda20[i] & 0xf0)!=0xb0) _f[seki].torifuda20[i] |= 0x400;}}}else if((j=_f[seki].torifuda20_ctr)>2){i=4; while(--i>=0){if((_f[seki].torifuda20[i] & 0xf0)==0xb0) --j;}if(j==3 && !_f_rule_sel['KK_sanko']){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='三光';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=6;_f[seki].yaku_result_point+=6;i=3; while(--i>=0) _f[seki].torifuda20[i] |= 0x400;}}var tan=4;if(_f[seki].torifuda05_ctr>2){var r=b=3;i=_f[seki].torifuda05_ctr; j=3;while(--i>=0){k=_f[seki].torifuda05[i] & 0xff;if(k==0x11 || k==0x21 || k==0x31) --r;if(k==0x61 || k==0x91 || k==0xA1) --b;}if(!r && !b){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='赤青短';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=15;_f[seki].yaku_result_point+=15;tan=6;i=_f[seki].torifuda05_ctr; while(--i>=0){k=_f[seki].torifuda05[i] & 0xff;if(k==0x11 || k==0x21 || k==0x31 ||    k==0x61 || k==0x91 || k==0xA1)_f[seki].torifuda05[i] |= 0x400;}}else if(!r){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='赤短';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=6;_f[seki].yaku_result_point+=6;tan=3;i=_f[seki].torifuda05_ctr; while(--i>=0){k=_f[seki].torifuda05[i] & 0xff;if(k==0x11 || k==0x21 || k==0x31) _f[seki].torifuda05[i] |= 0x400;}}else if(!b){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='青短';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=6;_f[seki].yaku_result_point+=6;tan=3;i=_f[seki].torifuda05_ctr; while(--i>=0){k=_f[seki].torifuda05[i] & 0xff;if(k==0x61 || k==0x91 || k==0xA1) _f[seki].torifuda05[i] |= 0x400;}}}var tane=4;if(_f[seki].torifuda10_ctr>2){i=_f[seki].torifuda10_ctr; j=3;while(--i>=0){if((k=_f[seki].torifuda10[i] & 0xff)==0x62 || k==0x72 || k==0xA2) --j;}if(!j && !_f_rule_sel['KK_inoshikacho']){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='猪鹿蝶';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=5;_f[seki].yaku_result_point+=5;tane=3;i=_f[seki].torifuda10_ctr; while(--i>=0){k=_f[seki].torifuda10[i] & 0xff;if(k==0x62 || k==0x72 || k==0xA2) _f[seki].torifuda10[i] |= 0x400;}}}i=_f[seki].torifuda10_ctr; j=3;var h=t=b=g=0;while(--i>=0){if((k=_f[seki].torifuda10[i] & 0xff)==0x72 || k==0x52) --j;if(k==0x22){ ++g; }if(k==0x92){ ++h; ++t; ++b; }}i=_f[seki].torifuda20_ctr;while(--i>=0){k=_f[seki].torifuda20[i] & 0xff;if(k==0x33){ --j; ++h; ++g; }if(k==0x13){ ++g; }if(k==0x83){ ++t; }}if(!j && !_f_rule_sel['KK_shichigosan']){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='七五三';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=5;_f[seki].yaku_result_point+=5;i=_f[seki].torifuda10_ctr; while(--i>=0){if((k=_f[seki].torifuda10[i] & 0xff)==0x72 || k==0x52) _f[seki].torifuda10[i] |= 0x400;}i=_f[seki].torifuda20_ctr; while(--i>=0){if((_f[seki].torifuda20[i] & 0xff)==0x33) _f[seki].torifuda20[i] |= 0x400;}}if(g==3 && _f_rule_sel['KK_omotesugawara']){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='表菅原';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=5;_f[seki].yaku_result_point+=5;i=_f[seki].torifuda10_ctr; while(--i>=0){if((_f[seki].torifuda10[i] & 0xff)==0x22) _f[seki].torifuda10[i] |= 0x400;}i=_f[seki].torifuda20_ctr; while(--i>=0){if((_f[seki].torifuda20[i] & 0xff)==0x33 || (_f[seki].torifuda20[i] & 0xff)==0x13) _f[seki].torifuda20[i] |= 0x400;}}if(h==2 && !_f_rule_sel['KK_hanamisake']){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='花見酒';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=5;_f[seki].yaku_result_point+=5;i=_f[seki].torifuda10_ctr; while(--i>=0){if((_f[seki].torifuda10[i] & 0xff)==0x92) _f[seki].torifuda10[i] |= 0x400;}i=_f[seki].torifuda20_ctr; while(--i>=0){if((_f[seki].torifuda20[i] & 0xff)==0x33) _f[seki].torifuda20[i] |= 0x400;}}if(t==2 && !_f_rule_sel['KK_hanamisake']){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='月見酒';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=5;_f[seki].yaku_result_point+=5;i=_f[seki].torifuda10_ctr; while(--i>=0){if((_f[seki].torifuda10[i] & 0xff)==0x92) _f[seki].torifuda10[i] |= 0x400;}i=_f[seki].torifuda20_ctr; while(--i>=0){if((_f[seki].torifuda20[i] & 0xff)==0x83) _f[seki].torifuda20[i] |= 0x400;}}if((i=_f[seki].torifuda05_ctr-tan)>0){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='短冊';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=i;_f[seki].yaku_result_point+=i;i=_f[seki].torifuda05_ctr; while(--i>=0) _f[seki].torifuda05[i] |= 0x400;}if((i=_f[seki].torifuda10_ctr-tane)>0){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='種札';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=i;_f[seki].yaku_result_point+=i;i=_f[seki].torifuda10_ctr; while(--i>=0) _f[seki].torifuda10[i] |= 0x400;}if(_f_rule_sel['KK_bakefuda']) b=0;if((i=_f[seki].torifuda01_ctr+b-9)>0){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='カス';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=i;_f[seki].yaku_result_point+=i;i=_f[seki].torifuda01_ctr; while(--i>=0) _f[seki].torifuda01[i] |= 0x400;if(!_f_rule_sel['KK_bakefuda']){i=_f[seki].torifuda10_ctr; while(--i>=0){if((_f[seki].torifuda10[i] & 0xff)==0x92) _f[seki].torifuda10[i] |= 0x400;}}}j=1; if(seki) j=0;_f[j].balance=_f[j].balance_total=-_f[seki].yaku_result_point;_f[j].score_after_balance=_f[j].score+_f[j].balance_total;_f[seki].balance=_f[seki].balance_total=_f[seki].yaku_result_point;_f[seki].score_after_balance=_f[seki].score+_f[seki].balance_total;_f[seki].torifuda_dekiyaku=_f[seki].yaku_result_point;_f[0].nobalance=_f[1].nobalance=1;_f_result_after_balance();return(_f[seki].yaku_result_point);}if(_f_gamemode==_F_GAMEMODE_600KEN){i=seki;_f[i].balance_payback=0;_f[i].balance=0;_f[i].balance_total=0;_f[i].score_after_balance=_f[i].score;_f[i].yaku_name_ctr=0;_f[i].payback_name_ctr=0;_f[i].yaku_point_total=0;_f[i].yaku_result_point=0;_f[i].torifuda_total=0;_f[i].torifuda_dekiyaku=0;var l=m=0, yn=0, hd=0;if((i=_f[seki].torifuda20_ctr)>0){k=0; while(--i>=0){if((j=_f[seki].torifuda20[i] & 0xf0)==0x10){ k++; l++; m++; hd++; }if(j==0x20){ l++; }if(j==0x30){ k++; l++; }if(j==0x80){ k++; m++; }if(j==0xc0){ k++; m++; }if(j==0xb0) yn++;}if(k==4){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='四光';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=0;_f[seki].yaku_result_point+=600;_f_600ken_4ko_flag=_f_600ken_victor=_f_600ken_ichikoro_flag=seki;i=_f[seki].torifuda20_ctr; while(--i>=0){if((j=_f[seki].torifuda20[i] & 0xf0)==0x10 || j==0x30 || j==0x80 || j==0xc0) _f[seki].torifuda20[i] |= 0x8400;}}if(l==3){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='大三';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=100;_f[seki].yaku_result_point+=100;i=_f[seki].torifuda20_ctr; while(--i>=0){if((j=_f[seki].torifuda20[i] & 0xf0)==0x10 || j==0x20 || j==0x30) _f[seki].torifuda20[i] |= 0x1400;}}if(m==3){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='松桐坊主';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=150;_f[seki].yaku_result_point+=150;i=_f[seki].torifuda20_ctr; while(--i>=0){if((j=_f[seki].torifuda20[i] & 0xf0)==0x10 || j==0x80 || j==0xc0) _f[seki].torifuda20[i] |= 0x1400;}}}if((i=_f[seki].torifuda05_ctr)>=3){if(i>=7){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='七短';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=0;_f[seki].yaku_result_point+=600;if(_f_600ken_ichikoro_flag<0) _f_600ken_victor=_f_600ken_ichikoro_flag=seki;if(i>7) i=7;while(--i>=0) _f[seki].torifuda05[i] |= 0x8400;i=_f[seki].torifuda05_ctr;}l=m=0;k=0; while(--i>=0){if((j=_f[seki].torifuda05[i] & 0xf0)<0x40){ k++; }if(j==0x40 || j==0x50 || j==0x70){ l++; }if(j==0x60 || j==0x90 || j==0xa0){ m++; }if(j==0xb0) yn++;}if(k==3){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='小三';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=150;_f[seki].yaku_result_point+=150;i=_f[seki].torifuda05_ctr; while(--i>=0){if((_f[seki].torifuda05[i] & 0xf0)<0x40) _f[seki].torifuda05[i] |= 0x400;}}if(m==3){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='青短';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=200;_f[seki].yaku_result_point+=200;i=_f[seki].torifuda05_ctr; while(--i>=0){if((j=_f[seki].torifuda05[i] & 0xf0)==0x60 || j==0x90 || j==0xa0) _f[seki].torifuda05[i] |= 0x400;}}if(l==3){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='草短';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=100;_f[seki].yaku_result_point+=100;i=_f[seki].torifuda05_ctr; while(--i>=0){if((j=_f[seki].torifuda05[i] & 0xf0)==0x40 || j==0x50 || j==0x70) _f[seki].torifuda05[i] |= 0x400;}}}l=0;if((i=_f[seki].torifuda10_ctr)>0){k=0; while(--i>=0){if((j=_f[seki].torifuda10[i] & 0xf0)==0x70 || j==0x60 || j==0xa0){ k++; }if(j==0x90){ l++; }if(j==0xb0) yn++;}if(k==3){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='猪鹿蝶';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=300;_f[seki].yaku_result_point+=300;i=_f[seki].torifuda10_ctr; while(--i>=0){if((j=_f[seki].torifuda10[i] & 0xf0)==0x70 || j==0x60 || j==0xa0) _f[seki].torifuda10[i] |= 0x400;}}}i=_f[seki].torifuda01_ctr; while(--i>=0){if((_f[seki].torifuda01[i] & 0xf0)==0xb0) yn++;}if(l && (i=_f[seki].torifuda20_ctr)>0){k=l=0; while(--i>=0){if((j=_f[seki].torifuda20[i] & 0xf0)==0x30){ k++; }if(j==0x80){ l++; }}if(k && l){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='鉄砲';if(yn && !hd){_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=-1;i=_f[seki].torifuda10_ctr; while(--i>=0){if((_f[seki].torifuda10[i] & 0xf0)==0x90) _f[seki].torifuda10[i] &= 0x83ff;}i=_f[seki].torifuda20_ctr; while(--i>=0){if((j=_f[seki].torifuda20[i] & 0xf0)==0x30 || j==0x80) _f[seki].torifuda20[i] &= 0x83ff;}}else {_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=300;_f[seki].yaku_result_point+=300;i=_f[seki].torifuda10_ctr; while(--i>=0){if((_f[seki].torifuda10[i] & 0xf0)==0x90) _f[seki].torifuda10[i] |= 0x400;}i=_f[seki].torifuda20_ctr; while(--i>=0){if((j=_f[seki].torifuda20[i] & 0xf0)==0x30 || j==0x80) _f[seki].torifuda20[i] |= 0x400;}}}else if(k){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='花見酒';if(yn && !hd){_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=-1;i=_f[seki].torifuda10_ctr; while(--i>=0){if((_f[seki].torifuda10[i] & 0xf0)==0x90) _f[seki].torifuda10[i] &= 0x83ff;}i=_f[seki].torifuda20_ctr; while(--i>=0){if((_f[seki].torifuda20[i] & 0xf0)==0x30) _f[seki].torifuda20[i] &= 0x83ff;}}else {_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=100;_f[seki].yaku_result_point+=100;i=_f[seki].torifuda10_ctr; while(--i>=0){if((_f[seki].torifuda10[i] & 0xf0)==0x90) _f[seki].torifuda10[i] |= 0x400;}i=_f[seki].torifuda20_ctr; while(--i>=0){if((_f[seki].torifuda20[i] & 0xf0)==0x30) _f[seki].torifuda20[i] |= 0x400;}}}else if(l){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='月見酒';if(yn && !hd){_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=-1;i=_f[seki].torifuda10_ctr; while(--i>=0){if((_f[seki].torifuda10[i] & 0xf0)==0x90) _f[seki].torifuda10[i] &= 0x83ff;}i=_f[seki].torifuda20_ctr; while(--i>=0){if((_f[seki].torifuda20[i] & 0xf0)==0x80) _f[seki].torifuda20[i] &= 0x83ff;}}else {_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=100;_f[seki].yaku_result_point+=100;i=_f[seki].torifuda10_ctr; while(--i>=0){if((_f[seki].torifuda10[i] & 0xf0)==0x90) _f[seki].torifuda10[i] |= 0x400;}i=_f[seki].torifuda20_ctr; while(--i>=0){if((_f[seki].torifuda20[i] & 0xf0)==0x80) _f[seki].torifuda20[i] |= 0x400;}}}}var month=new Array(13);i=13; while(--i>=0) month[i]=0;i=_f[seki].torifuda20_ctr; while(--i>=0) month[(_f[seki].torifuda20[i] >> 4) & 15]++;i=_f[seki].torifuda10_ctr; while(--i>=0) month[(_f[seki].torifuda10[i] >> 4) & 15]++;i=_f[seki].torifuda05_ctr; while(--i>=0) month[(_f[seki].torifuda05[i] >> 4) & 15]++;i=_f[seki].torifuda01_ctr; while(--i>=0) month[(_f[seki].torifuda01[i] >> 4) & 15]++;if(month[11]>3){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='二ゾロ';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=200;_f[seki].yaku_result_point+=200;i=_f[seki].torifuda01_ctr; while(--i>=0){if((_f[seki].torifuda01[i] & 0xf0)==0xb0) _f[seki].torifuda01[i] |= 0x400;}i=_f[seki].torifuda05_ctr; while(--i>=0){if((_f[seki].torifuda05[i] & 0xf0)==0xb0) _f[seki].torifuda05[i] |= 0x400;}i=_f[seki].torifuda10_ctr; while(--i>=0){if((_f[seki].torifuda10[i] & 0xf0)==0xb0) _f[seki].torifuda10[i] |= 0x400;}i=_f[seki].torifuda20_ctr; while(--i>=0){if((_f[seki].torifuda20[i] & 0xf0)==0xb0) _f[seki].torifuda20[i] |= 0x400;}}if(month[1]>3){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='松シマ';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=50;_f[seki].yaku_result_point+=50;i=_f[seki].torifuda01_ctr; while(--i>=0){if((_f[seki].torifuda01[i] & 0xf0)==0x10) _f[seki].torifuda01[i] |= 0x400;}i=_f[seki].torifuda05_ctr; while(--i>=0){if((_f[seki].torifuda05[i] & 0xf0)==0x10) _f[seki].torifuda05[i] |= 0x400;}i=_f[seki].torifuda20_ctr; while(--i>=0){if((_f[seki].torifuda20[i] & 0xf0)==0x10) _f[seki].torifuda20[i] |= 0x400;}}if(month[2]>3){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='梅シマ';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=50;_f[seki].yaku_result_point+=50;i=_f[seki].torifuda01_ctr; while(--i>=0){if((_f[seki].torifuda01[i] & 0xf0)==0x20) _f[seki].torifuda01[i] |= 0x400;}i=_f[seki].torifuda05_ctr; while(--i>=0){if((_f[seki].torifuda05[i] & 0xf0)==0x20) _f[seki].torifuda05[i] |= 0x400;}i=_f[seki].torifuda20_ctr; while(--i>=0){if((_f[seki].torifuda20[i] & 0xf0)==0x20) _f[seki].torifuda20[i] |= 0x400;}}if(month[3]>3){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='桜シマ';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=50;_f[seki].yaku_result_point+=50;i=_f[seki].torifuda01_ctr; while(--i>=0){if((_f[seki].torifuda01[i] & 0xf0)==0x30) _f[seki].torifuda01[i] |= 0x400;}i=_f[seki].torifuda05_ctr; while(--i>=0){if((_f[seki].torifuda05[i] & 0xf0)==0x30) _f[seki].torifuda05[i] |= 0x400;}i=_f[seki].torifuda10_ctr; while(--i>=0){if((_f[seki].torifuda10[i] & 0xf0)==0x30) _f[seki].torifuda10[i] |= 0x400;}i=_f[seki].torifuda20_ctr; while(--i>=0){if((_f[seki].torifuda20[i] & 0xf0)==0x30) _f[seki].torifuda20[i] |= 0x400;}}if(month[4]>3){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='藤シマ';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=50;_f[seki].yaku_result_point+=50;i=_f[seki].torifuda01_ctr; while(--i>=0){if((_f[seki].torifuda01[i] & 0xf0)==0x40) _f[seki].torifuda01[i] |= 0x400;}i=_f[seki].torifuda05_ctr; while(--i>=0){if((_f[seki].torifuda05[i] & 0xf0)==0x40) _f[seki].torifuda05[i] |= 0x400;}i=_f[seki].torifuda10_ctr; while(--i>=0){if((_f[seki].torifuda10[i] & 0xf0)==0x40) _f[seki].torifuda10[i] |= 0x400;}}if(month[8]>3){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='坊主シマ';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=50;_f[seki].yaku_result_point+=50;i=_f[seki].torifuda01_ctr; while(--i>=0){if((_f[seki].torifuda01[i] & 0xf0)==0x80) _f[seki].torifuda01[i] |= 0x400;}i=_f[seki].torifuda10_ctr; while(--i>=0){if((_f[seki].torifuda10[i] & 0xf0)==0x80) _f[seki].torifuda10[i] |= 0x400;}i=_f[seki].torifuda20_ctr; while(--i>=0){if((_f[seki].torifuda20[i] & 0xf0)==0x80) _f[seki].torifuda20[i] |= 0x400;}}if(month[10]>3){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='紅葉シマ';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=50;_f[seki].yaku_result_point+=50;i=_f[seki].torifuda01_ctr; while(--i>=0){if((_f[seki].torifuda01[i] & 0xf0)==0xa0) _f[seki].torifuda01[i] |= 0x400;}i=_f[seki].torifuda05_ctr; while(--i>=0){if((_f[seki].torifuda05[i] & 0xf0)==0xa0) _f[seki].torifuda05[i] |= 0x400;}i=_f[seki].torifuda10_ctr; while(--i>=0){if((_f[seki].torifuda10[i] & 0xf0)==0xa0) _f[seki].torifuda10[i] |= 0x400;}}if(month[12]>3){_f[seki].yaku_name[_f[seki].yaku_name_ctr]='桐シマ';_f[seki].yaku_point[_f[seki].yaku_name_ctr++]=50;_f[seki].yaku_result_point+=50;i=_f[seki].torifuda01_ctr; while(--i>=0){if((_f[seki].torifuda01[i] & 0xf0)==0xc0) _f[seki].torifuda01[i] |= 0x400;}i=_f[seki].torifuda10_ctr; while(--i>=0){if((_f[seki].torifuda10[i] & 0xf0)==0xc0) _f[seki].torifuda10[i] |= 0x400;}i=_f[seki].torifuda20_ctr; while(--i>=0){if((_f[seki].torifuda20[i] & 0xf0)==0xc0) _f[seki].torifuda20[i] |= 0x400;}}_f[seki].koikoi_monsu=_f[seki].yaku_result_point;_f[seki].current_point_600ken=_f[seki].point_600ken+_f[seki].yaku_result_point+_f[seki].torifuda05_ctr*10+_f[seki].torifuda10_ctr*10+_f[seki].torifuda20_ctr*50;if(_f_600ken_ichikoro_flag<0){_f_600ken_victor=-1;var s=_f_oya, c=_f_players, m=599;while(--c>-1){if(_f[s].current_point_600ken>m){m=_f[s].current_point_600ken;_f_600ken_victor=s;}if(++s>=_f_players) s=0;}}return(_f[seki].yaku_result_point);}}function _f_hatto_check(){var seki=3, i, j, m, n;while(--seki>=0){m=n=2;i=_f[seki].torifuda05_ctr;while(--i>=0){j=(_f[seki].torifuda05[i] >> 4) & 15;if(j<4) --m;if(j==6 || j==9 || j==10) --n;}if(_f_88_hatto_akatan<0 && !m) _f_88_hatto_akatan=-2;if(_f_88_hatto_aotan<0 && !n) _f_88_hatto_aotan=-2;m=2;i=_f[seki].torifuda10_ctr;while(--i>=0){j=(_f[seki].torifuda10[i] >> 4) & 15;if(j==6 || j==7 || j==10) --m;}if(_f_88_hatto_inoshikacho<0 && !m) _f_88_hatto_inoshikacho=-2;m=3;i=_f[seki].torifuda20_ctr;while(--i>=0){j=(_f[seki].torifuda20[i] >> 4) & 15;if(j!=11) --m;}if(_f_88_hatto_shiko<0 && !m) _f_88_hatto_shiko=-2;}}function _f_hatto_yaburi_check(fuda){var i=fuda & 0xff;if(_f_yamafuda_remain<4) return;if(_f_88_hatto_akatan<-1 && (i==0x11 || i==0x21 || i==0x31)) _f_88_hatto_akatan=_f_seki;if(_f_88_hatto_aotan<-1 && (i==0x61 || i==0x91 || i==0xA1)) _f_88_hatto_aotan=_f_seki;if(_f_88_hatto_inoshikacho<-1 && (i==0x72 || i==0xA2 || i==0x62)) _f_88_hatto_inoshikacho=_f_seki;if(_f_88_hatto_shiko<-1 && (i==0x13 || i==0x33 || i==0x83 || i==0xC3)) _f_88_hatto_shiko=_f_seki;}function _f_88_payback(){var j, t=0, u=0;var rate=1;if(_f_88_ba_rate>1) rate=2;if(_f_88_ba_rate>2) rate=4;if(_f_koikoi_flag<0) return;if(_f[_f_koikoi_flag].goko_flag){_f[_f_koikoi_flag].payback_name[_f[_f_koikoi_flag].payback_name_ctr]='五光';_f[_f_koikoi_flag].payback_point[_f[_f_koikoi_flag].payback_name_ctr++]=-72;_f[_f_koikoi_flag].payback_point_total-=72;u=72*rate; t=0;j=_f_players; while(--j>=0){if(j==_f_koikoi_flag) continue;_f[j].balance_payback+=u;_f[j].balance_total+=u;t+=u;}_f[_f_koikoi_flag].balance_payback-=t;_f[_f_koikoi_flag].balance_total-=t;}else if(_f[_f_koikoi_flag].shiko_flag){_f[_f_koikoi_flag].payback_name[_f[_f_koikoi_flag].payback_name_ctr]='四光';_f[_f_koikoi_flag].payback_point[_f[_f_koikoi_flag].payback_name_ctr++]=-60;_f[_f_koikoi_flag].payback_point_total-=60;u=60*rate; t=0; if(_f_88_hatto_shiko>=0 && _f_88_hatto_shiko!=_f_koikoi_flag){t=u*(_f_players-1);_f[_f_88_hatto_shiko].balance_payback+=t;_f[_f_88_hatto_shiko].balance_total+=t;}else {j=_f_players; while(--j>=0){if(j==_f_koikoi_flag) continue;_f[j].balance_payback+=u;_f[j].balance_total+=u;t+=u;}}_f[_f_koikoi_flag].balance_payback-=t;_f[_f_koikoi_flag].balance_total-=t;}if(_f[_f_koikoi_flag].inoshikacho_flag && !_f_rule_sel['HH_inoshikacho']){_f[_f_koikoi_flag].payback_name[_f[_f_koikoi_flag].payback_name_ctr]='猪鹿蝶';_f[_f_koikoi_flag].payback_point[_f[_f_koikoi_flag].payback_name_ctr++]=-42;_f[_f_koikoi_flag].payback_point_total-=42;u=42*rate; t=0; if(_f_88_hatto_inoshikacho>=0 && _f_88_hatto_inoshikacho!=_f_koikoi_flag){t=u*(_f_players-1);_f[_f_88_hatto_inoshikacho].balance_payback+=t;_f[_f_88_hatto_inoshikacho].balance_total+=t;}else {j=_f_players; while(--j>=0){if(j==_f_koikoi_flag) continue;_f[j].balance_payback+=u;_f[j].balance_total+=u;t+=u;}}_f[_f_koikoi_flag].balance_payback-=t;_f[_f_koikoi_flag].balance_total-=t;}if(_f[_f_koikoi_flag].akatan_flag){_f[_f_koikoi_flag].payback_name[_f[_f_koikoi_flag].payback_name_ctr]='赤短';_f[_f_koikoi_flag].payback_point[_f[_f_koikoi_flag].payback_name_ctr++]=-42;_f[_f_koikoi_flag].payback_point_total-=42;u=42*rate; t=0; if(_f_88_hatto_akatan>=0 && _f_88_hatto_akatan!=_f_koikoi_flag){t=u*(_f_players-1);_f[_f_88_hatto_akatan].balance_payback+=t;_f[_f_88_hatto_akatan].balance_total+=t;}else {j=_f_players; while(--j>=0){if(j==_f_koikoi_flag) continue;_f[j].balance_payback+=u;_f[j].balance_total+=u;t+=u;}}_f[_f_koikoi_flag].balance_payback-=t;_f[_f_koikoi_flag].balance_total-=t;}if(_f[_f_koikoi_flag].aotan_flag){_f[_f_koikoi_flag].payback_name[_f[_f_koikoi_flag].payback_name_ctr]='青短';_f[_f_koikoi_flag].payback_point[_f[_f_koikoi_flag].payback_name_ctr++]=-42;_f[_f_koikoi_flag].payback_point_total-=42;u=42*rate; t=0; if(_f_88_hatto_aotan>=0 && _f_88_hatto_aotan!=_f_koikoi_flag){t=u*(_f_players-1);_f[_f_88_hatto_aotan].balance_payback+=t;_f[_f_88_hatto_aotan].balance_total+=t;}else {j=_f_players; while(--j>=0){if(j==_f_koikoi_flag) continue;_f[j].balance_payback+=u;_f[j].balance_total+=u;t+=u;}}_f[_f_koikoi_flag].balance_payback-=t;_f[_f_koikoi_flag].balance_total-=t;}if(_f[_f_koikoi_flag].nanatan_flag){_f[_f_koikoi_flag].payback_name[_f[_f_koikoi_flag].payback_name_ctr]='七短';_f[_f_koikoi_flag].payback_point[_f[_f_koikoi_flag].payback_name_ctr++]=-60;_f[_f_koikoi_flag].payback_point_total-=60;u=60*rate; t=0;j=_f_players; while(--j>=0){if(j==_f_koikoi_flag) continue;_f[j].balance_payback+=u;_f[j].balance_total+=u;t+=u;}_f[_f_koikoi_flag].balance_payback-=t;_f[_f_koikoi_flag].balance_total-=t;}return;}
