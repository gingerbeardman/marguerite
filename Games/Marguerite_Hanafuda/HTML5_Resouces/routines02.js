function OCK_START(){var i, j, k;_f_toggle_sprite_disp(1);graph_noSprite=_f_rule_sel['UI_noSprite'] || 0;i=_f_players;while(--i>=0){j=4; while(--j>=0){_f[i].betted[j]=_f[i].oichokabu_koishimo[j]=_f[i].oichokabu_balance[j]=_f[i].oichokabu_total[j]=0;_f[i].oichokabu_total4disp[j]='';}j=16; while(--j>=0) _f[i].oichokabu_remain[j]=0;j=11; while(--j>0) _f[i].oichokabu_remain[j]=4;_f[i].balance_betted=0;}_f_oichokabu_betted_total=0;_f_oichokabu_limit=_f_oichokabu_domae;var oyako_str=new Array('親', '子', '子');j=0;i=_f_oya; do {_f[i].oyako=oyako_str[j++];if(++i>=_f_players) i=0;} while(j<_f_players);j=4; while(--j>=0){_f_oichokabu_betted_flag[j]=_f_oichokabu_opened_flag[j]=0;}if(_f_gamemode==_F_GAMEMODE_OICHOKABU) _f_yamafuda_disp(-1);_f_seki=_f_oya;i=3; while(--i>=0) _f_score_disp(i, 0xffffff);_f_oichokabu_oyaOpen=0;_f_oichokabu_oyaYaku='';if(_f_rule_sel['OCK_makifuda']){_f_h5_next=setTimeout('OCK_BAFUDA(); ', 10);return;}if(_f_gamemode==_F_GAMEMODE_KYOKABU){_f_h5_next=setTimeout('KYK_BAFUDA(); ', 10);return;}_f_h5_next=setTimeout('OCK_MAKIFUDA_1(); ', 10);}function OCK_MAKIFUDA_1(){var i;if(++_f_seki>=_f_players) _f_seki=0;if(_f_seki==_f_oya){_f_h5_next=setTimeout('OCK_BAFUDA(); ', 320);return;}else {i=_f[_f_seki].tefuda[0]=_f_yamafuda[--_f_yamafuda_remain];_f_yamafuda_disp(-1);_f_oichokabu_animation_makifuda(_f_seki, i);j=_f_players; while(--j>=0){var k=(i >> 4) & 15;if(k>10) k=k % 10;_f[j].oichokabu_remain[k]--;}}_f_h5_next=setTimeout('WAIT_MOVIE("OCK_MAKIFUDA_3"); ', 10);}function OCK_MAKIFUDA_3(){AUDIO_OUTPUT('kirifuda'+(++_h5_sound_ctr & 3), false);_f_tefuda_disp(_f_seki);_f_h5_next=setTimeout('OCK_MAKIFUDA_1(); ', 10);}function OCK_BAFUDA(){_f_i=-1;_f_h5_next=setTimeout('OCK_BAFUDA_1(); ', 10);}function OCK_BAFUDA_1(){var i;if(++_f_i>=4){_f_h5_next=setTimeout('OCK_BETTINGS(); ', 10);return;}i=_f_bafuda[_f_i]=_f_yamafuda[--_f_yamafuda_remain];_f_yamafuda_disp(-1);_f_oichokabu_animation_bafuda1(_f_i, i);j=_f_players; while(--j>=0){var k=(i >> 4) & 15;if(k>10) k=k % 10;_f[j].oichokabu_remain[k]--;}_f_h5_next=setTimeout('WAIT_MOVIE("OCK_BAFUDA_3"); ', 10);}function OCK_BAFUDA_3(){AUDIO_OUTPUT('kirifuda'+(++_h5_sound_ctr & 3), false);_f_bafuda_disp(0);_f_h5_next=setTimeout('OCK_BAFUDA_1(); ', 200);}function KYK_BAFUDA(){_f_i=-1;_f_h5_next=setTimeout('KYK_BAFUDA_1(); ', 10);}function KYK_BAFUDA_1(){var i, j;if(++_f_i>=4){_f_h5_next=setTimeout('KYK_BAFUDA_2(); ', 10);return;}j=_f_yamafuda_remain; while(--j>=0){i=_f_yamafuda[j];if(((i >> 4) & 15)==_f_i+5) break;}_f_bafuda[_f_i]=i;_f_yamafuda[j]=0;j=_f_players; while(--j>=0){var k=(i >> 4) & 15;if(k>10) k=k % 10;_f[j].oichokabu_remain[k]--;}_f_h5_next=setTimeout('KYK_BAFUDA_1_H5_1(); ', 80);}function KYK_BAFUDA_1_H5_1(){var i, j;AUDIO_OUTPUT('kirifuda'+(++_h5_sound_ctr & 3), false);_f_bafuda_disp(0);_f_h5_next=setTimeout('KYK_BAFUDA_1(); ', 80);}function KYK_BAFUDA_2(){var i, j, k, l;var a=new Array(40);i=_f_yamafuda_remain; j=0; while(--i>=0){if(((k=_f_yamafuda[i]) & 0xf0)==0) continue;a[j++]=k;}_f_yamafuda_remain=j;while(--j>=0){i=Math.floor(Math.random()*_f_yamafuda_remain);l=a[i]; a[i]=a[j]; a[j]=l ^ 0x100;i=Math.floor(Math.random()*_f_yamafuda_remain);k=Math.floor(Math.random()*_f_yamafuda_remain);l=a[k]; a[k]=a[i]; a[i]=l ^ 0x100;}j=_f_yamafuda_remain;while(--j>=0) _f_yamafuda[j]=a[j];_f_h5_next=setTimeout('KYK_BAFUDA_2_H5_1(); ', 320);}function KYK_BAFUDA_2_H5_1(){AUDIO_OUTPUT('mekurifuda'+(++_h5_sound_ctr & 3), false);_f_yamafuda_disp();_f_h5_next=setTimeout('KYK_OYA_TEFUDA_0_H5_1(); ', 320);}function KYK_BAFUDA_2_H5_1(){var i;_f_status_erase();i=_f_yamafuda[--_f_yamafuda_remain];_f_yamafuda[_f_yamafuda_remain]=0;_f[_f_oya].tefuda[0]=i;var k=(i >> 4) & 15;if(k>10) k=k % 10;_f[_f_oya].oichokabu_remain[k]--;_f_yamafuda_disp(-1);_f_oichokabu_animation_oyatefuda(0);_f_h5_next=setTimeout('WAIT_MOVIE("KYK_OYA_TEFUDA_2"); ', 10);}function KYK_OYA_TEFUDA_2(){var i, j;var b=new Array(40);AUDIO_OUTPUT('kirifuda'+(++_h5_sound_ctr & 3), false);_f_tefuda_disp(_f_oya);i=40; while(--i>=0) b[i]=0;i=-1; j=0; while(++i<40){if(_f_yamafuda[i]==0) continue;b[j++]=_f_yamafuda[i];}i=40; while(--i>=0) _f_yamafuda[i]=b[i];_f_yamafuda_remain=j;_f_yamafuda_disp();_f_h5_next=setTimeout('OCK_BETTINGS(); ', 320);}function OCK_BETTINGS(){_f_h5_next=setTimeout('OCK_BETTINGS_H5_1(); ', 320);}function OCK_BETTINGS_H5_1(){var i;_f_seki=_f_oya;_f_oichokabu_limit=_f_oichokabu_domae;_f_i=_f_players-1;i=4; while(--i>=0) _f_bafuda[20+i]=1;_f_h5_next=setTimeout('OCK_BETTINGS_1(); ', 10);}function OCK_BETTINGS_1(){var i;_f_j=0;if(++_f_seki>=_f_players) _f_seki=0;if(--_f_i<0){_f_h5_next=setTimeout('OCK_OYA_TEFUDA(); ', 10);return;}if(_f_seki==0){_f_l=_f_oichokabu_limit;if(_f_l==0) --_f_oichokabu_dqn;_f_h5_next=setTimeout('OCK_BETTINGS_PLAYER(); ', 10);return;}_f_think_oichokabu_bettings_prepare(_f_seki);_f_h5_next=setTimeout('OCK_BETTINGS_CPU(); ', 10);}function OCK_BETTINGS_CPU(){var i;if(_f_oichokabu_limit<=0){_f_h5_next=setTimeout('OCK_BETTINGS_1(); ', 10);return;}inputKey=_f_think_oichokabu_bettings(_f_seki, _f_j);if(inputKey>4){_f_h5_next=setTimeout('OCK_BETTINGS_1(); ', 10);return;}_f[_f_seki].betted[inputKey]++;_f_oichokabu_betted_total++;_f[_f_seki].balance_betted++;--_f_oichokabu_limit;--_f[_f_seki].score;_f_oichokabu_betted_flag[inputKey]++;++_f_j;_f_playfield();_f_bafuda_disp();AUDIO_OUTPUT('mekurifuda'+(++_h5_sound_ctr & 3), false);_f_h5_next=setTimeout('OCK_BETTINGS_CPU(); ', 160);}function OCK_BETTINGS_PLAYER(){var i;inputKey=-1;if(_f_oichokabu_limit<=0){_f_status_disp('胴前に達したので、張る事は出来ません。');_f_h5_next=setTimeout('OCK_BETTINGS_1(); ', 10);return;}else {if(_f_oichokabu_limit<2 && _f_l==_f_oichokabu_domae) _f_oichokabu_dqn++;_f_status_disp('張りたい札を選んでください。');if(_f_j) _f_mini_console_disp();_h5_makeBafudaClickable_K();}_f_h5_next=setTimeout('OCK_BETTINGS_PLAYER_1(); ', 10);}function OCK_BETTINGS_PLAYER_1(){var i;i=Math.random();if(inputKey>=0){if(inputKey>=5) inputKey=10;_f_h5_next=setTimeout('OCK_BETTINGS_PLAYER_2(); ', 10);return;}_f_h5_next=setTimeout('OCK_BETTINGS_PLAYER_1(); ', 10);}function OCK_BETTINGS_PLAYER_2(){var i;++_f_j;_f_status_erase();_f_console_erase();_f_bafuda_disp();_h5_makeBafudaUnclickable();if(inputKey>4){_f_h5_next=setTimeout('OCK_BETTINGS_1(); ', 10);return;}if(_f_gamemode==_F_GAMEMODE_KYOKABU){i=4; while(--i>=0){if(i!=inputKey-1) _f_bafuda[20+i]=0;}}_f[_f_seki].betted[inputKey-1]++;_f[_f_seki].balance_betted++;_f_oichokabu_betted_total++;--_f_oichokabu_limit;--_f[_f_seki].score;_f_oichokabu_betted_flag[inputKey-1]++;_f_playfield();_f_bafuda_disp();AUDIO_OUTPUT('mekurifuda'+(++_h5_sound_ctr & 3), false);i=160; if(_f_seki==0) i=10;_f_h5_next=setTimeout('OCK_BETTINGS_PLAYER(); ', i);}function OCK_OYA_TEFUDA(){var i;_f_oichokabu_limit=_f_oichokabu_domae;_f_i=0;i=_f_yamafuda_remain; do { _f_yamafuda[i]=0; } while(++i<40);if(_f_gamemode==_F_GAMEMODE_KYOKABU){_f_h5_next=setTimeout('OCK_2ND_BAFUDA(); ', 10);return;}if(_f_oya==0){_f_h5_next=setTimeout('OCK_OYA_TEFUDA_PLAYER(); ', 10);return;}_f_i=Math.floor(Math.random()*3);_f_h5_next=setTimeout('OCK_OYA_TEFUDA_0(); ', 10);}function OCK_OYA_TEFUDA_PLAYER(){var i;_f_status_disp('手札を"山札の一番上"か"三丁嫌い"(上から四枚目)か"なめ"(一番下)から選んでください。');_f_oichokabu_selectable_yamafuda_disp();inputKey=0;_f_h5_next=setTimeout('OCK_OYA_TEFUDA_PLAYER_1(); ', 10);}function OCK_OYA_TEFUDA_PLAYER_1(){var i;i=Math.random();if(inputKey<0){_f_i=inputKey;if(inputKey<-2) _f_i=0;_f_h5_next=setTimeout('OCK_OYA_TEFUDA_PLAYER_2(); ', 10);return;}_f_h5_next=setTimeout('OCK_OYA_TEFUDA_PLAYER_1(); ', 10);}function OCK_OYA_TEFUDA_0(){OCK_OYA_TEFUDA_PLAYER_2();}function OCK_OYA_TEFUDA_PLAYER_2(){var i;removeTextArea('FUDA-NO-1');removeTextArea('FUDA-NO-2');removeTextArea('FUDA-NO-10');_f_h5_oichokabu_selectable_yamafuda_erase();if(_f_i==0){i=_f_yamafuda[--_f_yamafuda_remain];_f_yamafuda[_f_yamafuda_remain]=0;_f[_f_oya].tefuda[0]=i;var k=(i >> 4) & 15;if(k>10) k=k % 10;_f[_f_oya].oichokabu_remain[k]--;_f_yamafuda_disp(-1);_f_oichokabu_animation_oyatefuda(0);}else if(_f_i==-1){b=new Array(40);i=40; while(--i>=0) b[i]=0;i=_f_yamafuda[_f_yamafuda_remain-4];_f[_f_oya].tefuda[0]=i;var k=(i >> 4) & 15;if(k>10) k=k % 10;_f[_f_oya].oichokabu_remain[k]--;_f_yamafuda[_f_yamafuda_remain-4]=0;b[39]=_f_yamafuda[_f_yamafuda_remain-1];b[38]=_f_yamafuda[_f_yamafuda_remain-2];b[37]=_f_yamafuda[_f_yamafuda_remain-3];i=-1; while(++i<_f_yamafuda_remain-4) b[i]=_f_yamafuda[i];i=40; while(--i>=0) _f_yamafuda[i]=b[i];_f_yamafuda_disp(-1);_f_oichokabu_animation_oyatefuda(-1);}else {b=new Array(40);i=40; while(--i>=0) b[i]=0;i=_f_yamafuda[0];_f[_f_oya].tefuda[0]=i;var k=(i >> 4) & 15;if(k>10) k=k % 10;_f[_f_oya].oichokabu_remain[k]--;_f_yamafuda[0]=0;i=0; while(++i<_f_yamafuda_remain) b[i]=_f_yamafuda[i];i=40; while(--i>=0) _f_yamafuda[i]=b[i];_f_yamafuda_disp(-1);_f_oichokabu_animation_oyatefuda(-1);}_f_h5_next=setTimeout('WAIT_MOVIE("OCK_OYA_TEFUDA_2"); ', 10);}function OCK_OYA_TEFUDA_2(){var i, j;var b=new Array(40);AUDIO_OUTPUT('kirifuda'+(++_h5_sound_ctr & 3), false);_f_tefuda_disp(_f_oya);i=40; while(--i>=0) b[i]=0;i=-1; j=0; while(++i<40){if(_f_yamafuda[i]==0) continue;b[j++]=_f_yamafuda[i];}i=40; while(--i>=0) _f_yamafuda[i]=b[i];_f_yamafuda_remain=j;_f_yamafuda_disp();_f_h5_next=setTimeout('OCK_2ND_BAFUDA(); ', 360);}function OCK_2ND_BAFUDA(){_f_i=-1;_f_h5_next=setTimeout('OCK_2ND_BAFUDA_1(); ', 10);}function OCK_2ND_BAFUDA_1(){var i, j, k;if(++_f_i>=4){_f_status_erase();_f_h5_next=setTimeout('OCK_3RD_BAFUDA(); ', 10);return;}i=_f_bafuda[4+_f_i]=_f_yamafuda[--_f_yamafuda_remain];_f_yamafuda_disp(-1);if(_f_oichokabu_betted_flag[_f_i]) i=-1;else {j=_f_players; while(--j>=0){var k=(i >> 4) & 15;if(k>10) k=k % 10;_f[_f_oya].oichokabu_remain[k]--;}_f_oichokabu_opened_flag[_f_i]=1;}_f_oichokabu_animation_bafuda1(_f_i+4, i);_f_h5_next=setTimeout('WAIT_MOVIE("OCK_2ND_BAFUDA_3"); ', 10);}function OCK_2ND_BAFUDA_3(){var i, j, k;AUDIO_OUTPUT('kirifuda'+(++_h5_sound_ctr & 3), false);_f_bafuda_disp(0);_f_h5_next=setTimeout('OCK_2ND_BAFUDA_1(); ', 160);}function OCK_3RD_BAFUDA(){_f_i=-1;_f_h5_next=setTimeout('OCK_3RD_BAFUDA_1(); ', 10);}function OCK_3RD_BAFUDA_1(){if(++_f_i>=4){_f_h5_next=setTimeout('OCK_3RD_BAFUDA_END(); ', 10);return;}if(_f_oichokabu_betted_flag[_f_i]){_f_h5_next=setTimeout('OCK_3RD_BAFUDA_2(); ', 10);return;}if(!_f_rule_sel['OCK_hiki']){_f_oichokabu_koi_flag=0;i=(_f_bafuda[_f_i] >> 4) & 15;j=(_f_bafuda[_f_i+4] >> 4) & 15;if(((i+j) % 10)<4){_f_oichokabu_koi_flag=1;_f_h5_next=setTimeout('OCK_3RD_BAFUDA_4(); ', 10);return;}}_f_h5_next=setTimeout('OCK_3RD_BAFUDA_1(); ', 10);}function OCK_3RD_BAFUDA_2(){_f_seki=_f_oya;_f_j=0;_f_oichokabu_koi_flag=0;_f_h5_next=setTimeout('OCK_3RD_BAFUDA_3(); ', 10);}function OCK_3RD_BAFUDA_3(){if(++_f_seki>=_f_players) _f_seki=0;if(_f_seki==_f_oya){_f_h5_next=setTimeout('OCK_3RD_BAFUDA_4(); ', 10);return;}if(_f[_f_seki].betted[_f_i]!=0){_f_h5_next=setTimeout('OCK_3RD_BAFUDA_3_2(); ', 10);return;}_f_h5_next=setTimeout('OCK_3RD_BAFUDA_3(); ', 10);}function OCK_3RD_BAFUDA_3_2(){_f_oichokabu_number_buff=(((_f_bafuda[4+_f_i] >> 4) & 15)+((_f_bafuda[_f_i] >> 4) & 15)) % 10;_f_k=_f_bafuda[4+_f_i];_f_bafuda[4+_f_i]=0;_f_bafuda_disp();var k=(_f_k >> 4) & 15;if(k>10) k=k % 10;_f[_f_seki].oichokabu_remain[k]--;_f_oichokabu_animation_take_bafuda(_f_i, _f_seki);_f_h5_next=setTimeout('WAIT_MOVIE("OCK_3RD_BAFUDA_3_2_3"); ', 10);}function OCK_3RD_BAFUDA_3_2_3(){AUDIO_OUTPUT('mekurifuda'+(++_h5_sound_ctr & 3), false);_f_oichokabu_animation_watch_bafuda(_f_seki, (_f_k ^ 0x100));_f_h5_next=setTimeout('OCK_3RD_BAFUDA_3_2_H5_1(); ', 240);}function OCK_3RD_BAFUDA_3_2_H5_1(){var i, j, k;i=(_f_bafuda[_f_i] >> 4) & 15;j=(_f_k >> 4) & 15;if(_f_rule_sel['OCK_kuppin']==1 && i==1){ i=j; j=1; }if(_f_seki==0){_f_h5_next=setTimeout('OCK_3RD_BAFUDA_3_PLAYER(); ', 10);return;}if(i==4 && j==1 && _f_rule_sel['OCK_shippin']==1) _f[_f_seki].oichokabu_koishimo[_f_i]=-1;else if(_f_oichokabu_number_buff<=3 && !_f_rule_sel['OCK_hiki']) _f[_f_seki].oichokabu_koishimo[_f_i]=1;else if(_f_oichokabu_number_buff>=7 && !_f_rule_sel['OCK_hiki']) _f[_f_seki].oichokabu_koishimo[_f_i]=-1;else _f[_f_seki].oichokabu_koishimo[_f_i]=_f_think_oichokabu_3rdCard(_f_seki, _f_i, _f_k);if(_f[_f_seki].oichokabu_koishimo[_f_i]<0){AUDIO_OUTPUT('shimo'+_f_seki, false);}else {_f[_f_seki].oichokabu_koishimo[_f_i]=1;AUDIO_OUTPUT('koi'+_f_seki, false);_f_oichokabu_koi_flag++;}_f_bafuda_disp();_f_h5_next=setTimeout('OCK_3RD_BAFUDA_3_3(); ', 320);}function OCK_3RD_BAFUDA_3_PLAYER(){var i, j, k;i=(_f_bafuda[_f_i] >> 4) & 15;j=(_f_k >> 4) & 15;if(_f_rule_sel['OCK_kuppin']==1 && i==1){ i=j; j=1; }k=_f_oichokabu_number[_f_oichokabu_number_buff];if(_f_gamemode==_F_GAMEMODE_KYOKABU) k=_f_kyokabu_number[_f_oichokabu_number_buff];if(i==4 && j==1 && _f_rule_sel['OCK_shippin']==1 && _f_gamemode==_F_GAMEMODE_OICHOKABU){_f_status_disp('四一のため、三枚目は引きません。');_f_mini_console_disp();_f[_f_seki].oichokabu_koishimo[_f_i]=-1;_f_l=12;}if(_f_oichokabu_number_buff<=3 && !_f_rule_sel['OCK_hiki']){_f_status_disp(k+'のため、三枚目を引きます。');_f_mini_console_disp();_f[_f_seki].oichokabu_koishimo[_f_i]=1;_f_l=11;}else if(_f_oichokabu_number_buff>=7 && !_f_rule_sel['OCK_hiki']){_f_status_disp(k+'のため、三枚目は引けません。');_f_mini_console_disp();_f[_f_seki].oichokabu_koishimo[_f_i]=-1;_f_l=12;}else {_f_status_disp(k+'です。\n三枚目を引きますか？');_f_console_disp();_f_l=0;}inputKey=0;_f_h5_next=setTimeout('OCK_3RD_BAFUDA_3_PLAYER_1(); ', 10);}function OCK_3RD_BAFUDA_3_PLAYER_1(){var i, j, k;i=Math.random();if(inputKey>0){if(_f_l>0) inputKey=_f_l;_f_h5_next=setTimeout('OCK_3RD_BAFUDA_3_PLAYER_2(); ', 10);return;}_f_h5_next=setTimeout('OCK_3RD_BAFUDA_3_PLAYER_1(); ', 10);}function OCK_3RD_BAFUDA_3_PLAYER_2(){var i, j, k;_f_status_erase();_f_console_erase();if(inputKey==11){_f[_f_seki].oichokabu_koishimo[_f_i]=1;AUDIO_OUTPUT('koi'+_f_seki, false);_f_oichokabu_koi_flag++;}else {_f[_f_seki].oichokabu_koishimo[_f_i]=-1;AUDIO_OUTPUT('shimo'+_f_seki, false);}_f_h5_next=setTimeout('OCK_3RD_BAFUDA_3_3(); ', 240);}function OCK_3RD_BAFUDA_3_3(){var i, j, k;_f_oichokabu_animation_erase_watched();_f_bafuda[4+_f_i]=_f_k;_f_oichokabu_animation_return_bafuda(_f_i, _f_seki);_f_h5_next=setTimeout('WAIT_MOVIE("OCK_3RD_BAFUDA_3_3_3"); ', 10);}function OCK_3RD_BAFUDA_3_3_3(){var i, j, k;AUDIO_OUTPUT('mekurifuda'+(++_h5_sound_ctr & 3), false);_f_bafuda_disp();_f_h5_next=setTimeout('OCK_3RD_BAFUDA_3(); ', 120);}function OCK_3RD_BAFUDA_4(){var i, j, k;if(_f_oichokabu_koi_flag==0){_f_h5_next=setTimeout('OCK_3RD_BAFUDA_1(); ', 10);return;}i=_f_bafuda[8+_f_i]=_f_yamafuda[--_f_yamafuda_remain];_f_yamafuda_disp(-1);_f_oichokabu_animation_bafuda1(_f_i+8, i);j=_f_players; while(--j>=0){var k=(i >> 4) & 15;if(k>10) k=k % 10;_f[j].oichokabu_remain[k]--;}_f_h5_next=setTimeout('WAIT_MOVIE("OCK_3RD_BAFUDA_4_3"); ', 10);}function OCK_3RD_BAFUDA_4_3(){AUDIO_OUTPUT('kirifuda'+(++_h5_sound_ctr & 3), false);_f_bafuda_disp(0);_f_h5_next=setTimeout('OCK_3RD_BAFUDA_1(); ', 120);}function OCK_3RD_BAFUDA_END(){_f_h5_next=setTimeout('OCK_2ND_OYA_TEFUDA_H5(); ', 480);}function OCK_2ND_OYA_TEFUDA_H5(){if(_f_oya==0){_f_oichokabu_oyaOpen=1;AUDIO_OUTPUT('mekurifuda'+(++_h5_sound_ctr & 3), false);_f_tefuda_disp(0);}else {_f_h5_next=setTimeout('OCK_2ND_OYA_TEFUDA(); ', 10);return;}_f_h5_next=setTimeout('OCK_2ND_OYA_TEFUDA(); ', 160);}function OCK_2ND_OYA_TEFUDA(){var i=_f_yamafuda[--_f_yamafuda_remain];_f[_f_oya].tefuda[1]=i;_f_yamafuda_disp(-1);_f_oichokabu_animation_oyatefuda(1);var k=(i >> 4) & 15;if(k>10) k=k % 10;_f[_f_oya].oichokabu_remain[k]--;_f_h5_next=setTimeout('WAIT_MOVIE("OCK_2ND_OYA_TEFUDA_2"); ', 10);}function OCK_2ND_OYA_TEFUDA_2(){AUDIO_OUTPUT('kirifuda'+(++_h5_sound_ctr & 3), false);_f_tefuda_disp(_f_oya);_f_h5_next=setTimeout('OCK_2ND_OYA_TEFUDA_2_H5_1(); ', 160);}function OCK_2ND_OYA_TEFUDA_2_H5_1(){var i, j, k;i=(_f[_f_oya].tefuda[0] >> 4) & 15;j=(_f[_f_oya].tefuda[1] >> 4) & 15;_f_oichokabu_number_buff=(i+j) % 10;if(_f_rule_sel['OCK_kuppin']==1 && i==1){ i=j; j=1; }if(_f_oya==0){_f_h5_next=setTimeout('OCK_3RD_OYA_TEFUDA_PLAYER(); ', 10);return;}if(i==9 && j==1) _f[_f_seki].oichokabu_koishimo[0]=-1;else if(i==4  && j==1 && !_f_rule_sel['OCK_shippin']) _f[_f_seki].oichokabu_koishimo[0]=-1;else if(_f_oichokabu_number_buff<=3 && !_f_rule_sel['OCK_hiki']) _f[_f_seki].oichokabu_koishimo[0]=1;else if(_f_oichokabu_number_buff>=7 && !_f_rule_sel['OCK_hiki']) _f[_f_seki].oichokabu_koishimo[0]=-1;else _f[_f_seki].oichokabu_koishimo[0]=_f_think_oichokabu_3rdCard_forOya(_f_seki);if(_f[_f_seki].oichokabu_koishimo[0]<0){AUDIO_OUTPUT('shimo'+_f_seki, false);}else {AUDIO_OUTPUT('koi'+_f_seki, false);}_f_h5_next=setTimeout('OCK_3RD_OYA_TEFUDA_2(); ', 190);}function OCK_3RD_OYA_TEFUDA_PLAYER(){var i, j, k;k=_f_oichokabu_number[_f_oichokabu_number_buff];if(_f_gamemode==_F_GAMEMODE_KYOKABU) k=_f_kyokabu_number[_f_oichokabu_number_buff];if(i==9 && j==1){_f_status_disp('九一のため、三枚目は引きません。');_f_mini_console_disp();_f[_f_seki].oichokabu_koishimo[0]=-1;_f_l=12;}else if(i==4 && j==1 && !_f_rule_sel['OCK_shippin'] && _f_gamemode==_F_GAMEMODE_OICHOKABU){_f_status_disp('四一のため、三枚目は引きません。');_f_mini_console_disp();_f[_f_seki].oichokabu_koishimo[0]=-1;_f_l=12;}else if(_f_oichokabu_number_buff<=3 && !_f_rule_sel['OCK_hiki']){_f_status_disp(k+'のため、三枚目を引きます。');_f_mini_console_disp();_f[_f_seki].oichokabu_koishimo[0]=1;_f_l=11;}else if(_f_oichokabu_number_buff>=7 && !_f_rule_sel['OCK_hiki']){_f_status_disp(k+'のため、三枚目は引けません。');_f_mini_console_disp();_f[_f_seki].oichokabu_koishimo[0]=-1;_f_l=12;}else {_f_status_disp(k+'です。\n三枚目を引きますか？');_f_console_disp();_f_l=0;}inputKey=0;_f_h5_next=setTimeout('OCK_3RD_OYA_TEFUDA_PLAYER_1(); ', 190);}function OCK_3RD_OYA_TEFUDA_PLAYER_1(){var i, j, k;i=Math.random();if(inputKey>0){if(_f_l>0) inputKey=_f_l;_f_h5_next=setTimeout('OCK_3RD_OYA_TEFUDA_PLAYER_2(); ', 10);return;}_f_h5_next=setTimeout('OCK_3RD_OYA_TEFUDA_PLAYER_1(); ', 10);}function OCK_3RD_OYA_TEFUDA_PLAYER_2(){var i, j, k;_f_status_erase();_f_console_erase();if(inputKey==11){_f[_f_seki].oichokabu_koishimo[0]=1;AUDIO_OUTPUT('koi'+_f_seki, false);_f_oichokabu_koi_flag++;}else {_f[_f_seki].oichokabu_koishimo[0]=-1;AUDIO_OUTPUT('shimo'+_f_seki, false);}_f_h5_next=setTimeout('OCK_3RD_OYA_TEFUDA_2(); ', 120);}function OCK_3RD_OYA_TEFUDA_2(){var i, j, k;if(_f[_f_seki].oichokabu_koishimo[0]<0){i=400; if(noAudio || silentMode) i=100;_f_h5_next=setTimeout('OCK_FINISH(); ', i);return;}i=_f_yamafuda[--_f_yamafuda_remain];_f[_f_oya].tefuda[2]=i;_f_yamafuda_disp(-1);_f_oichokabu_animation_oyatefuda(2);var k=(i >> 4) & 15;if(k>10) k=k % 10;_f[_f_oya].oichokabu_remain[k]--;_f_h5_next=setTimeout('WAIT_MOVIE("OCK_3RD_OYA_TEFUDA_4"); ', 10);}function OCK_3RD_OYA_TEFUDA_4(){var i, j, k;AUDIO_OUTPUT('kirifuda'+(++_h5_sound_ctr & 3), false);_f_tefuda_disp(_f_oya);i=480; if(noAudio || silentMode) i=100;_f_h5_next=setTimeout('OCK_FINISH(); ', i);}function OCK_FINISH(){var i, j, k;if(_f_oichokabu_oyaOpen==0){_f_oichokabu_oyaOpen=1;AUDIO_OUTPUT('mekurifuda'+(++_h5_sound_ctr & 3), false);_f_tefuda_disp(_f_oya);}else {_f_h5_next=setTimeout('OCK_FINISH_2(); ', 180);return;}_f_h5_next=setTimeout('OCK_FINISH_2(); ', 10);}function OCK_FINISH_2(){var i, j, k, str;i=(_f[_f_oya].tefuda[0] >> 4) & 15;if(i>10) i=1;j=(_f[_f_oya].tefuda[1] >> 4) & 15;if(j>10) j=1;k=(_f[_f_oya].tefuda[2] >> 4) & 15;if(k>10) k=1;_f_i=_f[_f_oya].oichokabu_total[0]=(i+j+k) % 10;if(_f_rule_sel['OCK_kuppin']==1 && i==1){ i=j; j=1; }if(k==0 && i==4 && j==1 && !_f_rule_sel['OCK_shippin'] && _f_gamemode==_F_GAMEMODE_OICHOKABU){AUDIO_OUTPUT('shippin'+_f_oya, false);_f_oichokabu_oyaYaku='四一';_f[_f_oya].oichokabu_total[0]=41;_f_tefuda_disp(_f_oya);}else if(k==0 && i==9 && j==1){AUDIO_OUTPUT('kuppin'+_f_oya, false);_f_oichokabu_oyaYaku='九一';_f[_f_oya].oichokabu_total[0]=91;_f_tefuda_disp(_f_oya);}else if(i==j && j==k && k!=0){if(_f_gamemode==_F_GAMEMODE_OICHOKABU){AUDIO_OUTPUT('arashi'+_f_oya, false);_f_oichokabu_oyaYaku='アラシ';_f[_f_oya].oichokabu_total[0]+=300;_f_tefuda_disp(_f_oya);}else if(_f_gamemode==_F_GAMEMODE_KYOKABU){AUDIO_OUTPUT('solokabu'+_f_oya, false);_f_oichokabu_oyaYaku='ソロカブ';_f[_f_oya].oichokabu_total[0]=9;_f_tefuda_disp(_f_oya);}}else {str='O'+_f_i+'_'+_f_oya;if(_f_gamemode==_F_GAMEMODE_OICHOKABU){_f_oichokabu_oyaYaku=_f_oichokabu_number[_f_i];_f_tefuda_disp(_f_oya);}else if(_f_gamemode==_F_GAMEMODE_KYOKABU){if(audio['K'+_f_i+'_'+_f_oya]) str='K'+_f_i+'_'+_f_oya;_f_oichokabu_oyaYaku=_f_kyokabu_number[_f_i];_f_tefuda_disp(_f_oya);}AUDIO_OUTPUT(str, false);if(_f_rule_sel['OCK_oyabuta'] && _f_i==0){i=_f_players; while(--i>=0){j=4; while(--j>=0) _f[i].betted[j]=_f[i].oichokabu_balance[j]=0;_f[i].balance_betted=0;_f[i].score=_f[i].score_before_game;}_f_status_disp('無勝負です。');_f_oichokabu_betted_total=0;_f_oichokabu_oyaTotalPoint=0;_f_h5_next=setTimeout('OCK_FINISH_END_NOCONTEST(); ', 10);return;}}_f_i=-1;_f_h5_next=setTimeout('OCK_FINISH_3(); ', 1000);}function OCK_FINISH_3(){if(++_f_i>=4){_f_h5_next=setTimeout('OCK_FINISH_END(); ', 10);return;}var i=_f_players; while(--i>-1){if(i==_f_oya) continue;if(_f[i].betted[_f_i]) break;}if(i<0){_f_h5_next=setTimeout('OCK_FINISH_3(); ', 480);return;}_f_seki=_f_oya;if(_f_oichokabu_opened_flag[_f_i]==0){_f_oichokabu_opened_flag[_f_i]=1;AUDIO_OUTPUT('mekurifuda'+(++_h5_sound_ctr & 3), false);_f_bafuda_disp();}_f_h5_next=setTimeout('OCK_FINISH_4(); ', 480);}function OCK_FINISH_4(){var i, j, k;if(++_f_seki>=_f_players) _f_seki=0;if(_f_seki==_f_oya){_f_h5_next=setTimeout('OCK_FINISH_3(); ', 10);return;}if(!_f[_f_seki].betted[_f_i]){_f_h5_next=setTimeout('OCK_FINISH_4(); ', 10);return;}i=(_f_bafuda[_f_i] >> 4) & 15;if(i>10) i=1;j=(_f_bafuda[_f_i+4] >> 4) & 15;if(j>10) j=1;k=(_f_bafuda[_f_i+8] >> 4) & 15;if(k>10) k=1;l=i+j;if(_f[_f_seki].oichokabu_koishimo[_f_i]>0) l+=k; else k=0;l=l % 10;if(_f_rule_sel['OCK_kuppin']==1 && i==1){ i=j; j=1; }if(i==4 && j==1 && k==0 && _f_rule_sel['OCK_shippin']==1 && _f_gamemode==_F_GAMEMODE_OICHOKABU){_f[_f_seki].oichokabu_total4disp[_f_i]='四一';_f[_f_seki].oichokabu_total[_f_i]=41;AUDIO_OUTPUT('shippin'+_f_seki, false);if(_f[_f_seki].oichokabu_total[_f_i]>_f[_f_oya].oichokabu_total[0])_f[_f_seki].oichokabu_balance[_f_i]=_f[_f_seki].betted[_f_i]*2;else _f[_f_seki].oichokabu_balance[_f_i]=0;}else if(i==j && j==k && i!=0 && _f_gamemode==_F_GAMEMODE_OICHOKABU){_f[_f_seki].oichokabu_total4disp[_f_i]='アラシ';_f[_f_seki].oichokabu_total[_f_i]=l+300;AUDIO_OUTPUT('arashi'+_f_seki, false);if(_f[_f_seki].oichokabu_total[_f_i]>_f[_f_oya].oichokabu_total[0])_f[_f_seki].oichokabu_balance[_f_i]=_f[_f_seki].betted[_f_i]*3;else _f[_f_seki].oichokabu_balance[_f_i]=-_f[_f_seki].betted[_f_i]*2;}else if(_f[_f_oya].oichokabu_total[0]>300){_f[_f_seki].oichokabu_balance[_f_i]=-_f[_f_seki].betted[_f_i]*2;_f_bafuda_disp();_f_h5_next=setTimeout('OCK_FINISH_4(); ', 480);return;}else if(_f[_f_oya].oichokabu_total[0]>10){_f[_f_seki].oichokabu_balance[_f_i]=0;_f_bafuda_disp();_f_h5_next=setTimeout('OCK_FINISH_4(); ', 480);return;}else {if(i==j && j==k && i!=0 && _f_gamemode==_F_GAMEMODE_KYOKABU){_f[_f_seki].oichokabu_total4disp[_f_i]='ソロカブ';_f[_f_seki].oichokabu_total[_f_i]=9;AUDIO_OUTPUT('solokabu'+_f_seki, false);}else {var str='O'+l+'_'+_f_seki;if(_f_gamemode==_F_GAMEMODE_OICHOKABU){_f[_f_seki].oichokabu_total4disp[_f_i]=_f_oichokabu_number[l];_f[_f_seki].oichokabu_total[_f_i]=l;}else if(_f_gamemode==_F_GAMEMODE_KYOKABU){_f[_f_seki].oichokabu_total4disp[_f_i]=_f_kyokabu_number[l];_f[_f_seki].oichokabu_total[_f_i]=l;if(audio['K'+l+'_'+_f_seki]) str='K'+l+'_'+_f_seki;}AUDIO_OUTPUT(str, false);}if(_f[_f_seki].oichokabu_total[_f_i]>_f[_f_oya].oichokabu_total[0])_f[_f_seki].oichokabu_balance[_f_i]=_f[_f_seki].betted[_f_i]*2;else if(_f[_f_seki].oichokabu_total[_f_i]==_f[_f_oya].oichokabu_total[0]){if(!_f_rule_sel['OCK_doten']) _f[_f_seki].oichokabu_balance[_f_i]=0;else _f[_f_seki].oichokabu_balance[_f_i]=_f[_f_seki].betted[_f_i];}else _f[_f_seki].oichokabu_balance[_f_i]=0;}_f_bafuda_disp();_f_h5_next=setTimeout('OCK_FINISH_4(); ', 480);}function OCK_FINISH_END(){_f_status_disp('一局終了です。');_f_h5_next=setTimeout('OCK_FINISH_END_NOCONTEST(); ', 10);}function OCK_FINISH_END_NOCONTEST(){inputKey=-1;i=-1; k=_f_oichokabu_betted_total; while(++i<_f_players){_f[i].balance=0;if(i==_f_oya) continue;j=4; while(--j>=0) _f[i].balance+=_f[i].oichokabu_balance[j];k-=_f[i].balance;_f[i].score=_f[i].score_after_balance=_f[i].score+_f[i].balance;}_f_oichokabu_oyaTotalPoint+=k;_f[_f_oya].balance=k;_f[_f_oya].score=_f[_f_oya].score_after_balance=_f[_f_oya].score+k;i=_f_players;while(--i>=0){_f[i].result[_f_game_ctr]=_f[i].result_after_balance=_f[i].current_result=_f[i].score_after_balance-50;var s=0; j=_f_game_ctr+1;while(--j>=0) s+=_f[i].result[j];_f[i].total_result=s;}j='Jingle_Drawn';if(_f[0].score>_f[0].score_before_game) j='Jingle_PlayerWin';if(_f[0].score<_f[0].score_before_game) j='Jingle_CPUWin2';AUDIO_OUTPUT(j, false);_f_mini_console_disp();_f_h5_next=setTimeout('WAIT_MINICONSOLE("OCK_FINISH_END_2"); ', 10);}function OCK_FINISH_END_2(){inputKey=-1;_f_status_erase();_f_console_erase();_f_balance_disp(0);if(_f_kyokusu_ctr+1<_f_max_kyokusu){if(_f_oichokabu_oyaTotalPoint<=-_f_oichokabu_domae || _f_oichokabu_oyaTotalPoint>=_f_oichokabu_domae*2){if(++_f_oya>=_f_players) _f_oya=0;_f_oichokabu_oyaTotalPoint=0;_f_status_disp('次局は巣立ちで親が代ります。');}}_f_mini_console_disp();inputKey=-1;_f_h5_next=setTimeout('WAIT_MINICONSOLE("OCK_FINISH_END_4"); ', 10);}function OCK_FINISH_END_4(){if(++_f_kyokusu_ctr<_f_max_kyokusu){_f_h5_next=setTimeout('IKKYOKU(); ', 10);return;}_f_h5_next=setTimeout('GAME_END(); ', 10);}function ATRACT(){var e;putPartOfImage(image[1], 0, 0, 1199, 899, 0, 0, 1200, 900);putPartOfImage(image[0], 3550, 1800, 200, 40, 940, 20, 240, 48);_f_toggle_sprite_disp(0);newTextArea('TITLE1', 198, 82, 800, 128, 128, 'transparent', '#000');e=document.getElementById('TITLE1');e.style.fontStyle='italic';e.style.fontWeight='bold';e.style.fontFamily='serif';e.style.textAlign='center';e.style.lineHeight='1em';e.style.verticalAlign='text-top';e.innerHTML='しらぎく花札';newTextArea('TITLE2', 200, 84, 800, 128, 128, 'transparent', '#909');e=document.getElementById('TITLE2');e.style.fontStyle='italic';e.style.fontWeight='bold';e.style.fontFamily='serif';e.style.textAlign='center';e.style.lineHeight='1em';e.style.verticalAlign='text-top';e.innerHTML='しらぎく花札';newTextArea('TITLE3', 202, 86, 800, 128, 128, 'transparent', '#909');e=document.getElementById('TITLE3');e.style.fontStyle='italic';e.style.fontWeight='bold';e.style.fontFamily='serif';e.style.textAlign='center';e.style.lineHeight='1em';e.style.verticalAlign='text-top';e.innerHTML='しらぎく花札';newTextArea('CREDIT_TXT', 0, 860, 624, 32, 24, '#fef', '#909');e=document.getElementById('CREDIT_TXT');e.style.fontWeight='bold';e.style.fontFamily='serif';e.style.textAlign='left';e.style.lineHeight='1em';e.style.verticalAlign='text-top';e.innerHTML='Copyright &copy; '+_f_copyright_year+' さいたま・しらぎくさいと';newTextArea('TX1', 0, 640, 1200, 40, 40, 'transparent', '#000');e=document.getElementById('TX1');e.style.fontWeight='bold';e.style.fontFamily='serif';e.style.textAlign='center';e.style.lineHeight='1em';e.style.verticalAlign='text-top';e.innerHTML='画面をクリック/タップして下さい。';newTextArea('TX2', -1, 639, 1202, 40, 40, 'transparent', '#909');e=document.getElementById('TX2');e.style.fontWeight='bold';e.style.fontFamily='serif';e.style.textAlign='center';e.style.lineHeight='1em';e.style.verticalAlign='text-top';e.innerHTML='画面をクリック/タップして下さい。';newTextArea('TX3', -2, 638, 1204, 40, 40, 'transparent', '#909');e=document.getElementById('TX3');e.style.fontWeight='bold';e.style.fontFamily='serif';e.style.textAlign='center';e.style.lineHeight='1em';e.style.verticalAlign='text-top';e.innerHTML='画面をクリック/タップして下さい。';newAnchorArea(1, 0, 0, 1200, 800, 'ATRACT_START', 12, 'transparent', '#fff');_f_i=0; inputKey=0;_f_h5_next=setTimeout('ATRACT2(); ', 10);}function ATRACT2(){var i, e;i=Math.random();if(++_f_i>96){_f_i=0;e=document.getElementById('TX1');e.style.display='block';e=document.getElementById('TX2');e.style.display='block';e=document.getElementById('TX3');e.style.display='block';}else if(_f_i==64){e=document.getElementById('TX1');e.style.display='none';e=document.getElementById('TX2');e.style.display='none';e=document.getElementById('TX3');e.style.display='none';}if(inputKey==1){H5_SOUND_SET();_f_h5_next=setTimeout('MENU(); ', 10);return;}_f_h5_next=setTimeout('ATRACT2(); ', 10);}function H5_SOUND_SET(){var i, j;if(noAudio) return;j=4; while(--j>-1){i='kirifuda'+j;audioObj[i].volume=0;audioObj[i].play();i='mekurifuda'+j;audioObj[i].volume=0;audioObj[i].play();}}
