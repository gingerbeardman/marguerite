_t_x=0;_t_y=0;_t_z=0;_t_a=0;_t_shupai_buffer_4_animation=new Array(16);function _t_get_shupai_coords(jia, pos){var i, k, imgRate=1;_t_x=_t_y=0;if(jia==0){imgRate=1.2;_t_y=814-_t_disp_YOffset;if(_t_gamemode==_T_GAMEMODE_TAIWAN){_t_x=1006;if(_t_fulou_dir) _t_x=974-144*_t[0].fulou_ctr;k=17; while(--k>=3*_t[0].fulou_ctr){i=_tm_suff[k];if(i==pos) return;_t_x-=40*imgRate;}return;}if(_t_fulou_dir){_t_x=830-144*_t[0].fulou_ctr-40*imgRate*(14-pos);if(_t_gamemode!=_T_GAMEMODE_GUOJI){i=_t[0].fulou_ctr; k=-5; while(--i>-1){k+=5;if(_t[0].fuloupai[k+4]) _t_x+=160*imgRate;}}}else _t_x=1006-40*imgRate*(14-pos);if(_t[0].fu[0]>-1 && _t[0].open) _t_y=784;return;}if((_t_players==4 && jia==2) || (_t_players==2 && jia==1)){if(_t_gamemode==_T_GAMEMODE_TAIWAN){_t_x=224; _t_y=0;if(_t_fulou_dir) _t_x=296+120*_t[2].fulou_ctr;k=17; while(--k>=3*_t[2].fulou_ctr){i=_tm_suff[k];if(i==pos) return;_t_x+=40*imgRate;}return;}_t_x=224+40*(14-pos);if(_t_fulou_dir){_t_x=416+120*_t[jia].fulou_ctr+40*(14-pos);i=_t[jia].fulou_ctr; k=-5; while(--i>-1){k+=5;if(_t[jia].fuloupai[k+4]) _t_x-=160;}}_t_y=0;return;}if(jia==1){_t_x=1144-48;if(_t_gamemode==_T_GAMEMODE_TAIWAN){_t_y=98; k=17;if(_t_fulou_dir) _t_y=130+96*_t[1].fulou_ctr;while(--k>=3*_t[1].fulou_ctr){i=_tm_suff[k];if(i==pos) return;_t_y+=32;}return;}_t_y=122-_t_disp_YOffset+32*(14-pos);if(_t_fulou_dir){_t_y=200+96*_t[1].fulou_ctr+32*(14-pos);}return;}_t_x=8+48;if(_t_gamemode==_T_GAMEMODE_TAIWAN){_t_y=150+96*_t[3].fulou_ctr-_t_disp_YOffset; k=3*_t[3].fulou_ctr-1;if(_t_fulou_dir) _t_y=130;while(++k<17){i=_tm_suff[k];if(i==pos) return;_t_y+=32;}return;}_t_y=250;if(_t_fulou_dir) _t_y=146-96*_t[jia].fulou_ctr;if(_t_players==3){_t_y-=80;}_t_y+=32*pos;return;}function _t_get_dapai_coords(jia){var i, j, l, lm=6;var fsp=new Array(), fspc=0;i=-1; while(++i<_t[jia].fusipai_ctr){if(!((l=_t[jia].fusipai2[i]) & 0x7f)) break;if(l<0) continue;if(l & 0x200) continue;fsp[fspc++]=l;}fsp[fspc]=0;_t_h5_paiX=_t_h5_paiY=0;if(_t_gamemode==_T_GAMEMODE_TAIWAN){if(jia==0){_t_h5_paiX=800;_t_h5_paiY=600;_t_h5_arrowX=_t_h5_paiX-56;_t_h5_arrowY=_t_h5_paiY;_t_h5_arrowD=2;return;}if(jia==2){_t_h5_paiX=330;_t_h5_arrowX=_t_h5_paiX+44;_t_h5_paiY=180;_t_h5_arrowY=_t_h5_paiY+2;_t_h5_arrowD=0;return;}if(jia==1){_t_h5_paiX=860;_t_h5_paiY=280;_t_h5_arrowX=_t_h5_paiX-4;_t_h5_arrowY=_t_h5_paiY-50;_t_h5_arrowD=1;return;}_t_h5_paiX=312;_t_h5_paiY=572;_t_h5_arrowX=_t_h5_paiX+4;_t_h5_arrowY=_t_h5_paiY-52;_t_h5_arrowD=1;return;}if(jia==0){_t_h5_paiX=480; _t_h5_paiY=535;if(fspc>lm*2){_t_h5_paiX+=40*(fspc-lm*2-1);_t_h5_paiY+=80;i=fspc-lm*2-1;}else {_t_h5_paiX+=40*((fspc-1) % lm);_t_h5_paiY+=40*Math.floor((fspc-1) / lm);i=fspc-(fspc % lm)-1;}while(++i<fspc){if(fsp[i] & 0x100) _t_h5_paiX+=8;}_t_h5_arrowX=_t_h5_paiX+41;_t_h5_arrowY=_t_h5_paiY;_t_h5_arrowD=0;return;}if(_t_players==4 && jia==2 || _t_players==2){if(fspc>lm*2){_t_h5_paiX=680-40*(fspc-lm*2-1);_t_h5_paiY=180;i=fspc-lm*2-1;}else {_t_h5_paiX=680-40*((fspc-1) % lm);_t_h5_paiY=260-40*Math.floor((fspc-1) / lm);i=fspc-(fspc % lm)-1;}while(++i<fspc){if(fsp[i] & 0x100) _t_h5_paiX-=8;}if(_t_players==3) _t_h5_paiY-=20;_t_h5_arrowX=_t_h5_paiX-48;_t_h5_arrowY=_t_h5_paiY-4;_t_h5_arrowD=2;return;}if(jia==1){if(fspc>lm*2){_t_h5_paiX=750+96;_t_h5_paiY=510-32-32*(fspc-lm*2-1);i=fspc-lm*2-1;}else {_t_h5_paiX=750+48*Math.floor((fspc-1) / lm);_t_h5_paiY=510-32-32*((fspc-1) % lm);i=fspc-(fspc % lm)-1;}while(++i<fspc){if(fsp[i] & 0x100) _t_h5_paiY-=8;}if(_t_players==3) _t_h5_paiY-=20;else if(_t_gamemode==_T_GAMEMODE_GUOJI) _t_h5_paiY+=32;_t_h5_arrowX=_t_h5_paiX+4;_t_h5_arrowY=_t_h5_paiY-50;_t_h5_arrowD=1;return;}if(fspc>lm*2){_t_h5_paiX=402-96;_t_h5_paiY=325+32*(fspc-lm*2-1);i=fspc-lm*2-1;}else {_t_h5_paiX=402-48*Math.floor((fspc-1) / lm);_t_h5_paiY=325+32*((fspc-1) % lm);i=fspc-(fspc % lm)-1;}if(_t_players==3){_t_h5_paiY-=84;if(_t_gamemode==_T_GAMEMODE_PENGLI){_t_h5_paiY-=32;}}else if(_t_gamemode==_T_GAMEMODE_GUOJI) _t_h5_paiY-=32;while(++i<fspc){if(fsp[i] & 0x100) _t_h5_paiY+=8;}_t_h5_arrowX=_t_h5_paiX-4;_t_h5_arrowY=_t_h5_paiY+40;_t_h5_arrowD=3;return;}function _t_get_bipai_coords(jia, pos){var p=pos & 0xfffe;_t_a=jia;if(jia==0){_t_x=340; _t_y=680-_t_disp_YOffset; l=15;if(_t_gamemode==_T_GAMEMODE_TAIWAN){_t_x+=160;if(_t_fulou_dir) _t_x-=280;}if(_t_lang!='ja') _t_x-=80;if(_t_rule.hana){ _t_x-=40; l++; }if(_t_players==3){_t_x-=40; l++;if(_t_fulou_dir) _t_x-=40;}if(_t_gamemode==_T_GAMEMODE_GUOJI){_t_x=340; l++;if(_t_fulou_dir) _t_x-=40;}_t_x+=(pos >> 1)*40;return;}if((jia==2 && _t_players==4) || (jia==1 && _t_players==2)){_t_x=820; _t_y=100-_t_disp_YOffset;if(_t_gamemode==_T_GAMEMODE_GUOJI){_t_x-=120;if(_t_fulou_dir){_t_x+=200;}}else if(_t_gamemode==_T_GAMEMODE_TAIWAN){_t_x-=140;if(_t_fulou_dir){_t_x+=180;}}_t_x-=(pos >> 1)*40;return;}if(jia==1){_t_x=922-_t_h5_bipai2cpuOffset;_t_y=594-_t_disp_YOffset+24;if(_t_players==3) _t_y-=64;if(_t_gamemode==_T_GAMEMODE_GUOJI){_t_y+=16;if(!_t_fulou_dir){_t_y+=40;}}i=-2; while((i+=2)<32){if(!_t_bipai4disp[1][i+2] && _t_bipai4disp[1][i+3] && _t_bipai4disp[1][i] && _t_bipai4disp[1][i+1]<0) ;else if(_t_bipai4disp[1][i+1]>0 && i>=2 && _t_bipai4disp[1][i-2]<0) _t_y-=16;_t_y-=33;}i=32; while((i-=2)>-1){if((pos & 0xfffe)==i) return;if(!_t_bipai4disp[1][i] && !_t_bipai4disp[1][i+1]){_t_y+=33; continue;}if(!_t_bipai4disp[1][i+2] && _t_bipai4disp[1][i+3] && _t_bipai4disp[1][i] && _t_bipai4disp[1][i+1]<0) ;else if(_t_bipai4disp[1][i+3]>0 && _t_bipai4disp[1][i]<0) _t_y+=16;_t_y+=33;}return;}_t_x=230; _t_y=170-_t_disp_YOffset; i=-2;if(_t_players==3) _t_y-=96;if(_t_gamemode==_T_GAMEMODE_GUOJI && _t_fulou_dir){_t_y+=48;}else if(_t_gamemode==_T_GAMEMODE_TAIWAN){_t_y+=40;if(_t_fulou_dir) _t_y+=40;}_t_y+=(pos >> 1)*33;return;}function _t_get_nukidora_coords(jia){var x, y, dx=40;if(jia==0){x=165; y=752;if(_t_fulou_dir){x=1030; dx=-40;if(_t_gamemode==_T_GAMEMODE_TAIWAN) x=1070;}_t_h5_paiX=_t_h5_arrowX=x+_t[0].nukidora_ctr*dx;_t_h5_paiY=y;_t_h5_arrowY=y-52;_t_h5_arrowD=1;return;}if((jia==2 && _t_players==4) || _t_players==2){x=950; y=90; dx=-40;if(_t_fulou_dir){x=160; dx=40;}if(_t_fulou_dir && _t[jia].nukidora_ctr>5){y+=40;x-=_t[jia].nukidora_ctr*dx*6;}_t_h5_paiX=_t_h5_arrowX=x+dx*_t[jia].nukidora_ctr;_t_h5_paiY=y;_t_h5_arrowY=y-52;_t_h5_arrowD=1;return;}if(jia==1){x=998;if(!_t_fulou_dir){y=730-32*_t[1].nukidora_ctr;if(_t_gamemode==_T_GAMEMODE_TAIWAN) y+=16;_t_h5_paiX=x;_t_h5_arrowX=x-48;_t_h5_paiY=y;_t_h5_arrowY=y-8;_t_h5_arrowD=2;return;}y=130; i=-1;if(_t_gamemode==_T_GAMEMODE_TAIWAN) y=100;_t_h5_paiX=x;_t_h5_arrowX=x-48;_t_h5_paiY=y+32*_t[1].nukidora_ctr;_t_h5_arrowY=_t_h5_paiY-8;_t_h5_arrowD=2;return;}if(!_t_fulou_dir){x=97+48; i=-1; y=150;if(_t_players==3) y-=100;if(_t_gamemode==_T_GAMEMODE_TAIWAN) y=130;_t_h5_paiX=x;_t_h5_arrowX=x+52;_t_h5_paiY=y+_t[jia].nukidora_ctr*32;_t_h5_arrowY=_t_h5_paiY;_t_h5_arrowD=0;return;}x=97+48; y=750;y-=32*_t[jia].nukidora_ctr;_t_h5_paiX=x;_t_h5_arrowX=x+52;_t_h5_paiY=y;_t_h5_arrowY=y;_t_h5_arrowD=0;}_t_h5_arrow_data=new Array(4);_t_h5_arrow_data[1]='data:image/gif;base64,R0lGODlhJwAdAKL/AP/'+'/'+'/'+'/8AAMDAwAAAAMDAwAAAAAAAAAAAACH5BAEAAAQALAAAAAAnAB0AAANfSLrc/jDKSau9OGPAu/faAwRkaZJA6Ixnm6oM25ovrMgzai94Xtu92Q8WdO1uOdqRUDwNK59OshTlUJpTIzSbfUqwXQ3Ypxo7gVzdzuwNgdtl8jKmndOpdpE6v4LzQwkAOw==';_t_h5_arrow_data[3]='data:image/gif;base64,R0lGODlhJwAdAKL/AP/'+'/'+'/'+'/8AAMDAwAAAAMDAwAAAAAAAAAAAACH5BAEAAAQALAAAAAAnAB0AAANcSLrc/jDKBcC8GIRgsXfaxn0kEYpjeZ1oqkJs675MLM+0feOlvvMe3w84EQ6JsOOxs1IqmZGKVPqcSlXGDZRmenJr3q8iiySRt7mw+Cweq7/stnV+bdvv+LwekgAAOwkAOw==';_t_h5_arrow_data[0]='data:image/gif;base64,R0lGODlhHQAnAJH/AP/'+'/'+'/'+'/8AAAAAAMDAwCH5BAEAAAMALAAAAAAdACcAAAJknI+py+0Po5y0KmAbwPkG3h1A8IUiWZojCmYrG77sRteth+Z6fiPyDkzhgsTe4Efc9ZBJ3Y3Z5CWgUdKyGjRSm8Yj1qn5wsLi7slps0F+Zoms7R6bvML5CE7ZzKf7vv8PGBhYAAA7';_t_h5_arrow_data[2]='data:image/gif;base64,R0lGODlhHQAnAJH/AP/'+'/'+'/'+'/8AAAAAAMDAwCH5BAEAAAMALAAAAAAdACcAAAJinI+py+0Po5y02gpuA1krEHTeAYYjGaSiV6pn6z7cTHPpbTowzuPr1wvyfoidsEc0GI/DxZLpA0KZv+c0hroGiVZosntMDsDbjfYmVtZqSFbTjX7F5Tl5GnPHnPb8vv+vUAAAOwA7';function _t_h5_arrow(blink, dir, x, y){var e;removeTextArea('_T_H5_ARROW');newTextArea('_T_H5_ARROW', x, y, 48, 48, 40, 'transparent', '#fff');e=document.getElementById('_T_H5_ARROW');e.innerHTML='<img alt="" src="'+_t_h5_arrow_data[dir & 3]+'" style="width: '+Math.floor(48*rRatio)+'px; height: '+Math.floor(48*rRatio)+'px; " width="29" height="29" />';e.style.background='transparent';if(!blink) return;_t_h5_arrow_dispFlag=1;_t_h5_blinkArrow=setTimeout('_t_h5_arrow_blink()', _t_h5_blinkTimeP);}function _t_h5_arrow_blink(){clearTimeout(_t_h5_blinkArrow);_t_h5_blinkArrow=null;e=document.getElementById('_T_H5_ARROW');if(!e) return;if(_t_h5_arrow_dispFlag){_t_h5_arrow_dispFlag=0;e.style.display='none';_t_h5_blinkArrow=setTimeout('_t_h5_arrow_blink()', _t_h5_blinkTimeN);return;}e.style.display='block';_t_h5_arrow_dispFlag=1;_t_h5_blinkArrow=setTimeout('_t_h5_arrow_blink()', _t_h5_blinkTimeP);}function _t_cursor_erase(){clearTimeout(_t_h5_blinkArrow);_t_h5_blinkArrow=null;removeTextArea('_T_H5_ARROW');}_t_movie_ctr=0;function _t_from_bipai_to_shupai(bjia, bpos, mjia, mode){var dx, dy, sx, sy, ex, ey, i;var bjia2, bpos2;_t_movie_ctr=0;if(mode==1){bjia2=bjia; bpos2=bpos;i=1; if(_t_players==4) ++i;while(--i>=0){for(;;){bpos2-=2;if(bpos2<0){if(--bjia2<0) bjia2=_t_players-1;bpos2=30;}if(_t_bipai4disp[bjia2][bpos2+1]) break;}}_t_from_bipai_to_shupai_sub(0, bjia, bpos, mjia, 13);_t_from_bipai_to_shupai_sub(1, bjia2, bpos2, mjia, 14);return;}_t_from_bipai_to_shupai_sub(0, bjia, bpos, mjia, 14);return;}function _t_from_bipai_to_shupai_sub(num, bjia, bpos, mjia, mpos){var dx, dy, sx, sy, i;var o=_h5_sprite[num], n;_t_get_bipai_coords(bjia, bpos);sx=_t_x; sy=_t_y-16;i=mpos; if(mpos==0) i=14;_t_get_shupai_coords(mjia, i);o.ex=_t_x; o.ey=_t_y;if(bjia==0 || (bjia==2 && _t_players==4) || _t_players==2){_t_pai_V_2sprite(o.id, -1);o._x=o.sx=sx; o._y=o.sy=sy;}else  {_t_pai_H_2sprite(o.id, -1);o._x=o.sx=sx; o._y=o.sy=sy;}o.mode=1; o.dy1=0;o.jia=mjia;moveSprite(o.id, o._x, o._y);o.timeout=setTimeout('_t_from_bipai_to_shupai_sub1('+num+')', _t_h5_frameDulation);_t_movie_ctr++;}function _t_from_bipai_to_shupai_sub1(num){var f=0, o=_h5_sprite[num];clearTimeout(o.timeout);o._y-=20; ++o.dy1;var d=Math.sqrt(Math.pow(o.ex-o._x, 2)+Math.pow(o.ey-o._y, 2))/_t_speed;if(d!=0){o.dx=(o.ex-o._x)/ d;o.dy=(o.ey-o._y)/ d;}else {o.dx=0;o.dy=0;}if(o.dy1>10){hideSprite(o.id);_t_movie_ctr=0;return;}moveSprite(o.id, o._x, o._y);if(o.dy1<4){o.timeout=setTimeout('_t_from_bipai_to_shupai_sub1('+num+')', _t_h5_frameDulation);return;}if(o.jia==0 || (o.jia==2 && _t_players==4) || _t_players==2){_t_pai_V_2sprite(o.id, -1);o.sx=o._x; o.sy=o._y;}else {_t_pai_H_2sprite(o.id, -1);o.sx=o._x; o.sy=o._y;}moveSprite(o.id, o._x, o._y);o.timeout=setTimeout('_t_from_bipai_to_shupai_sub2('+num+')', _t_h5_frameDulation);}function _t_from_bipai_to_shupai_sub2(num){var o=_h5_sprite[num];clearTimeout(o.timeout);if(o.dx!=0 || o.dy!=0){var pd=Math.pow(o.ex-o._x, 2)+Math.pow(o.ey-o._y, 2);o._x+=o.dx; o._y+=o.dy;var nd=Math.pow(o.ex-o._x, 2)+Math.pow(o.ey-o._y, 2);if((o.dx>0 && o._x>=o.ex) ||    (o.dx<0 && o._x<=o.ex) ||    (o.dy>0 && o._y>=o.ey) ||    (o.dy<0 && o._y<=o.ey) ||    nd>=pd){hideSprite(o.id);_t_movie_ctr--;return;}moveSprite(o.id, o._x, o._y);o.timeout=setTimeout('_t_from_bipai_to_shupai_sub2('+num+')', _t_h5_frameDulation);return;}hideSprite(p.id);_t_movie_ctr--;return;}function _t_from_shupai_to_he(djia, dpos, pcode, dpmode){var ex, ey, x, y, pai, i, o=_h5_sprite[0], pcode2=pcode;_t_movie_ctr=0;o.ex=_t_h5_paiX;o.ey=_t_h5_paiY;if(dpmode==-1){pcode2 &= 0x7f;}_t_get_shupai_coords(djia, dpos);o._x=_t_x;o._y=_t_y;_t_movie_ctr=0;if(_t[djia].fusipai_ctr<1) return;i=o.pcode=pcode; if(djia!=0 && !_t[djia].open && !_t_open_mode){if(djia==0)_t_pai_V_2sprite(o.id, i);else if((djia==2 && _t_players==4) || _t_players==2)_t_pai_UR2_2sprite(o.id, o.pcode);else if(djia==1)_t_pai_UR1_2sprite(o.id, o.pcode);else
_t_pai_UR3_2sprite(o.id, o.pcode);}else {i &= 0x7f;if(djia==0)_t_pai_V_2sprite(o.id, i);else if((djia==2 && _t_players==4) || _t_players==2)_t_pai_V_2sprite(o.id, i | 0x80);else if(djia==1)_t_pai_H_2sprite(o.id, i);else
_t_pai_H_2sprite(o.id, i | 0x80);}o.dy1=0; o.jia=djia;moveSprite(o.id, o._x, o._y);o.timeout=setTimeout('_t_from_shupai_to_he_sub1()', _t_h5_frameDulation);_t_movie_ctr=1;}function _t_from_shupai_to_he_sub1(){var f=0, dx, dy, o=_h5_sprite[0];o._y-=40; ++o.dy1;var d=Math.sqrt(Math.pow(o.ex-o._x, 2)+Math.pow(o.ey-o._y, 2))/_t_speed;if(d!=0){o.dx=(o.ex-o._x) / d;o.dy=(o.ey-o._y) / d;}else {o.dx=0;o.dy=0;}if(o.dy1>10){hideSprite(o.id);_t_movie_ctr=0;return;}moveSprite(o.id, o._x, o._y);if(o.dy1<5){o.timeout=setTimeout('_t_from_shupai_to_he_sub1()', _t_h5_frameDulation);return;}i=o.pcode;if(!(i & 0x100)){i &= 0x7f;if(o.jia==0)_t_pai_V_2sprite(o.id, i);else if((o.jia==2 && _t_players==4) || _t_players==2)_t_pai_V_2sprite(o.id, i | 0x80);else if(o.jia==1)_t_pai_H_2sprite(o.id, i);else
_t_pai_H_2sprite(o.id, i | 0x80);}else {i &= 0x7f;if(o.jia==0)_t_pai_H_2sprite(o.id, i);else if((o.jia==2 && _t_players==4) || _t_players==2)_t_pai_H_2sprite(o.id, i | 0x80);else if(o.jia==1)_t_pai_V_2sprite(o.id, i | 0x80);else
_t_pai_V_2sprite(o.id, i);}o.timeout=setTimeout('_t_from_shupai_to_he_sub2()', _t_h5_frameDulation);}function _t_from_shupai_to_he_sub2(){var o=_h5_sprite[0];clearTimeout(o.timeout);if(o.dx!=0 || o.dy!=0){var pd=Math.pow(o.ex-o._x, 2)+Math.pow(o.ey-o._y, 2);o._x+=o.dx; o._y+=o.dy;var nd=Math.pow(o.ex-o._x, 2)+Math.pow(o.ey-o._y, 2);if((o.dx>0 && o._x>=o.ex) ||    (o.dx<0 && o._x<=o.ex) ||    (o.dy>0 && o._y>=o.ey) ||    (o.dy<0 && o._y<=o.ey) ||    nd>=pd){hideSprite(o.id);_t_movie_ctr=0;return;}moveSprite(o.id, o._x, o._y);o.timeout=setTimeout('_t_from_shupai_to_he_sub2()', _t_h5_frameDulation);return;}hideSprite(p.id);_t_movie_ctr=0;return;}function _t_from_shupai_to_di(jia, pcode){var o=_h5_sprite[0];_t_movie_ctr=0;_t_get_shupai_coords(jia, 14);if(jia==0){_t_x+=8;_t_imageRate=1.2;_t_pai_V_2sprite(o.id, pcode & 0x7f);_t_imageRate=1;}else if((jia==2 && _t_players==4) || _t_players==2){_t_x-=16; _t_y+=33;_t_pai_V_2sprite(o.id, (pcode & 0x7f) | 0x80);}else if(jia==1){_t_x-=32; _t_y+=6;if(_t_gamemode==_T_GAMEMODE_GUOJI){_t_x=1064;_t_y-=16;}else if(_t_gamemode==_T_GAMEMODE_TAIWAN){_t_y-=10;}else {_t_x=1064; y-=56;}_t_pai_H_2sprite(o.id, pcode & 0x7f);}else  {_t_x+=4; _t_y+=20;if(_t_gamemode==_T_GAMEMODE_TAIWAN){ _t_y+=16; }_t_pai_H_2sprite(o.id, (pcode & 0x7f) | 0x80);}_t_ox=_t_x;_t_oy=_t_y;_t_movie_ctr=1;if(graph_noSprite){o.timeout=setTimeout('_t_from_shupai_to_di_sub2('+jia+','+pcode+')', 120);return;}o.ctr=5;if(jia==0) o.ctr=4;moveSprite(o.id, _t_ox, _t_oy-40);o.timeout=setTimeout('_t_from_shupai_to_di_sub1('+jia+','+pcode+')', 60);return;}function _t_from_shupai_to_di_sub1(jia, pcode){var o=_h5_sprite[0];clearTimeout(o.timeout);--o.ctr;moveSprite(o.id, _t_ox, _t_oy-10*o.ctr);if(o.ctr<1){o.timeout=setTimeout('_t_from_shupai_to_di_sub2('+jia+','+pcode+')', 30);return;}o.timeout=setTimeout('_t_from_shupai_to_di_sub1('+jia+','+pcode+')', 10);}function _t_from_shupai_to_di_sub2(jia, pcode){var o=_h5_sprite[0];clearTimeout(o.timeout);o.ctr=4;o.dirX=o.dirY=0;if(_t_jia==0){o.dirY=6;}else if((jia==2 && _t_players==4) || _t_players==2){o.dirY=-6;}else if(jia==1){o.dirX=8;}else  {o.dirX=-8;}AUDIO_OUTPUT('moheByCPU', false);o.timeout=setTimeout('_t_from_shupai_to_di_sub3('+jia+','+pcode+')', 30);}function _t_from_shupai_to_di_sub3(jia, pcode){var o=_h5_sprite[0];clearTimeout(o.timeout);moveSprite(o.id, _t_ox+o.dirX, _t_oy+o.dirY);o.dirX=-o.dirX;o.dirY=-o.dirY;if(--o.ctr<1){o.timeout=setTimeout('_t_from_shupai_to_di_sub4('+jia+','+pcode+')', 30);return;}o.timeout=setTimeout('_t_from_shupai_to_di_sub3('+jia+','+pcode+')', 30);}function _t_from_shupai_to_di_sub4(jia, pcode){var o=_h5_sprite[0];clearTimeout(o.timeout);if(_t_jia==0){_t_imageRate=1.2;_t_pai_V(pcode & 0x7f, _t_ox, _t_oy);_t_imageRate=1;}else if((jia==2 && _t_players==4) || _t_players==2){_t_pai_V((pcode & 0x7f) | 0x80, _t_ox, _t_oy);}else if(jia==1){_t_pai_H(pcode & 0x7f, _t_ox, _t_oy);}else  {_t_pai_H((pcode & 0x7f) | 0x80, _t_ox, _t_oy);}hideSprite(o.id);_t_movie_ctr=0;}function _t_h5_dapai_erase(jia){_t_get_shupai_coords(jia, 14);if(jia==0){_t_x+=7;putRectangle(_t_x, _t_y, 50*_t_imageRate, 74*_t_imageRate, _t_tableColor);}else if((jia==2 && _t_players==4) || _t_players==2){_t_x-=17; _t_y+=33;putRectangle(_t_x, _t_y, 42*_t_imageRate, 60*_t_imageRate, _t_tableColor);}else if(jia==1){_t_x-=33; _t_y+=5;if(_t_gamemode==_T_GAMEMODE_GUOJI){_t_x=1064;_t_y-=16;}else if(_t_gamemode==_T_GAMEMODE_TAIWAN){_t_y-=10;}else {_t_x=1064; y-=56;}putRectangle(_t_x, _t_y, 50*_t_imageRate, 50*_t_imageRate, _t_tableColor);if(_t_zhuangjia==1) _t_h5_sticks_and_dice_disp();}else  {_t_x+=4; _t_y+=20;if(_t_gamemode==_T_GAMEMODE_TAIWAN){ _t_y+=16; }putRectangle(_t_x, _t_y, 50*_t_imageRate, 50*_t_imageRate, _t_tableColor);if(_t_zhuangjia==jia) _t_h5_sticks_and_dice_disp();}}function _t_reach_stick_disp(jia){var dx, dy, sx, sy, ex, ey, i, d, w, h;var o=_h5_sprite[0];_t_movie_ctr=0;if(_t_gamemode!=_T_GAMEMODE_REACH && _t_gamemode!=_T_GAMEMODE_EASTERN_BOO) return;sx=1000; sy=650;ex=552; ey=505;d=1; w=96; h=6;if((_t_players==2 && jia) || (_t_players==4 && jia==2)){sy=0; sx=250;ex=552; ey=376;}else if(jia==1){sx=1200; sy=650;ex=732; ey=400;d=0; w=7; h=88;if(_t_players==3){sy-=64; ey-=20;}}else if(jia){sx=0; sy=110;ex=460; ey=378;d=0; w=7; h=88;if(_t_players==3){sy-=96; ey-=84;}}_t_h5_stick_disp_2sprite(o.id, d, w, h);o._x=sx;o.ex=ex;o._y=sy;o.ey=ey;dx=dy=1000;var d=Math.sqrt(Math.pow(o.ex-o._x, 2)+Math.pow(o.ey-o._y, 2)) / _t_speed;if(d){d*=2;o.dx=(o.ex-o._x) / d;o.dy=(o.ey-o._y) / d;}else {o.dx=0;o.dy=0;}_t_movie_ctr=1;moveSprite(o.id, sx, sy);o.timeout=setTimeout('_t_reach_stick_disp_sub()', _t_h5_frameDulation);}function _t_reach_stick_disp_sub(){var o=_h5_sprite[0];clearTimeout(o.timeout);if(o.dx!=0 || o.dy!=0){var pd=Math.pow(o.ex-o._x, 2)+Math.pow(o.ey-o._y, 2);o._x+=o.dx; o._y+=o.dy;var nd=Math.pow(o.ex-o._x, 2)+Math.pow(o.ey-o._y, 2);if((o.dx>0 && o._x>=o.ex) ||    (o.dx<0 && o._x<=o.ex) ||    (o.dy>0 && o._y>=o.ey) ||    (o.dy<0 && o._y<=o.ey) ||    nd>=pd){hideSprite(o.id);_t_movie_ctr=0;return;}}moveSprite(o.id, o._x, o._y);o.timeout=setTimeout('_t_reach_stick_disp_sub()', _t_h5_frameDulation);}function _tm_dapai2he(jia){var i, d, d1, o=_h5_sprite[0];_t_movie_ctr=0;if(_t_gamemode!=_T_GAMEMODE_TAIWAN) return;o._y=o.sy=_t_h5_paiY;o._x=o.sx=_t_h5_paiX;_tm_getFusipaiCoords(jia);_tm_fusipaiA[_tm_dapaiHX][_tm_dapaiHY]=_tm_dapaiA;_tm_fusipaiC[_tm_dapaiHX][_tm_dapaiHY]=_t_dapai_buff;o.ex=_tm_dapaiX; o.ey=_tm_dapaiY;_tm_dapai_erase(jia);if(jia==0)_t_pai_V_2sprite(o.id, _t_dapai_buff);else if((jia==2 && _t_players==4) || _t_players==2)_t_pai_V_2sprite(o.id, _t_dapai_buff | 0x80);else if(jia==1)_t_pai_H_2sprite(o.id, _t_dapai_buff);else
_t_pai_H_2sprite(o.id, _t_dapai_buff | 0x80);dx=dy=1000;var d2=Math.sqrt(Math.pow(o.ex-o._x, 2)+Math.pow(o.ey-o._y, 2)) / _t_speed;if(d2<3) d2=3;o.dx=(o.ex-o._x)/d2;o.dy=(o.ey-o._y)/d2;o.timeout=setTimeout('_tm_dapai2he_sub()', _t_h5_frameDulation);_t_movie_ctr=1;}function _tm_dapai2he_sub(){var o=_h5_sprite[0];clearTimeout(o.timeout);if(o.dx!=0 || o.dy!=0){var pd=Math.pow(o.ex-o._x, 2)+Math.pow(o.ey-o._y, 2);o._x+=o.dx; o._y+=o.dy;var nd=Math.pow(o.ex-o._x, 2)+Math.pow(o.ey-o._y, 2);if(    nd>=pd){hideSprite(o.id);_t_movie_ctr=0;_tm_fusipai_disp();return;}moveSprite(o.id, o._x, o._y);o.timeout=setTimeout('_tm_dapai2he_sub()', _t_h5_frameDulation);return;}hideSprite(o.id);_t_movie_ctr=0;_tm_fusipai_disp();return;}_t_dice_dx=[0, 0, 0];_t_dice_dy=[0, 0, 0];_t_dice_flag=0;_t_dice=[1, 5, 2];_t_dice_d=[1, 5, 2];_t_dice_x=[1, 5, 2];_t_dice_y=[1, 5, 2];_t_dice_ctr=0;_t_dice_ctr2=0;function _t_throw_dice(jia, n){var x, y, x1, y1, x2, y2, d1, o, p;var i, j, dir;_t_dice_flag=1;_t_movie_ctr=0;var hx=new Array(3), sx=new Array(3), ex=new Array(3);var hy=new Array(3), sy=new Array(3), ey=new Array(3);var sr=160, er=60;var dsp=24;var dsq=18;var dy=0;if(jia==0){_t_dice_dx=[600-(dsp >> 1)-24, 600+(dsp >> 1), -1];_t_dice_dy=[574+dy, 574+dy, 574+dy];if(n==3){_t_dice_dx=[600-12-dsp-24, 600-12, 600+12+dsp];}y1=530;sy[0]=sy[1]=sy[2]=y1-120;hy[0]=hy[1]=hy[2]=y1+dy;ey[0]=y1-60+Math.floor(Math.random()*40)+dy;ey[1]=y1-60+Math.floor(Math.random()*40)+dy;ey[2]=y1-60+Math.floor(Math.random()*40)+dy;if(n==2){sx[0]=540; sx[1]=660;hx[0]=590; hx[1]=610;ex[0]=540+Math.floor(Math.random()*50); ex[1]=ex[0]+100-Math.floor(Math.random()*50);}else {sx[0]=540; sx[1]=570; sx[2]=600;hx[0]=580; hx[1]=600; hx[2]=620;ex[0]=480+Math.floor(Math.random()*30); ex[1]=560+Math.floor(Math.random()*30); ex[2]=640+Math.floor(Math.random()*30);}}else if((_t_players==2 && jia==1) || (_t_players==4 && jia==2)){_t_dice_dx=[600-(dsp >> 1)-24, 600+(dsp >> 1), -1];_t_dice_dy=[228, 228, 228];if(n==3){_t_dice_dx=[600-12-dsp-24, 600-12, 600+12+dsp];}y1=140;sy[0]=sy[1]=sy[2]=y1+120;hy[0]=hy[1]=hy[2]=y1;ey[0]=y1+100+Math.floor(Math.random()*40);ey[1]=y1+100+Math.floor(Math.random()*40);ey[2]=y1+100+Math.floor(Math.random()*40);if(n==2){sx[1]=540; sx[0]=660;hx[1]=590; hx[0]=610;ex[1]=550+Math.floor(Math.random()*30); ex[0]=650-Math.floor(Math.random()*30);}else {sx[2]=540; sx[1]=600; sx[0]=660;hx[2]=580; hx[1]=600; hx[0]=620;ex[2]=500+Math.floor(Math.random()*30); ex[1]=600-Math.floor(Math.random()*30); ex[0]=700-Math.floor(Math.random()*30);}}else if(jia==1){_t_dice_dy=[420-(dsq >> 1)-24, 420+(dsq >> 1), -1];_t_dice_dx=[768, 768, -1];if(n==3){_t_dice_dy=[420-12-dsq-24, 420-12, 420+12+dsq];_t_dice_dx[2]=768;}else if(_t_players==3){_t_dice_dy[0]-=104;_t_dice_dy[1]-=104;_t_dice_dy[2]-=104;}x1=890;sx[0]=sx[1]=sx[2]=x1-140;hx[0]=hx[1]=hx[2]=x1;ex[0]=x1-120+Math.floor(Math.random()*40);ex[1]=x1-120+Math.floor(Math.random()*40);ex[2]=x1-120+Math.floor(Math.random()*40);if(n==2){sy[2]=sy[1]=sy[0]=100;hy[1]=hy[0]=280;ey[1]=360-Math.floor(Math.random()*10); ey[0]=420+Math.floor(Math.random()*10);}else {sy[2]=sy[1]=sy[0]=100;hy[2]=hy[1]=hy[0]=270;ey[2]=300-Math.floor(Math.random()*10); ey[1]=340-Math.floor(Math.random()*10); ey[0]=380+Math.floor(Math.random()*10);}if(_t_players==3){var j=3; while(--j>=0){ sy[j]-=140; hy[j]-=140; ey[j]-=140; }}}else {_t_dice_dy=[420-(dsq >> 1)-24, 420+(dsq >> 1), -1];_t_dice_dx=[348, 348, -1];if(n==3){_t_dice_dy=[420-12-dsq-24, 420-12, 420+12+dsq];_t_dice_dx[2]=348;}else if(_t_players==3){_t_dice_dy[0]-=64;_t_dice_dy[1]-=64;_t_dice_dy[2]-=64;}x1=290;sx[0]=sx[1]=sx[2]=x1+140;hx[0]=hx[1]=hx[2]=x1;ex[0]=x1+120+Math.floor(Math.random()*40);ex[1]=x1+120+Math.floor(Math.random()*40);ex[2]=x1+120+Math.floor(Math.random()*40);if(n==2){sy[2]=sy[1]=sy[0]=100;hy[1]=hy[0]=370;ey[1]=370-Math.floor(Math.random()*10); ey[0]=450-Math.floor(Math.random()*10);}else {sy[2]=sy[1]=sy[0]=100;hy[2]=hy[1]=hy[0]=370;ey[2]=370-Math.floor(Math.random()*10); ey[1]=430-Math.floor(Math.random()*10); ey[0]=490+Math.floor(Math.random()*10);}if(_t_players==3){var j=3; while(--j>=0){ sy[j]-=126; hy[j]-=126; ey[j]-=126; }}}if(graph_noSprite){o=_h5_sprite[4];o.ctr=20;_t_movie_ctr=1;o.timeout=setTimeout('_t_h5_animation_dice1(0)', _t_h5_frameDulation);return;}var ds, dx=dy=1;i=n; while(--i>=0){o=_h5_sprite[4-i];ds=Math.sqrt(Math.pow(hx[i]-sx[i], 2)+Math.pow(hy[i]-sy[i], 2)) / _t_speed;dx=dy=1;if(ds){ds*=7;dx=(hx[i]-sx[i]) / ds;dy=(hy[i]-sy[i]) / ds;}_t_dice_x[i]=ex[i]; _t_dice_y[i]=ey[i];_t_h5_dice_disp_2sprite(o.id, _t_dice[i], 71, 96);o._x=sx[i]; o._y=sy[i];o.sx=sx[i]; o.sy=sy[i];o.hx=hx[i]; o.hy=hy[i];o.ex=ex[i]; o.ey=ey[i];o.sr=sr; o.er=er;o.dnum=_t_dice[i];o.dx=dx;o.dy=dy;o.flag=1;d=d1;_t_h5_dice_disp_2sprite(o.id, o.dnum, 24, 32);o.timeout=setTimeout('_t_h5_animation_dice1('+i+')', _t_h5_frameDulation);_t_movie_ctr++;}}function _t_h5_animation_dice1(dno){var d1, d2, r;var i;var o=_h5_sprite[4-dno];clearTimeout(o.timeout);if(graph_noSprite){i=-1; while(++i<3){if(_t_dice_dx[i]<0) break;_t_dice[i]=_h5_sprite[4-i].dnum=_t_dice[i]=Math.floor(Math.random()*6)+1;_t_h5_dice_disp(_t_dice[i], _t_dice_dx[i], _t_dice_dy[i], 24, 32);}if(_t_rule_sel['UI_silence']!=1) AUDIO_OUTPUT('dice'+(++_t_dice_ctr & 3), false);if(--o.ctr<0){_t_movie_ctr=0;}else {o.timeout=setTimeout('_t_h5_animation_dice1(0)', _t_h5_frameDulation);}return;}o.dnum=_t_dice[dno]=Math.floor(Math.random()*6)+1;if(o.flag==1){d1=Math.pow(o.hx-o._x, 2)+Math.pow(o.hy-o._y, 2);o._x+=o.dx; o._y+=o.dy;d2=Math.pow(o.hx-o._x, 2)+Math.pow(o.hy-o._y, 2);if(d2>d1){var ds;ds=Math.sqrt(Math.pow(o.hx-o.ex, 2)+Math.pow(o.hy-o.ey, 2)) / _t_speed;if(ds){ds*=20;o.dx=(o.ex-o.hx) / ds;o.dy=(o.ey-o.hy) / ds;}o.flag=2; _t_dice_ctr2=0;o._x=o.hx; o._y=o.hy;if(_t_rule_sel['UI_silence']!=1 && dno<1) AUDIO_OUTPUT('dice'+(++_t_dice_ctr & 3), false);}if(o.sx!=o.hx) r=(o.er-o.sr)*(o._x-o.sx)/(o.hx-o.sx)+o.sr;else r=(o.er-o.sr)*(o._y-o.sy)/(o.hy-o.sy)+o.sr;if(r*32>96) r=3;_t_h5_dice_disp_2sprite(o.id, _t_dice[dno], 24*r, 32*r);moveSprite(o.id, o._x, o._y);o.timeout=setTimeout('_t_h5_animation_dice1('+dno+')', _t_h5_frameDulation);return;}if(o.flag==2){_t_h5_dice_disp_2sprite(o.id, _t_dice[dno], 24, 32);moveSprite(o.id, o._x, o._y);if(_t_rule_sel['UI_silence']!=1 && dno<1 && !(++_t_dice_ctr2 & 1)) AUDIO_OUTPUT('dice'+(++_t_dice_ctr & 3), false);d1=Math.pow(o.ex-o._x, 2)+Math.pow(o.ey-o._y, 2);o._x+=o.dx; o._y+=o.dy;d2=Math.pow(o.ex-o._x, 2)+Math.pow(o.ey-o._y, 2);if(d2>d1){o.flag=0;_t_movie_ctr--;return;}o.timeout=setTimeout('_t_h5_animation_dice1('+dno+')', _t_h5_frameDulation);return;}}function _t_dice_erase(mode){var x, y, dx, dy, d, i;_t_dice_flag=0;i=-1; while(++i<3){if(_t_dice_dx[i]<0) break;putRectangle(_t_dice_dx[i]-1, _t_dice_dy[i]-1, 26, 34, _t_tableColor);}var i=3;while(--i>-1) hideSprite(_h5_sprite[4-i].id);if(mode) return;i=3; while(--i>-1){_t_h5_dice[i]=Math.floor(Math.random()*6)+1;}_t_h5_sticks_and_dice_disp();}function _t_console_erase(){removeTextArea('COMMAND_BAR');removeTextArea('COMMAND_27');removeTextArea('COMMAND_26');removeTextArea('COMMAND_25');removeTextArea('COMMAND_24');removeTextArea('COMMAND_23');removeTextArea('COMMAND_22');removeTextArea('COMMAND_21');removeTextArea('COMMAND_14');removeTextArea('COMMAND_14T');}function _t_console_disp(gang, peng, chi, reach, hele, daopai, nextCMD){var dx=1042, dy=766, o;var e, w=210, dw=200, c, cw=56;_t_console_erase();if(_t_lang=='en'){cw=80; w=320; dw=310;}newTextArea('COMMAND_BAR', dx-445-w, 754, 450+w, 49, 32, 'rgba(0,0,0,.7)', '#fff');e=document.getElementById('COMMAND_BAR');e.style.border='solid rgba(204,204,204,.7) 2px';if(_t_lang!='en'){ dx+=6; dy+=2; }if(_t_gamemode==_T_GAMEMODE_GUOJI){if(_t[0].fulou_ctr<2){newAnchorArea(27, dx-444-dw, dy, cw, 32, 'COMMAND_27', 28, 'transparent', '#fff');e=document.getElementById('COMMAND_27');e.setAttribute('onclick', 'H5_LIPAI4GUOJI(); return(false);');}else {newTextArea('COMMAND_27', dx-449-dw, dy, cw, 32, 28, 'transparent', '#404040');}e=document.getElementById('COMMAND_27');e.style.fontFamily='serif';e.style.textAlign='center';e.style.lineHeight='1em';e.style.verticalAlign='text-top';e.innerHTML=(_t_lang!='en') ? '理牌' : '<span style="font-size: '+Math.floor(25*rRatio)+'px;">SORT</span>';}else if(_t_gamemode!=_T_GAMEMODE_TAIWAN){var cw2=cw; if(_t_lang=='en') cw2=136;if(daopai){newAnchorArea(26, dx-449-dw, dy, cw2, 32, 'COMMAND_26', 28, 'transparent', '#fff')}else {newTextArea('COMMAND_26', dx-449-dw, dy, cw2, 32, 28, 'transparent', '#404040');}e=document.getElementById('COMMAND_26');e.style.fontFamily='serif';e.style.textAlign='center';e.style.lineHeight='1em';e.style.verticalAlign='text-top';e.innerHTML=(_t_lang!='en') ? '流局' : '<span style="font-size: '+Math.floor(25*rRatio)+'px;">A.&nbsp;DRAWN</span>';}if(gang){newAnchorArea(21, dx-522, dy, cw, 32, 'COMMAND_21', 28, 'transparent', '#fff')}else {newTextArea('COMMAND_21', dx-522, dy, cw, 32, 28, 'transparent', '#404040');}e=document.getElementById('COMMAND_21');e.style.fontFamily='serif';e.style.textAlign='center';e.style.lineHeight='1em';e.style.verticalAlign='text-top';e.innerHTML=(_t_lang!='en') ? 'カン' : '<span style="font-size: '+Math.floor(25*rRatio)+'px;">KONG</span>';if(peng){newAnchorArea(22, dx-432, dy, cw, 32, 'COMMAND_22', 28, 'transparent', '#fff')}else {newTextArea('COMMAND_22', dx-432, dy, cw, 32, 28, 'transparent', '#404040');}e=document.getElementById('COMMAND_22');e.style.fontFamily='serif';e.style.textAlign='center';e.style.lineHeight='1em';e.style.verticalAlign='text-top';e.innerHTML=(_t_lang!='en') ? 'ポン' : '<span style="font-size: '+Math.floor(25*rRatio)+'px;">PUNG</span>';if(chi && _t_players!=3){newAnchorArea(23, dx-342, dy, cw, 32, 'COMMAND_23', 28, 'transparent', '#fff')}else {newTextArea('COMMAND_23', dx-342, dy, cw, 32, 28, 'transparent', '#404040');}e=document.getElementById('COMMAND_23');e.style.fontFamily='serif';e.style.textAlign='center';e.style.lineHeight='1em';e.style.verticalAlign='text-top';e.innerHTML=(_t_lang!='en') ? 'チー' : '<span style="font-size: '+Math.floor(25*rRatio)+'px;">CHOW</span>';if(_t_gamemode==_T_GAMEMODE_TAIWAN){if(reach){newAnchorArea(24, dx-252, dy, cw, 32, 'COMMAND_24', 28, 'transparent', '#fff')}else {newTextArea('COMMAND_24', dx-252, dy, cw, 32, 28, 'transparent', '#404040');}e=document.getElementById('COMMAND_24');e.style.fontFamily='serif';e.style.textAlign='center';e.style.lineHeight='1em';e.style.verticalAlign='text-top';e.innerHTML='聴牌';}else {if(reach && _t_gamemode!=_T_GAMEMODE_GUOJI){newAnchorArea(24, dx-252, dy, cw, 32, 'COMMAND_24', 28, 'transparent', '#fff')}else {newTextArea('COMMAND_24', dx-252, dy, cw, 32, 28, 'transparent', '#404040');}e=document.getElementById('COMMAND_24');e.style.fontFamily='serif';e.style.textAlign='center';e.style.lineHeight='1em';e.style.verticalAlign='text-top';if(reach>1){e.innerHTML='公開';}else {e.innerHTML=(_t_lang!='en') ? '立直' : '<span style="font-size: '+Math.floor(25*rRatio)+'px;">RIICHI</span>';}}if(hele){newAnchorArea(25, dx-162, dy, cw, 32, 'COMMAND_25', 28, 'transparent', '#fff')}else {newTextArea('COMMAND_25', dx-162, dy, cw, 32, 28, 'transparent', '#404040');}e=document.getElementById('COMMAND_25');e.style.fontFamily='serif';e.style.textAlign='center';e.style.lineHeight='1em';e.style.verticalAlign='text-top';e.innerHTML=(_t_lang!='en') ? '和了' : '<span style="font-size: '+Math.floor(25*rRatio)+'px;">WIN</span>';if(nextCMD){newAnchorArea(14, dx-72, dy, cw, 32, 'COMMAND_14', 28, 'transparent', '#fff')}else {newTextArea('COMMAND_14', dx-72, dy, cw, 32, 28, 'transparent', '#404040');}e=document.getElementById('COMMAND_14');e.style.fontFamily='serif';e.style.textAlign='center';e.style.lineHeight='1em';e.style.verticalAlign='text-top';if(_t_lang=='en'){e.innerHTML='<span style="font-size: '+Math.floor(25*rRatio)+'px;">NEXT</span>';}else {var s='摸切';if(!_t[0].shupai[14] & 0x3f) s='進行';else if(_t_pengchi_flag) s='右端';e.innerHTML=s;}if(_t_pengchi_flag) return;var x=1006, y=810-_t_disp_YOffset;if(_t_fulou_dir){if(_t_gamemode==_T_GAMEMODE_TAIWAN){if(_t_fulou_dir) x=974-144*_t[0].fulou_ctr;}else {x=830-144*_t[0].fulou_ctr;if(_t_gamemode!=_T_GAMEMODE_GUOJI){var i=-1, k=-5; while(++i<_t[0].fulou_ctr){k+=5;if(_t[0].fuloupai[k+4]){x+=160*1.2;}}}}}newAnchorArea(14, x, y, 40*1.2, 60*1.2, 'COMMAND_14T', 28, 'transparent', '#fff');return;}function H5_LIPAI4GUOJI(){_gm_lipai_sw=1;_t_lipai(0);_t_shupai_disp(0);_gm_lipai_sw=0;inputKey=0;}function _t_mini_console_disp(){var dx=958, dy=770, n, o, cw=56, w=80;_t_console_erase();if(_t_lang=='en'){ dx=960, dy=774; }newTextArea('COMMAND_BAR', dx, 754, 88, 49, 32, 'rgba(0,0,0,.7)', '#fff');e=document.getElementById('COMMAND_BAR');e.style.border='solid rgba(204,204,204,.7) 2px';dx=980; dy=766;if(_t_lang=='en'){ dx=970; dy=766; cw=80; }newAnchorArea(14, dx, dy, cw, 32, 'COMMAND_14', 28, 'transparent', '#fff');e=document.getElementById('COMMAND_14');e.style.fontFamily='serif';e.style.textAlign='center';e.style.lineHeight='1em';e.style.verticalAlign='text-top';e.innerHTML=(_t_lang=='en') ? '<span style="font-size: '+Math.floor(25*rRatio)+'px;">NEXT</span>' : '進行';}function _t_status_disp(str){var fontSize=20;_t_status_erase();_h5_status_string=str;var x=816;var y=650;var w=232;var h=102;if(_t_lang=='en'){x-=80; w+=80;fontSize='24';}newTextArea('PROMPT_WINDOW', x, y, w-16, h-16, fontSize, 'rgba(255,255,255,.8)', '#000');e=document.getElementById('PROMPT_WINDOW');if(!_t_status_left) _t_status_left=e.style.left;else e.style.left=_t_status_left;e.style.border='solid #ccc 2px';e.style.padding=Math.floor(8*rRatio)+'px';e.style.fontSize=Math.floor(20*rRatio)+'px';e.style.overflow='hidden';e.style.fontFamily='sans-serif';str=str.split('\n').join('<br />');e.innerHTML=str;return;}function _t_status_erase(){_h5_status_string='';e=document.getElementById('PROMPT_WINDOW');if(e) e.parentNode.removeChild(e);}function _t_score_card_disp(){var cs=28, margin=16, blines=4, bcolumns=16;var ch=cs+blines;var bz=-1, jia, x, y, i, j, k;var ssgn=new Array(_t_game_ctr+1), sstr=new Array(_t_game_ctr+1);var str;_t_button_ctr=0;_t_table_color();var w=cs*32+margin*2+bcolumns*3;var h=cs*24+blines*5+cs+margin*2;var xh=600-w/2, yh=450-h/2;_t_textWindow('SCORE_TABLE', xh, yh, w, h);i='リーチ麻雀';if(_t_players==3){i='三人リーチ麻雀';if(_t_gamemode==_T_GAMEMODE_CHIP_MAHJONG) i='三人麻雀';else if(_t_gamemode==_T_GAMEMODE_BEINUKI) i='北抜き';else if(_t_gamemode==_T_GAMEMODE_PENGLI) i='ポンリー';}else if(_t_gamemode==_T_GAMEMODE_ARSHIAR) i='アルシァル麻雀';else if(_t_gamemode==_T_GAMEMODE_BOO) i='ブー麻雀';else if(_t_gamemode==_T_GAMEMODE_EASTERN_BOO) i='関東式ブー麻雀';else if(_t_gamemode==_T_GAMEMODE_TAIWAN) i='台湾麻将';else if(_t_gamemode==_T_GAMEMODE_GUOJI) i='中共麻将';str=i+' 第 '+(_t_game_ctr+1)+'回戦終了';if(_t_lang=='en'){str='<i>Riichi</i> Mahjong';if(_t_gamemode==_T_GAMEMODE_GUOJI) str='Mahjong Competition Rules';switch (_t_game_ctr){case 0: i='1st Game'; break;case 1: i='2nd Game'; break;case 2: i='3rd Game'; break;default: i=(_t_game_ctr+1)+'th Game';}str=i+' of '+str+' Completed.';}_t_leftText('COMPLETED_THE_GAME', xh+margin, yh+margin, cs*20, cs, '#fff', str);xh+=margin;yh+=margin;var w=cs*3;if(_t_gamemode==_T_GAMEMODE_PENGLI) w=cs*8;x=xh; y=yh+ch*2;bz=-1; while(++bz<=_t_game_ctr){y+=ch;_t_rightText('GAME_CTR_'+bz, x, y, cs, cs, '#ff0', bz+1);}y+=ch*1.5;str='計'; if(_t_lang=='en') str='Total';_t_leftText('GAEM_TOTAL', x, y, cs*2.5, cs, '#ff0', str);x=xh+cs*4; y=yh+ch*2;i=-1; while(++i<_t_players){w=cs*3;bz=-1; while(++bz<=_t_game_ctr){ssgn[bz]=0;j=_t[i].result[bz];if(j<0){ ssgn[bz]=1; j=-j; }if(_t_gamemode==_T_GAMEMODE_ARSHIAR || _t_gamemode==_T_GAMEMODE_GUOJI) j=Math.floor(j/10)+'.'+(j % 10);else if(_t_gamemode==_T_GAMEMODE_REACH && _t_lang!='ja') j=_t_str_for_score_card(j*100);else j=_t_str_for_score_card(j);sstr[bz]=j; k=cs*3;if(j.length>4){k+=cs*((j.length-3) >> 1);if(k>w) w=k;}}ssgn[bz]=0;j=_t[i].total_result;if(j<0){ ssgn[bz]=1; j=-j; }if(_t_gamemode==_T_GAMEMODE_ARSHIAR || _t_gamemode==_T_GAMEMODE_GUOJI) j=Math.floor(j/10)+'.'+(j % 10);else if(_t_gamemode==_T_GAMEMODE_REACH && _t_lang!='ja') j=_t_str_for_score_card(j*100);else j=_t_str_for_score_card(j);sstr[bz]=j; k=cs*3;if(j.length>4){k+=cs*((j.length-3) >> 1);if(k>w) w=k;}y=yh+ch*2;j=_t_seat[i];if(i==2 && _t_players==3) j=_t_seat[3];if(i && _t_players==2) j=_t_seat[2];if(_t_lang=='en'){j='You.';if(i==1) j='Right.';else if(i==2) j='Center.';else if(i==3) j='Left.';}_t_centerText('SEAT_HEADINGS_'+i, x, y, w+cs, cs, '#ff0', j);bz=-1; while(++bz<=_t_game_ctr){y+=ch;str='▲'; if(_t_lang=='en') str='-';if(ssgn[bz]) _t_rightText('SCORE_'+bz+'_'+i+'_SIGN', x, y, cs, cs, '#fff', str);_t_rightText('SCORE_'+bz+'_'+i+'_VAL', x+cs, y, w, cs, '#fff', sstr[bz]);}y+=ch*1.5;str='▲'; if(_t_lang=='en') str='-';if(ssgn[bz]) _t_rightText('SCORE_TOTAL_'+i+'_SIGN', x, y, cs, cs, '#fff', str);_t_rightText('SCORE_TOTAL_'+i+'_VAL', x+cs, y, w, cs, '#fff', sstr[bz]);x+=w+cs*3;}if(_t_gamemode==_T_GAMEMODE_BOO || _t_gamemode==_T_GAMEMODE_EASTERN_BOO){y+=ch*1.5;_t_leftText('NOTE_ON_BOO_MAHJONG', xh, y, cs*32, cs, '#fff', '※半荘毎にトップから場代 3ポイントを頂いております。');}return;}function _t_str_for_score_card(score){if(score==0) return('0');var i=score.toString(10), j='', k;j=''; while(i.length>3){k=i.substring(i.length-3, i.length);i=i.substring(0, i.length-3);if(j=='') j=k; else j=k+','+j;}if(i>0){if(j=='') j=i; else j=i+','+j;}return(j);}function _t_dora_disp(){var i, j;if(_t_gamemode==_T_GAMEMODE_ARSHIAR || _t_gamemode==_T_GAMEMODE_TAIWAN || _t_gamemode==_T_GAMEMODE_PENGLI || _t_gamemode==_T_GAMEMODE_GUOJI || _t_gamemode==_T_GAMEMODE_PONJAN) return(0);if(_t_dora_disp_ctr>=_t_dora_ctr) return(0);j=_t_bipai4disp[_t_dora_jia][_t_dora_pos]=_t_bipai[_t_mopai_ptr++];i=(j & 0x3f)+1;if(i>0x38) i=0x38;else if(i==0x38) i=0x35;else if(i==0x35) i=0x31;else if((i & 15)==10) i-=9;else if(_t_players==3){if(i==0x22){i=0x29;if(_t_nukidora[3]>-1) i=_t_nukidora[3];}else if(i==_t_nukidora[3]+1) i=0x29;}_t_dora[_t_dora_disp_ctr++]=i;i=_t_players; j &= 0x7f;while(--i>=0) _t[i].zampai_table[j]--;_t_zampai_table4all[j & 0x3f]--;var k, l;k=_t_players; while(--k>=0){l=32; while((l-=2)>=0){if(_t_bipai4disp[k][l]<0) break;}if(l>-1) break;}if(k>-1){do {_t_dora_pos+=2;if(_t_dora_pos>=32){_t_dora_pos=0;if(++_t_dora_jia>=_t_players) _t_dora_jia=0;}} while(_t_bipai4disp[_t_dora_jia][_t_dora_pos]==0);}_t_bipai_disp();return(1);}function _t_uradora_disp(){var i, j;if(_t_gamemode==_T_GAMEMODE_PENGLI || _t_gamemode==_T_GAMEMODE_GUOJI || _t_gamemode==_T_GAMEMODE_PONJAN) return(0);if(!_t_reach_mahjong_rule && _t_gamemode!=_T_GAMEMODE_BEINUKI) return(0);if(_t_rule.uradora==0) return(0);if(_t_uradora_disp_ctr>=_t_dora_ctr) return(0);if(_t_rule.uradora==1 && _t_uradora_disp_ctr>0) return(0);j=_t_bipai4disp[_t_first_dora_jia][_t_first_dora_pos+1]=_t_bipai[_t_mopai_ptr++] | 0x2000;i=(j & 0x3f)+1;if(i>0x38) i=0x38;else if(i==0x38) i=0x35;else if(i==0x35) i=0x31;else if((i & 15)==10) i-=9;else if(_t_players==3){if(i==0x22){i=0x29;if(_t_nukidora[3]>-1) i=_t_nukidora[3];}else if(i==_t_nukidora[3]+1) i=0x29;}_t_uradora[_t_uradora_disp_ctr++]=i;var k, l;k=_t_players; while(--k>=0){l=31; while((l-=2)>0){if(_t_bipai4disp[k][l]<0) break;}if(l>-1) break;}if(k>-1){do {_t_first_dora_pos+=2;if(_t_first_dora_pos>=32){_t_first_dora_pos=0;if(++_t_first_dora_jia>=_t_players) _t_first_dora_jia=0;}} while(_t_bipai4disp[_t_first_dora_jia][_t_first_dora_pos]==0);}_t_bipai_disp();return(1);}function _t_lingshang_dora_disp(){var i, j, f=0;if(_t_gamemode==_T_GAMEMODE_PENGLI){if(_t_zampai_ctr<1) return(0);if(_t_lingshang_dora_ctr>2) return(0);var k, l;k=_t_players; while(--k>=0){l=_t_bipai4disp[k].length; while(--l>=0){if(_t_bipai4disp[k][l]<0) break;}if(l>-1) break;}if(k<0) return(0);do {if(!(_t_mopai_pos & 1)) ++_t_mopai_pos; else _t_mopai_pos-=3;if(i==_t_mopai_jia && j==_t_mopai_pos) return(0);if(_t_mopai_pos<0){_t_mopai_pos=30;if(--_t_mopai_jia<0) _t_mopai_jia=_t_players-1;}} while(_t_bipai4disp[_t_mopai_jia][_t_mopai_pos]==0);i=_t_bipai4disp[_t_mopai_jia][_t_mopai_pos]=_t_bipai[_t_mopai_ptr++];i=(i & 0x3f)+1; if((i & 0x0f)>9) i-=9;i &= 0x0f;_t_lingshang_dora[0]=i;_t_lingshang_dora[1]=i+0x10;_t_lingshang_dora[2]=i+0x20;_t_lingshang_dora_ctr=3;_t_bipai_disp();return(1);}if((_t_gamemode!=_T_GAMEMODE_CHIP_MAHJONG && _t_gamemode!=_T_GAMEMODE_BEINUKI) || _t_players!=3) return(0);if(!_t_rule.lingshang_dora) return(0);if(_t_lingshang_dora_ctr>=2) return(0);j=_t_bipai4disp[_t_lingshang_jia][_t_lingshang_pos]=_t_bipai[_t_mopai_ptr++];i=(j & 0x3f)+1;if(i>0x38) i=0x38;else if(i==0x38) i=0x35;else if(i==0x35) i=0x31;else if((i & 15)==10) i-=9;else if(_t_players==3){if(i==0x22){i=0x29;if(_t_nukidora[3]>-1) i=_t_nukidora[3];}else if(i==_t_nukidora[3]+1) i=0x29;}_t_lingshang_dora[_t_lingshang_dora_ctr++]=i;var k, l;k=_t_players; while(--k>=0){l=_t_bipai4disp[k].length; while(--l>=0){if(_t_bipai4disp[k][l]<0) break;}if(l>-1) break;}if(k<0) return(0);do {_t_lingshang_pos++;if(_t_lingshang_pos>=32){_t_lingshang_pos=0;if(++_t_lingshang_jia>=_t_players) _t_lingshang_jia=0;}} while(_t_bipai4disp[_t_lingshang_jia][_t_lingshang_pos]==0);_t_bipai_disp();return(1);}_t_toggle_sprite=0;function _t_toggle_sprite_disp(mode){var str='牌等の動画効果：入', pos=11, len=10;if(_t_lang.toLowerCase()!='ja'){pos=11; len=12;str='Animation Effect: On';if(_t_rule_sel['UI_noSprite']) str='Animation Effect: Off';}else {if(_t_rule_sel['UI_noSprite']) str='牌等の動画効果：切';}if(mode){setMenuItem('MENU_ANIMATEEFFECT', pos*14, len, str, '_t_toggle_sprite_sub()', 0);}else {setMenuItem('MENU_ANIMATEEFFECT', pos*14, len, str, '', 1);}}function _t_toggle_sprite_sub(){clearTimeout(_t_toggle_sprite);if(_t_movie_ctr>0){_t_toggle_sprite=setTimeout('_t_toggle_sprite_sub();', 10);return;}var i=_h5_sprite.length; while(--i>-1){if(_h5_sprite[i].id) hideSprite(_h5_sprite[i].id);}if(_t_dice_flag){i=-1; while(++i<3){if(_t_dice_dx[i]<0) break;_t_h5_dice_disp(_t_dice[i], _t_dice_dx[i], _t_dice_dy[i], 24, 32);}}_t_rule_sel['UI_noSprite']=_t_rule_sel['UI_noSprite'] ? 0 : 1;graph_noSprite=_t_rule_sel['UI_noSprite'];_t_toggle_sprite_disp(1);try {localStorage.setItem('Marguerite_FlaJong-UI_noSprite', _t_rule_sel['UI_noSprite']);}catch(e){ ; }}
