function _t_yaku_judge_arshiar(jia, mode){var i, j;var menzi=-1;var str, v;var hele_flag=hele_flag2=-1;var yaku_menzi_fu=new Array(6);var yaku_menzi=new Array(6);var yaku_shupai2=new Array(16);var yaku_shupai_fu2=new Array(18);var yaku_name=new Array(20);var yaku_fansu=new Array(20);var yaku_name_ctr=0;var yakuman_name=new Array(10);var yakuman_name_ctr=0;var fu_ctr=0;var fan_ctr2=0;var yakufan_ctr=0;var yaku_fu_guide2='';var yakufan_ctr4AI=0;_t_fu_guide='';_t_hp=-1;var yaku_shupai2=new Array(20);var mz=new Array(6);j=-1; while(++j<10) _t_y_shupai_fu[j]=-1;j=-1; while(++j<20) _t_y_shupai[j]=_t[jia].shupai[j];var noMenqianqing=0;_t_babaojia=-1;_t_hp=_t[jia].shupai[15] & 0x3f;if(_t_hp==0) _t_hp=_t[jia].shupai[14] & 0x3f;_t_shupai_move(jia);j=-1; while(++j<20) yaku_shupai2[j]=_t_y_shupai[j]=_t[jia].shupai[j];j=-1; while(++j<10) yaku_shupai_fu2[j]=_t_y_shupai_fu[j]=-1;_t_bm_yakuman_jia=-1;_t_yaku_name_ctr=0;_t_yakuman_name_ctr=0;_t_fu=0;_t_yakufan_ctr=0;_t_yaku_manguan='';_t_yakufan_result=0;_t_yaku_result_point=0;_t_shisanbuta_flag=0;_t_yaku_result_point=0;_t_yaku_result_point1=0;_t_yaku_result_point2=0;_t_yaku_dora=0;_t_yaku_pay_of_sanjia=_t_yaku_pay_of_zhuangjia=0;_t_dandiao=0;_t_chip_detail.yakibuta=_t_chip_detail.gang=_t_chip_detail.ippatsu=_t_chip_detail.uradora=_t_chip_detail.akapai=_t_chip_detail.hanapai=_t_chip_detail.yakuman=0;_t_yf_daisharin=0;_t_yakufan_ctr4AI=0;_t_hp=_t[jia].shupai[14] & 0x3f;if(_t_hp<1) _t_hp=_t[jia].shupai[15] & 0x3f;_t_common_yaku_arshiar(jia, mode);if(_t_guoshiwushuang(jia)!=0){i=-1; while(++i<_t_yaku_name_common_ctr){str=_t_yaku_name_common[i]; v=_t_yaku_fansu_common[i];_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;_t_yakufan_ctr4AI+=v;}i=-1; while(++i<_t_yakuman_name_common_ctr){str=_t_yakuman_name_common[i];_t_yakuman_name[_t_yakuman_name_ctr++]=str; _t_yakufan_ctr+=256;}_t_fu=30;str='国士無双';if(_t_lang=='en') str='Thirteen Orphans';_t_yakuman_name[_t_yakuman_name_ctr++]=str; _t_yakufan_ctr+=256;i=0x40; while(--i>=0) _t_XOO[i]=_t_OXO[i]=_t_OOX[i]=_t_OOO[i]=_t_OOOO[i]=0;}else {hele_flag=-1;if(_t_menzi1(jia)!=0){menzi=-1; while(++menzi<3){hele_flag=_t_yaku_arshiar_menziType(jia, mode);if(menzi==0){hele_flag2=hele_flag;yaku_fu_guide2=_t_fu_guide;i=16; while(--i>=0) yaku_shupai2[i]=_t_y_shupai[i];i=10; while(--i>=0) yaku_shupai_fu2[i]=_t_y_shupai_fu[i];i=20; while(--i>=0){yaku_name[i]=_t_yaku_name[i];yaku_fansu[i]=_t_yaku_fansu[i];}i=10; while(--i>=0) yakuman_name[i]=_t_yakuman_name[i];yaku_name_ctr=_t_yaku_name_ctr;yakuman_name_ctr=_t_yakuman_name_ctr;fu_ctr=_t_fu;yakufan_ctr=_t_yakufan_ctr;yakufan_ctr4AI=_t_yakufan_ctr4AI; _t_yakufan_ctr4AI=0;_t_menzi2(jia);continue;}if(hele_flag2<hele_flag){hele_flag2=hele_flag;yaku_fu_guide2=_t_fu_guide;i=16; while(--i>=0) yaku_shupai2[i]=_t_y_shupai[i];i=10; while(--i>=0) yaku_shupai_fu2[i]=_t_y_shupai_fu[i];i=20; while(--i>=0){yaku_name[i]=_t_yaku_name[i];yaku_fansu[i]=_t_yaku_fansu[i];}i=10; while(--i>=0){yakuman_name[i]=_t_yakuman_name[i];}yaku_name_ctr=_t_yaku_name_ctr;yakuman_name_ctr=_t_yakuman_name_ctr;fu_ctr=_t_fu;yakufan_ctr=_t_yakufan_ctr;yakufan_ctr4AI=_t_yakufan_ctr4AI; _t_yakufan_ctr4AI=0;}if(menzi>1) break;_t_menzi3(jia);continue;}}if(_t_rule.qiduizi && _t_qiduizi(jia)){hele_flag=_t_yaku_arshiar_qiduizi(jia, mode);if(hele_flag2<0) hele_flag2=hele_flag;}if(hele_flag2<0) return(-1);if(hele_flag2>hele_flag){_t_fu_guide=yaku_fu_guide2;i=16; while(--i>=0) _t_y_shupai[i]=yaku_shupai2[i];i=10; while(--i>=0) _t_y_shupai_fu[i]=yaku_shupai_fu2[i];i=20; while(--i>=0){_t_yaku_name[i]=yaku_name[i];_t_yaku_fansu[i]=yaku_fansu[i];}i=10; while(--i>=0) _t_yakuman_name[i]=yakuman_name[i];_t_yaku_name_ctr=yaku_name_ctr;_t_yakuman_name_ctr=yakuman_name_ctr;_t_fu=fu_ctr;_t_yakufan_ctr=yakufan_ctr;_t_yakufan_ctr4AI=yakufan_ctr4AI;}}i=_t_common_yaku_arshiar2(jia, mode, _t_hp, 0);return(i);}function _t_common_yaku_arshiar (jia, mode){var p, i, j, k, l, c=4, pcode=(_t[jia].shupai[14] || _t[jia].shupai[15]) & 0x3f;var tb=new Array(0x40);var sz= tz= wz= fp= sy=0, laotou=1, duanyao=1, green=1;var str, strE, v;_t_yaku_name_common_ctr=0;_t_yakuman_name_common_ctr=0;_t_yakufan_ctr_common=0;_t_renhe_flag=0;if(mode==0 && !_t_yixun_flag && (_t[jia].nukidora_ctr==0 || _t[jia].nukidora[0]>0x37)){str='地和'; strE='Blessing of Earth';if(!_t_started_flag){if(!_t_ronghe_flag){ str='天和'; strE='Blessing of Heaven'; }}else {if(_t_ronghe_flag) _t_renhe_flag=1;}if(_t_renhe_flag<1){if(_t_lang=='en') str=strE;_t_yakuman_name_common[_t_yakuman_name_common_ctr++]=str; _t_yakufan_ctr_common+=256;}}if(_t[jia].reach_flag!=0){str='立直'; v=1;if(_t_lang=='en') str='Called Hand';_t_yaku_name_common[_t_yaku_name_common_ctr]=str; _t_yaku_fansu_common[_t_yaku_name_common_ctr++]=v; _t_yakufan_ctr_common+=v;}if(_t[jia].menqian_flag==0){if((mode!=1 && _t_ronghe_flag==0) || mode==2){str='門前摸和'; v=1;if(_t_lang=='en') str='Fully Concealed Hand';_t_yaku_name_common[_t_yaku_name_common_ctr]=str; _t_yaku_fansu_common[_t_yaku_name_common_ctr++]=v; _t_yakufan_ctr_common+=v;}}}function _t_common_yaku_arshiar2 (jia, mode, _t_hp, ytype){var str, v, u;var i, j, k, l, m, n;var ym=0, yf;yf=_t_yakufan_ctr;if(_t_lingshang_flag!=0 && !_t_ronghe_flag){_t_yaku_fansu[_t_yaku_name_ctr]=1;str='嶺上開花'; v=1;if(_t_lang=='en') str='After a Kong';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}else if(_t_qianggang_flag!=0){_t_yaku_fansu[_t_yaku_name_ctr]=1;str='搶槓和'; v=1;if(_t_lang=='en') str='Robbing the Kong';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}else if(_t_zampai_ctr<1 && !_t_ronghe_flag){str='海底摸月'; v=1;if(_t_lang=='en') str='Under the Sea';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if(mode>-1 && ytype<1){i=16; v=0;while(--i>0){ if((_t[jia].shupai[i] & 0x40)!=0) ++v; }_t_shupai_move(jia);i=0;while(--i>=0){if(j & 0x40) ++l;if((j=_t[jia].nukidora[i])>0x37) _t_bipai2[0x38]++;else _t_bipai2[j & 0x3f]++;}i=_t[jia].fulou_ctr*5;while(--i>=0){if((j=_t[jia].fuloupai[i])==0) continue;if(j & 0x40) ++v;_t_bipai2[j & 0x3f]++;}if(v>0){str='赤牌';if(_t_lang=='en'){str='Red Tile';if(v>1) str+='s';}_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;v=0;}}if(_t_gamemode!=_T_GAMEMODE_ARSHIAR){l=0; j=-1; k=_t_dora_disp_ctr;while(++j<=k) l+=_t_bipai2[_t_dora[j]];_t_yaku_dora=l;}if(mode==2){_t_yakufan_result=_t_yakufan_ctr;if(_t_yakufan_ctr>130) i=50;else {i=Math.ceil((_t_fu-1)/10);if(_t_gamemode==_T_GAMEMODE_BOO) _t_yakufan_ctr++;if(!_t[jia].reach_flag && !_t[jia].menqian_flag && _t_gamemode==_T_GAMEMODE_BOO) _t_yakufan_ctr++;i <<= _t_yakufan_ctr;if(i>=50) i=50;}if(jia!=_t_zhuangjia) i*=4; else i*=6;if(_t_gamemode==_T_GAMEMODE_BOO){i+=_t_tsumibo_ctr*_t_tsumi_mohe;if(!_t[jia].menqian_flag && _t_rule.bm_menqian) i+=10;if(_t_yakufan_ctr>1 || !_t[jia].menqian_flag || !_t_rule.bm_yakunashi_dora) i+=_t_yaku_dora*10;}_t_yaku_result_point2=i;return(_t_yakufan_result);}if(_t_yakufan_ctr>130){_t_bm_yakuman_jia=jia;_t_yaku_manguan='役満貫'; i=50;_t_fu=0; _t_fu_guide=''; j=-1; while(++j<10) _t_y_shupai_fu[j]=-1;}else {var j=_t_yakufan_ctr;if(j>6) j=6;if(_t_fu<0){_t_fu=25; i=5; --j;}else {i=Math.ceil((_t_fu-1)/10);_t_fu=i*10;}if(_t_gamemode==_T_GAMEMODE_BOO){ ++j; _t_yakufan_ctr++; }i <<= j;if(i>=50){_t_yaku_manguan='満貫'; i=50;}}_t_yaku_pay_of_sanjia=_t_yaku_pay_of_zhuangjia=i+i;if(jia!=_t_zhuangjia){_t_yaku_pay_of_sanjia=i;i*=4;}else i*=6;_t_yaku_result_point=i;return(i);}function _t_yaku_arshiar_qiduizi(jia, mode){var a, b, c, i, j=-1, k=0, l, m, n, o, v, x, y, z;var str='';var ar=new Array(0x40);var dv=0;var tb=new Array(20);var noYaojiu=0;var noQiduizi=0;_t_yakufan_ctr=0;_t_yaku_name_ctr=0;_t_fu=0;_t_fu_guide='';_t_yakuman_name_ctr=0;_t_shupai_move(jia);if(_t[jia].fulou_ctr>0) return(-1);i=0x40; while(--i>=0){if(_t_bipai2[i] & 1) return(-1);}_t_renhe_flag=0;if(_t_gamemode==_T_GAMEMODE_ARSHIAR){if(mode==0 && !_t_yixun_flag && (_t[jia].nukidora_ctr==0 || _t[jia].nukidora[0]>0x37)){_t_renhe_flag=-1; str='地和'; strE='Blessing of Earth';if(!_t_started_flag){if(!_t_ronghe_flag){ str='天和'; strE='Blessing of Heaven'; }}else {if(_t_ronghe_flag) _t_renhe_flag=1;}if(_t_renhe_flag<1){if(_t_lang=='en') str=strE;_t_yakuman_name[_t_yakuman_name_ctr++]=str; _t_yakufan_ctr+=256;}}if(_t_renhe_flag>-1){str='七対子';if(_t_lang=='en') str='Seven Pairs';_t_fu=100;_t_yakuman_name[_t_yakuman_name_ctr++]=str;}if(!mode){i=-1; while(++i<10) _t_y_shupai_fu[i]=-1;i=20; while(--i>=0) tb[i]=_t[jia].shupai[i];tb[14]=tb[15]=0;k=0; i=0; while(++i<14){if((tb[i] & 0x3f)==_t_hp){_t_y_shupai[13]=tb[i];tb[i]=0; break;}}i=0; while(++i<20){if(tb[i]) _t_y_shupai[++k]=tb[i];}_t_y_shupai[14]=_t[jia].shupai[14];_t_y_shupai[15]=_t[jia].shupai[15];}i=_t_yakufan_ctr; j=_t_fu;if(i>256){ j=256; i=16+(i >> 8); }return(j << i);}i=-1; while(++i<_t_yaku_name_common_ctr){str=_t_yaku_name_common[i]; v=_t_yaku_fansu_common[i];_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}i=-1; while(++i<_t_yakuman_name_common_ctr){str=_t_yakuman_name_common[i];_t_yakuman_name[_t_yakuman_name_ctr++]=str; _t_yakufan_ctr+=256;}_t_fan=_t_fan_common;i=20; l=0x30; j=k=0; while(--i>=0){if((m=_t[jia].shupai[i] & 0x3f)<1) continue;if(m>0x30){ j++; k++; continue; }if(l>=0x30) l=m;if(!((m ^ l) & 0x30)) k++;}if(j>13){str='字一色';if(_t_lang=='en') str='All Honors';_t_yakuman_name[_t_yakuman_name_ctr++]=str; _t_yakufan_ctr+=256;noYaojiu=1;}else {if(k>13){if(j>0){v=2; str='混一色';if(_t_lang=='en') str='Half Flush';}else {v=4; str='清一色';if(_t_lang=='en') str='Full Flush';}_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}if(noYaojiu<1){var zipai=0, yao=0;i=20;while(--i>=0){j=_t[jia].shupai[i] & 0x3f;if(j<1 || j>0x37) continue;if(j>0x30){ yao++; zipai++; continue; }if(!((j-1) & 7)) ++yao;}if(yao>12){str='混老頭'; v=4;if(_t_lang=='en') str='All Terminals and Honours';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noQiduizi=1;}else if(yao<1){str='断'+String.fromCharCode(20040)+'九'; v=1;if(_t_lang=='en') str='All Simples';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}if(!noQiduizi){str='七対子'; v=2;if(_t_lang=='en') str='Seven Pairs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}_t_fu=-1;if(!mode){i=-1; while(++i<10) _t_y_shupai_fu[i]=-1;i=20; while(--i>=0) tb[i]=_t[jia].shupai[i];tb[14]=tb[15]=0;k=0; i=0; while(++i<14){if((tb[i] & 0x3f)==_t_hp){_t_y_shupai[13]=tb[i];tb[i]=0; break;}}i=0; while(++i<20){if(tb[i]) _t_y_shupai[++k]=tb[i];}_t_y_shupai[14]=_t[jia].shupai[14];_t_y_shupai[15]=_t[jia].shupai[15];}i=_t_yakufan_ctr-1; j=5;if(i>6){ j=256; i=16+(i >> 8); }return(j << i);}function _t_yaku_arshiar_menziType(jia, mode){var a, b, c, i, j=-1, k=0, l, m, n, o, v, x, y, z;var str='';var ar=new Array(0x40);var zt=new Array(0x40);_t_dz=0;_t_shupai_move(jia);var noDuidui=0;var noSanyuan=0;var no3Lianke=0;var no3Fengzi=0;var noQuantai=0;var tianhe=0;if(mode==0 && !_t_started_flag && !_t_ronghe_flag) tianhe=1;_t_yakufan_ctr=0;_t_yaku_name_ctr=0;_t_fu=0;_t_fu_guide='';_t_yakuman_name_ctr=0;var anke=0;var angang=0;var liangmen=-1;var gangzi=0;var qianzhang=-1;var bianzhang=-1;var dandiao=-1;var shuangpeng=-1;var yaku_menzi=[0, 0, 0, 0, 0, 0];var yaku_menzi_fu=[0, 0, 0, 0, 0, 0];i=-1; while(++i<6) yaku_menzi_fu[i]=yaku_menzi[i]=-1;j=-1; while(++j<4){if(_t_menzi[j+1]==0) break;if(_t_menzi[j]>_t_menzi[j+1]){k=_t_menzi[j]; _t_menzi[j]=_t_menzi[j+1]; _t_menzi[j+1]=k;j=-1;}}_t_fu=0;var shz1=shz2=shz3=kez1=0;j=-1; while(++j<6){if((i=_t_menzi[j])<1) break;yaku_menzi_fu[j]=0; yaku_menzi[j]=i;if(i<0x30){if(i==_t_hp && !shz1){qianzhang=j;shz1=1;continue;}if(i-1==_t_hp && !shz2){if((i & 0x0f)==8) bianzhang=j; else liangmen=j;shz2=1;continue;}if(i+1==_t_hp && !shz3){if((i & 0x0f)==2) bianzhang=j; else liangmen=j;shz3=1;continue;}continue;}if(i<0xc0){i &= 0x3f; ++anke;k=4; if(i>0x30 || !((i-1) & 7)) k=8;if(i==_t_hp){if(_t_bipai2[_t_hp]<4){shuangpeng=j;if(_t_ronghe_flag){ --anke; k >>= 1; }kez1=1;}}yaku_menzi_fu[j]=k; _t_fu+=k;continue;}k=0;if((i &= 0x3f)==_t_hp) dandiao=j;if(i>0x34 || _t_zhuangfeng[0]==i || _t_zhuangfeng[1]==i) k=2;if(_t[jia].menfeng==i) k+=2;yaku_menzi_fu[j]=k; _t_fu+=k;_t_dz=i;}i=0x40; while(--i>=0) ar[i]=0;j=-1; k=-5; i=4;while(++j<_t[jia].fulou_ctr){k+=5; l=_t[jia].fuloupai[k] & 0x3f;if(l!=(_t[jia].fuloupai[k+1] & 0x3f)){l=Math.floor(l+(_t[jia].fuloupai[k+1] & 0x3f)+(_t[jia].fuloupai[k+2] & 0x3f))/3;_t_menzi[i--]=l; ar[l]++;continue;}_t_menzi[i--]=l | 0x80; m=2;if(_t[jia].fuloupai[k+4]){ m=16; ++anke; ++gangzi; ++angang; }if(_t[jia].fuloupai[k+3]){ m=8; ++gangzi; }if(l>0x30 || !((l-1) & 7)) m+=m;_t_fu+=m; _t[jia].fulou_fu[j]=m;}i=-1; while(++i<_t_yaku_name_common_ctr){str=_t_yaku_name_common[i]; v=_t_yaku_fansu_common[i];_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}i=-1; while(++i<_t_yakuman_name_common_ctr){str=_t_yakuman_name_common[i];_t_yakuman_name[_t_yakuman_name_ctr++]=str; _t_yakufan_ctr+=256;}if(_t_fu==0 && liangmen>-1 &&        ((_t_rule.mo8pinghe && !_t[jia].menqian_flag) || _t_ronghe_flag || mode)){str='平和'; v=1;if(_t_lang=='en') str='Pinfu';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;dandiao=bianzhang=qianzhang=shuangpeng=-1; _t_dandiao=0;_t_fu_guide='門子     0符\n両門     0符\n';if(_t_ronghe_flag==0){ _t_fu_guide+='摸和\n(平和)   0符\n'; }else { _t_fu_guide+='栄和     0符\n'; }}else {_t_dandiao=0; if(dandiao>-1 && liangmen<0 && (qianzhang>-1 || bianzhang>-1)) _t_dandiao=1;if(_t_fu>99){ _t_fu_guide='門子   '+_t_fu+'符\n'; }else if(_t_fu>9){ _t_fu_guide='門子    '+_t_fu+'符\n'; }else { _t_fu_guide='門子     '+_t_fu+'符\n'; }if(dandiao>-1){ _t_fu+=2; _t_fu_guide+='単吊     2符\n'; }else if(bianzhang>-1){ _t_fu+=2; _t_fu_guide+='辺張     2符\n'; }else if(qianzhang>-1){ _t_fu+=2; _t_fu_guide+='嵌張     2符\n'; }else if(liangmen>-1){ _t_fu_guide+='両門     0符\n'; }else { _t_fu_guide+='双ポン   0符\n'; }if(_t_ronghe_flag==0){ _t_fu+=2; _t_fu_guide+='摸和     2符\n'; }else { _t_fu_guide+='栄和     0符\n'; }if(_t_fu==0){ _t_fu=10; _t_fu_guide+='喰い平和10符\n'; }}m=20; if(_t[jia].menqian_flag==0 && _t_ronghe_flag!=0) m=30;_t_fu+=m;if(_t_fu>99) _t_fu_guide='副底    '+m+'符\n'+_t_fu_guide+'\n合計   '+_t_fu+'符';else _t_fu_guide='副底    '+m+'符\n'+_t_fu_guide+'\n合計    '+_t_fu+'符';if(_t_lang=='en') _t_fu_guide='';if(!mode) yj_menzisort(jia, yaku_menzi, yaku_menzi_fu, dandiao, bianzhang, qianzhang, shuangpeng, liangmen);if(bianzhang>-1) bianzhang=_t_menzi[bianzhang];if(qianzhang>-1) qianzhang=_t_menzi[qianzhang];j=-1; while(++j<4){if(_t_menzi[j+1]==0) break;if(_t_menzi[j]>_t_menzi[j+1]){k=_t_menzi[j]; _t_menzi[j]=_t_menzi[j+1]; _t_menzi[j+1]=k;j=-1;}}z=0;if(_t[jia].fulou_ctr<1 && (i=_t_hp & 0x30)<0x30 &&    _t_bipai2[i+1]>2 && _t_bipai2[i+2]>0 && _t_bipai2[i+3]>0 && _t_bipai2[i+4]>0 && _t_bipai2[i+5]>0 && _t_bipai2[i+6]>0 && _t_bipai2[i+7]>0 && _t_bipai2[i+8]>0 && _t_bipai2[i+9]>2){str='九蓮宝燈';if(_t_lang=='en') str='Nine Gates';_t_yakuman_name[_t_yakuman_name_ctr++]=str; _t_yakufan_ctr+=256;j=-1; while(++j<20) _t_y_shupai[j]=_t[jia].shupai[j];z=1;}if(!z){i=4; j=0x30; l=0; while(--i>=0){if((k=_t_menzi[i] & 0x30)>0x20){ l++; continue; }if(j==0x30){ j=k; continue; }if(j!=k) break;}if(i<0 && j<0x30){v=1; if(_t_dz>0x30 || !((_t_dz ^ j) & 0x30)){if(l>0 || _t_dz>0x30){v=1; str='混一色';if(_t_gamemode==_T_GAMEMODE_BOO) ++v;if(_t_lang=='en') str='Half Flush';}else {v=3; str='清一色';if(_t_lang=='en') str='Full Flush';if(_t_gamemode==_T_GAMEMODE_ARSHIAR){i=_t_fu_guide.indexOf('\n合計');_t_fu_guide=_t_fu_guide.substring(0,i)+'清一色　10符\n';_t_fu+=10;if(_t_fu>99) _t_fu_guide+='\n合計   '+_t_fu+'符';else _t_fu_guide+='\n合計    '+_t_fu+'符';}else {++v;}}_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}}var dui=yao=zipai=0;i=5; while(--i>=0){j=_t_menzi[i];if(j<1) continue;if(j<0x30){if(!(j & 5)) yao++;continue;}if(j<0xc0) dui++;if((j & 0x3f)>0x30){ zipai++; yao++; continue; }if(!((j-1) & 7)) yao++;}if(zipai>4){str='字一色';if(_t_lang=='en') str='All Honors';_t_yakuman_name[_t_yakuman_name_ctr++]=str; _t_yakufan_ctr+=256;if(_t[jia].fulou_ctr==4) _t_babaojia=_t[jia].fulou_dajia[3];}else if(yao>4 && dui>3){if(zipai>0){str='混老頭'; v=1;if(_t_gamemode==_T_GAMEMODE_BOO){v=4; noDuidui=1;}if(_t_lang=='en') str='All Terminals and Honours';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}else {str='清老頭';if(_t_lang=='en') str='All Terminals';_t_yakuman_name[_t_yakuman_name_ctr++]=str; _t_yakufan_ctr+=256;noDuidui=1;if(_t[jia].fulou_ctr==4) _t_babaojia=_t[jia].fulou_dajia[3];}noQuantai=1;}if(anke>3){str='四暗刻';if(_t_lang=='en') str='All Closed Triplets';_t_yakuman_name[_t_yakuman_name_ctr++]=str; _t_yakufan_ctr+=256;noDuidui=1;}if(_t_menzi[0]>0xb0 && _t_menzi[3]<0xb5){str='四喜和';if(_t_lang=='en') str='Four Winds';_t_yakuman_name[_t_yakuman_name_ctr++]=str; _t_yakufan_ctr+=256;if(_t[jia].fulou_ctr==4) _t_babaojia=_t[jia].fulou_dajia[3];no3Fengzi=1;}else if(!noDuidui && _t_menzi[0]>0x80){str='対々和'; v=1;if(_t_gamemode==_T_GAMEMODE_BOO) ++v;if(_t_lang=='en') str='All Pungs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if(anke==3){str='三暗刻'; v=1;if(_t_gamemode==_T_GAMEMODE_BOO) ++v;if(_t_lang=='en') str='Three Concealed Pungs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if(!no3Fengzi){if(((_t_menzi[0]>0xb0 && _t_menzi[2]<0xb5) || (_t_menzi[1]>0xb0 && _t_menzi[3]<0xb5))){if(_t_dz>0x30 && _t_dz<0x35){str='四喜和';if(_t_lang=='en') str='Four Winds';_t_yakuman_name[_t_yakuman_name_ctr++]=str; _t_yakufan_ctr+=256;}}i=-1; while(++i<4){if((k=_t_menzi[i] & 0x3f)<0x30) continue;v=0;if(k==_t_zhuangfeng[0] || k==_t_zhuangfeng[1]) ++v;if(k==_t[jia].menfeng) ++v;if(v<1) continue;if(_t_lang=='en'){str='East';if(k==0x32) str='South';if(k==0x33) str='West';if(k==0x34) str='North';str+=' Wind Pung';}else {str='東';if(k==0x32) str='南';if(k==0x33) str='西';if(k==0x34) str='北';if(v>1) str+='連';str+='風';}_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}if(_t_menzi[1]>0xb4){str='大三元';if(_t_lang=='en') str='Big Three Dragons';_t_yakuman_name[_t_yakuman_name_ctr++]=str; _t_yakufan_ctr+=256;k=-5; i=-1; j=3; while(++i<_t[jia].fulou_ctr){k+=5;if((_t[jia].fuloupai[k] & 0x3f)>0x34 && --j==0) _t_babaojia=_t[jia].fulou_dajia[i];}}else {if(_t_menzi[2]>0xb4 && _t_dz>0x34){str='小三元'; v=1;if(_t_gamemode==_T_GAMEMODE_BOO){v=noSanyuan=4;}if(_t_lang=='en') str='Little Three Dragons';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if(!noSanyuan){v=1; i=-1; while(++i<4){if((k=_t_menzi[i] & 0x3f)<0x35) continue;if(_t_lang=='en'){str='Red';if(k==0x36) str='Green';if(k==0x35) str='White';str+=' Dragon Pung';}else {str='紅中';if(k==0x36) str='緑発';if(k==0x35) str='白板';}_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}}if(_t_babaojia<0){i=-1; l=0; k=-5;while(++i<_t[jia].fulou_ctr){k+=5;j=_t[jia].fuloupai[k];if(j>0x34 || j==_t_zhuangfeng[0]) ++l;if(j==_t[jia].menfeng) ++l;if(l>=4){_t_babaojia=_t[jia].fulou_dajia[i]; break;}}}if(yao<1){str='断'+String.fromCharCode(20040)+'九'; v=1;if(_t_lang=='en') str='All Simples';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}else if(!noQuantai && yao>4){v=0;if(_t_rule.yaku.quandaiyao){str='全帯'+String.fromCharCode(20040);v=1; if(_t_gamemode==_T_GAMEMODE_BOO) ++v;if(_t_lang=='en') str='Outside Hand';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}v=1; if(_t_gamemode==_T_GAMEMODE_BOO) ++v;if(((l=_t_menzi[0])+0x10==_t_menzi[1] && (l+0x20==_t_menzi[2] || l+0x20==_t_menzi[3]) && !(l & 0x30)) ||    ((((j=_t_menzi[3]) & 0x30)<0x30) && j-0x10==_t_menzi[2] && (j-0x20==(l=_t_menzi[1]) || j-0x20==(l=_t_menzi[0])))){if(l & 0x80){str='三色同刻';if(_t_lang=='en') str='Triple Pung';}else {str='三色同順';if(_t_lang=='en') str='Mixed Triple Chow';}if(_t_rule.yaku.sanshoku){_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}else if(((i=_t_menzi[0])+3==_t_menzi[1] && (i+6==_t_menzi[2] || i+6==_t_menzi[3])) ||    ((i=_t_menzi[3])-3==_t_menzi[2] && (i-6==_t_menzi[1] || i-6==_t_menzi[0]))){if(i<0x80){str='一気通貫';if(_t_lang=='en') str='Pure Straight';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;i &= 0x30;}}if((_t_menzi[0]==_t_menzi[2] ||_t_menzi[1]==_t_menzi[3])){str='一色三順';if(_t_lang=='en') str='Pure Triple Chows';if(_t_rule.yaku.yisesanshun){_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}i=_t_yakufan_ctr; j=_t_fu;if(i>256){ j=256; i=16+(i >> 8); }return(j << i);}function _t_yaku_judge_beinuki(jia, mode){var i, j;var menzi=-1;var str, v;var yaku_menzi_fu=new Array(6);var yaku_menzi=new Array(6);var yaku_shupai2=new Array(16);var yaku_shupai_fu2=new Array(18);var yaku_name=new Array(20);var yaku_fansu=new Array(20);var yaku_name_ctr=0;var yakuman_name=new Array(10);var yakuman_name_ctr=0;var fu_ctr=0;var fan_ctr2=0;var yakufan_ctr=0;var yaku_fu_guide2='';_t_fu_guide='';_t_hp=-1;var yaku_shupai2=new Array(20);var mz=new Array(6);j=-1; while(++j<10) _t_y_shupai_fu[j]=-1;j=-1; while(++j<20) _t_y_shupai[j]=_t[jia].shupai[j];var noMenqianqing=0;_t_babaojia=-1;_t_hp=_t[jia].shupai[15] & 0x3f;if(_t_hp==0) _t_hp=_t[jia].shupai[14] & 0x3f;_t_shupai_move(jia);j=-1; while(++j<20) yaku_shupai2[j]=_t_y_shupai[j]=_t[jia].shupai[j];j=-1; while(++j<10) yaku_shupai_fu2[j]=_t_y_shupai_fu[j]=-1;_t_bm_yakuman_jia=-1;_t_yaku_name_ctr=0;_t_yakuman_name_ctr=0;_t_fu=0;_t_yakufan_ctr=0;_t_yaku_manguan='';_t_yakufan_result=0;_t_yaku_result_point=0;_t_shisanbuta_flag=0;_t_yaku_result_point=0;_t_yaku_result_point1=0;_t_yaku_result_point2=0;_t_yaku_dora=0;_t_yaku_pay_of_sanjia=_t_yaku_pay_of_zhuangjia=0;_t_dandiao=0;_t_chip_detail.yakibuta=_t_chip_detail.gang=_t_chip_detail.ippatsu=_t_chip_detail.uradora=_t_chip_detail.akapai=_t_chip_detail.hanapai=_t_chip_detail.yakuman=0;_t_yf_daisharin=0;if(mode==0 && _t_yaojiu_furikiri>-1){str='幺九振切'; v=12;if(_t_lang=='en') str='Thirteen Orphans';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;_t_fu=30;i=_t_common_yaku_beinuki2(jia, mode, -1, 1);return(i);}_t_hp=_t[jia].shupai[14] & 0x3f;if(_t_hp<1) _t_hp=_t[jia].shupai[15] & 0x3f;if(_t_guoshiwushuang(jia)!=0){_t_common_yaku_beinuki(jia, mode);i=-1; while(++i<_t_yaku_name_common_ctr){str=_t_yaku_name_common[i]; v=_t_yaku_fansu_common[i];_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}str='国士無双'; v=12;if(_t_lang=='en') str='Thirteen Orphans';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;i=0x40; while(--i>=0) _t_XOO[i]=_t_OXO[i]=_t_OOX[i]=_t_OOO[i]=_t_OOOO[i]=0;i=_t_common_yaku_beinuki2(jia, mode, _t_hp, 0);return(i);}if(mode==0 && _t_shisanbuta(jia)!=0 && _t_rule.yaku.shisanbuta){str='十三不搭'; v=12;_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;i=_t_common_yaku_beinuki2(jia, mode, -1, 2);return(i);}_t_common_yaku_beinuki(jia, mode);if(_t_qiduizi(jia)){_t_yaku_beinuki_qiduizi(jia, mode);}else if(_t_menzi1(jia)!=0){menzi=-1; while(++menzi<3){_t_yaku_beinuki_menziType(jia, mode);if(menzi>1) break;if(menzi==0){yaku_fu_guide2=_t_fu_guide;i=16; while(--i>=0) yaku_shupai2[i]=_t_y_shupai[i];i=20; while(--i>=0){yaku_name[i]=_t_yaku_name[i];yaku_fansu[i]=_t_yaku_fansu[i];}yaku_name_ctr=_t_yaku_name_ctr;fu_ctr=_t_fu;yakufan_ctr=_t_yakufan_ctr;_t_menzi2(jia);continue;}if(yakufan_ctr<_t_yakufan_ctr || (yakufan_ctr==_t_yakufan_ctr && fu_ctr<_t_fu)){yaku_fu_guide2=_t_fu_guide;i=16; while(--i>=0) yaku_shupai2[i]=_t_y_shupai[i];i=10; while(--i>=0) yaku_shupai_fu2[i]=_t_y_shupai_fu[i];i=20; while(--i>=0){yaku_name[i]=_t_yaku_name[i];yaku_fansu[i]=_t_yaku_fansu[i];}yaku_name_ctr=_t_yaku_name_ctr;fu_ctr=_t_fu;yakufan_ctr=_t_yakufan_ctr;}_t_menzi3(jia);continue;}if(yakufan_ctr>_t_yakufan_ctr || (yakufan_ctr==_t_yakufan_ctr && fu_ctr>_t_fu)){_t_fu_guide=yaku_fu_guide2;i=16; while(--i>=0) _t_y_shupai[i]=yaku_shupai2[i];i=10; while(--i>=0) _t_y_shupai_fu[i]=yaku_shupai_fu2[i];i=20; while(--i>=0){_t_yaku_name[i]=yaku_name[i];_t_yaku_fansu[i]=yaku_fansu[i];}_t_yaku_name_ctr=yaku_name_ctr;_t_fu=fu_ctr;_t_yakufan_ctr=yakufan_ctr;}}else return(-1);i=_t_common_yaku_beinuki2(jia, mode, _t_hp, 0);return(i);}function _t_common_yaku_beinuki (jia, mode){var p, i, j, k, l, c=4, pcode=(_t[jia].shupai[14] || _t[jia].shupai[15]) & 0x3f;var tb=new Array(0x40);var sz= tz= wz= fp= sy=0, laotou=1, duanyao=1, green=1;var str, v;_t_yaku_name_common_ctr=0;_t_yakuman_name_common_ctr=0;_t_yakufan_ctr_common=0;_t_renhe_flag=0;if(mode==0 && !_t_yixun_flag && (_t[jia].nukidora_ctr==0 || _t[jia].nukidora[0]>0x37)){str='地和'; strE='Blessing of Earth';if(!_t_started_flag){if(!_t_ronghe_flag){ str='天和'; strE='Blessing of Heaven'; }}else {if(_t_ronghe_flag){ str='人和'; strE='Blessing of Man'; }}v=12;_t_yaku_name_common[_t_yaku_name_common_ctr]=str; _t_yaku_fansu_common[_t_yaku_name_common_ctr++]=v; _t_yakufan_ctr_common+=v;}if(_t[jia].menqian_flag==0){str='門前清'; v=1;if(_t_lang=='en') str='Concealed Hand';_t_yaku_name_common[_t_yaku_name_common_ctr]=str; _t_yaku_fansu_common[_t_yaku_name_common_ctr++]=v; _t_yakufan_ctr_common+=v;}if(_t[jia].reach_flag!=0){str='立直'; v=2;if(_t_lang=='en') str='Called Hand';_t_yaku_name_common[_t_yaku_name_common_ctr]=str; _t_yaku_fansu_common[_t_yaku_name_common_ctr++]=v; _t_yakufan_ctr_common+=v;}}function _t_common_yaku_beinuki2 (jia, mode, _t_hp, ytype){var str, v, u;var i, j, k, l, m, n;var ym=0, yf;yf=_t_yakufan_ctr;if(mode>-1 && ytype<1){i=16; v=0;while(--i>0){ if((_t[jia].shupai[i] & 0x40)!=0) ++v; }_t_shupai_move(jia);i=_t[jia].nukidora_ctr;while(--i>=0){if((j=_t[jia].nukidora[i])>0x37) _t_bipai2[0x38]++;else _t_bipai2[j & 0x3f]++;if(j & 0x40) ++l;}i=_t[jia].fulou_ctr*5;while(--i>=0){if((j=_t[jia].fuloupai[i])==0) continue;if(j & 0x40) ++v;_t_bipai2[j & 0x3f]++;}if(_t_rule.chip.akapai) _t_chip_detail.akapai=v;if(v && _t_rule.akapai_deal){str='赤牌';if(_t_lang=='en'){str='Red Tile';if(v>1) str+='s';}_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;v=0;}else v+=(i=_t[jia].nukidora_ctr);if(_t_rule.chip.hanapai) _t_chip_detail.hanapai=_t[jia].nukidora_ctr;j=-1; k=_t_dora_disp_ctr;while(++j<=k) v+=_t_bipai2[_t_dora[j]];if(mode!=2){if(_t[jia].reach_flag && _t_rule.uradora){u=0; j=-1; k=_t_uradora_disp_ctr;while(++j<=k){u+=_t_bipai2[_t_uradora[j]];}if(_t_rule.chip.uradora) _t_chip_detail.uradora=u;v+=u;}j=_t_lingshang_dora_ctr; while(--j>=0) v+=_t_bipai2[_t_lingshang_dora[j]];}_t_yaku_dora=v;if(v>0){str='ドラ';if(_t_lang=='en') str='DORA';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}if(_t[jia].liangzhuang_ctr>7 && _t_rule.yaku.balianzhuang){str='八連荘'; v=12;if(_t_lang=='en') str='More Eight Continuous Winning';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if(mode==2){yf=_t_yakufan_ctr;_t_yakufan_result=_t_yakufan_ctr;if(!_t[jia].reach_flag && !_t[jia].menqian_flag) _t_yakufan_ctr+=2;i=_t_yakufan_ctr+1;if(_t_zhuangjia==jia) ++i;if(_t_rule.wareme) i <<= 1;_t_yaku_result_point2=i+_t_tsumibo_ctr*_t_tsumi_rong;return(yf);}if(mode==0){if(_t[jia].reach_flag && _t[jia].reach_ippatsu_flag && _t_rule.chip.ippatsu) _t_chip_detail.ippatsu=1;i=16; l=0;while(--i>0){ if((_t[jia].shupai[i] & 0x40)!=0) ++l; }if(_t_rule.chip.akapai) _t_chip_detail.akapai=l;if(_t_rule.chip.hanapai) _t_chip_detail.hanapai=_t[jia].nukidora_ctr;if(_t[jia].reach_flag && _t_rule.uradora && _t_rule.chip.uradora){l=0; j=-1; k=_t_uradora_disp_ctr;while(++j<=k){l+=_t_bipai2[_t_uradora[j]];}_t_chip_detail.uradora=l;}}if(_t_yakufan_ctr==0) i=1;else {i=(++_t_yakufan_ctr);if(_t_zhuangjia==jia){++i; _t_yaku_manguan='荘家 ';}}_t_yaku_result_point=i;_t_fu=0;_t_fu_guide=''; j=-1; while(++j<10) _t_y_shupai_fu[j]=-1;_t_yaku_pay_of_sanjia=_t_yaku_pay_of_zhuangjia=i;return(i);}function _t_yaku_beinuki_qiduizi(jia, mode){var a, b, c, i, j=-1, k=0, l, m, n, o, v, x, y, z;var str='';var ar=new Array(0x40);var dv=0;var tb=new Array(20);var noYaojiu=0;_t_yakufan_ctr=0;_t_yaku_name_ctr=0;_t_fu=0;_t_fu_guide='';_t_yakuman_name_ctr=0;_t_shupai_move(jia);if(_t[jia].fulou_ctr>0) return(0);i=0x40; while(--i>=0){if(_t_bipai2[i] & 1) return(0);}i=-1; while(++i<_t_yaku_name_common_ctr){str=_t_yaku_name_common[i]; v=_t_yaku_fansu_common[i];_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}i=-1; while(++i<_t_yakuman_name_common_ctr){str=_t_yakuman_name_common[i];_t_yakuman_name[_t_yakuman_name_ctr++]=str; _t_yakufan_ctr+=256;}i=20; l=0x30; j=k=0; while(--i>=0){if((m=_t[jia].shupai[i] & 0x3f)<1) continue;if(m>0x30){ j++; k++; continue; }if(l>=0x30) l=m;if(!((m ^ l) & 0x30)) k++;}if(j>13){v=12; str='字一色';if(_t_lang=='en') str='All Honors';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;_t_yakufan_ctr4AI+=v;noYaojiu=1;}else {if(k>13 && j<1){v=6; str='清一色';if(_t_lang=='en') str='Full Flush';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}str='七対子'; v=3;if(_t_lang=='en') str='Seven Pairs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;if(!mode){i=20; while(--i>=0) tb[i]=_t[jia].shupai[i];tb[14]=tb[15]=0;k=0; i=0; while(++i<14){if((tb[i] & 0x3f)==_t_hp){_t_y_shupai[13]=tb[i];tb[i]=0; break;}}i=0; while(++i<20){if(tb[i]) _t_y_shupai[++k]=tb[i];}_t_y_shupai[14]=_t[jia].shupai[14];_t_y_shupai[15]=_t[jia].shupai[15];}return(1);}function _t_yaku_beinuki_menziType(jia, mode){var a, b, c, i, j=-1, k=0, l, m, n, o, v, x, y, z;var str='';var ar=new Array(0x40);var zt=new Array(0x40);_t_dz=0;_t_shupai_move(jia);var noDuidui=0;var no3Lianke=0;var no3Fengzi=0;var noQuantai=0;var tianhe=0;if(mode==0 && !_t_started_flag && !_t_ronghe_flag) tianhe=1;_t_yakufan_ctr=0;_t_yaku_name_ctr=0;_t_fu=0;_t_fu_guide='';_t_yakuman_name_ctr=0;var anke=0;var angang=0;var liangmen=-1;var gangzi=0;var qianzhang=-1;var bianzhang=-1;var dandiao=-1;var shuangpeng=-1;var yaku_menzi=[0, 0, 0, 0, 0, 0];var yaku_menzi_fu=[0, 0, 0, 0, 0, 0];i=-1; while(++i<6) yaku_menzi_fu[i]=yaku_menzi[i]=-1;j=-1; while(++j<4){if(_t_menzi[j+1]==0) break;if(_t_menzi[j]>_t_menzi[j+1]){k=_t_menzi[j]; _t_menzi[j]=_t_menzi[j+1]; _t_menzi[j+1]=k;j=-1;}}_t_fu=0;j=-1; while(++j<6){if((i=_t_menzi[j])<1) break;yaku_menzi_fu[j]=0; yaku_menzi[j]=i;if(i<0x30){if(i==_t_hp){ qianzhang=j; continue; }if(i-1==_t_hp){if((i & 0x0f)==8) bianzhang=j; else liangmen=j;continue;}if(i+1==_t_hp){if((i & 0x0f)==2) bianzhang=j; else liangmen=j;}continue;}if(i<0xc0){i &= 0x3f; ++anke;k=4; if(i>0x30 || !((i-1) & 7)) k=8;if(i==_t_hp){if(_t_bipai2[_t_hp]<4){shuangpeng=j; _t_sf=1;if(_t_ronghe_flag){ --anke; k >>= 1; }}}yaku_menzi_fu[j]=k; _t_fu+=k;continue;}k=0;if((i &= 0x3f)==_t_hp) dandiao=j;if(i>0x34 || _t_zhuangfeng[0]==i || _t_zhuangfeng[1]==i) k=2;if(i==_t[jia].menfeng==i) k+=2;yaku_menzi_fu[j]=k; _t_fu+=k;_t_dz=i;}i=0x40; while(--i>=0) ar[i]=0;j=-1; k=-5; i=4;while(++j<_t[jia].fulou_ctr){k+=5; l=_t[jia].fuloupai[k] & 0x3f;if(l!=(_t[jia].fuloupai[k+1] & 0x3f)){l=Math.floor(l+(_t[jia].fuloupai[k+1] & 0x3f)+(_t[jia].fuloupai[k+2] & 0x3f))/3;_t_menzi[i--]=l; ar[l]++;continue;}_t_menzi[i--]=l | 0x80; m=4;if(_t[jia].fuloupai[k+4]){ m=16; ++anke; ++gangzi; ++angang; }if(_t[jia].fuloupai[k+3]){ m=8; ++gangzi; }if(l>0x30 || !((l-1) & 7)) m+=m;_t_fu+=m; _t[jia].fulou_fu[j]=m;}i=-1; while(++i<_t_yaku_name_common_ctr){str=_t_yaku_name_common[i]; v=_t_yaku_fansu_common[i];_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}_t_fu_guide='';if(!mode) yj_menzisort(jia, yaku_menzi, yaku_menzi_fu, dandiao, bianzhang, qianzhang, shuangpeng, liangmen);if(bianzhang>-1) bianzhang=_t_menzi[bianzhang];if(qianzhang>-1) qianzhang=_t_menzi[qianzhang];j=-1; while(++j<4){if(_t_menzi[j+1]==0) break;if(_t_menzi[j]>_t_menzi[j+1]){k=_t_menzi[j]; _t_menzi[j]=_t_menzi[j+1]; _t_menzi[j+1]=k;j=-1;}}_t_dandiao=0; if(dandiao>-1 && liangmen<0 && (qianzhang>-1 || bianzhang>-1)) _t_dandiao=1;z=0;if(_t_menzi[0]>0xb0 && _t_dz>0x30){str='字一色'; v=12;if(_t_lang=='en') str='All Honors';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;z=1;}else if(_t[jia].fulou_ctr<1 && (i=_t_hp & 0x30)<0x30 &&    _t_bipai2[i+1]>2 && _t_bipai2[i+2]>0 && _t_bipai2[i+3]>0 && _t_bipai2[i+4]>0 && _t_bipai2[i+5]>0 && _t_bipai2[i+6]>0 && _t_bipai2[i+7]>0 && _t_bipai2[i+8]>0 && _t_bipai2[i+9]>2){str='九蓮宝燈'; v=12;if(_t_lang=='en') str='Nine Gates';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;if(!_t_rule.unlimited){j=-1; while(++j<20) _t_y_shupai[j]=_t[jia].shupai[j];}z=1;}else if(_t[jia].fulou_ctr<1 && (_t_hp & 0x30)==0x10 && _t_menzi[0]==_t_menzi[1] && _t_menzi[0]+3==_t_menzi[2] && _t_menzi[2]==_t_menzi[3]  && _t_dz+2==_t_menzi[0]){if(_t_rule.yaku.daisharin){str='大車輪'; v=12;if(_t_lang=='en') str='Chained Seven Pairs of Circles';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;if(!_t_rule.unlimited){j=-1; while(++j<20) _t_y_shupai[j]=_t[jia].shupai[j];}z=1;}}if(!z){i=5; k=0; while(--i>=0){if((j=_t_menzi[i])<0x30){if(j==0x03) ++k;continue;}if((j &= 0x3f)==0x36 || j==0x03 || !(j & 0x31)) ++k;}if(k>4){str='緑一色'; v=12;if(_t_lang=='en') str='All Green';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;if(_t[jia].fulou_ctr==4) _t_babaojia=_t[jia].fulou_dajia[3];z=1;}}if(!z){i=4; k=0; while(--i>=0){if((j=_t_menzi[i])<0x30){if(j==0x03) ++k;continue;}if((j &= 0x3f)==0x03 || !(j & 0x31)) ++k;}if(k>3 && _t_dz==0x37 && _t_rule.yaku.wanlusouzhoungyidianhong){str='万緑叢中一点紅'; v=12;if(_t_lang=='en') str='All Green Except Only Red Pair';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;if(_t[jia].fulou_ctr==4) _t_babaojia=_t[jia].fulou_dajia[3];z=1;}}if(!z){i=5; while(--i>=0){if((j=_t_menzi[i])<0x30) break;if((j &= 0x3f)==0x37) continue;if((j & 0x30) || j==0x03) break;if(!(j & 1)) break;}if(i<0 && _t_rule.yaku.benikujaku){str='紅孔雀'; v=12;if(_t_lang=='en') str='All Red';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;if(_t[jia].fulou_ctr==4) _t_babaojia=_t[jia].fulou_dajia[3];z=1;}}if(!z){i=5; j=0x30; l=0; while(--i>=0){if((k=_t_menzi[i] & 0x30)>0x20){ break; }if(j==0x30){ j=k; continue; }if(j!=k) break;}if(i<0 && j<0x30){if(!((_t_dz ^ j) & 0x30)){v=6; str='清一色';if(_t_lang=='en') str='Full Flush';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}}var dui=yao=zipai=0;i=5; while(--i>=0){j=_t_menzi[i];if(j<1) continue;if(j<0x30){if(!(j & 5)) yao++;continue;}if(j<0xc0) dui++;if((j & 0x3f)>0x30){ zipai++; yao++; continue; }if(!((j-1) & 7)) yao++;}if(yao>4 && dui>3 && zipai<1){str='清老頭'; v=12;if(_t_lang=='en') str='All Terminals';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noDuidui=1;}if(anke>3){str='四暗刻'; v=12;if(_t_lang=='en') str='All Closed Triplets';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noDuidui=1;}if(gangzi>3){str='四槓子'; v=12;if(_t_lang=='en') str='Four Kongs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if(_t_menzi[0]==0x91 && _t_menzi[1]==0x95 && _t_menzi[3]==0xb5 && (_t_menzi[2] & 0x3f)==_t[jia].menfeng){str='風花雪月'; v=12;if(_t_lang=='en') str='Wind, Flower, Snow & the Moon';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}else if((i=_t_menzi[0])>0x80 && (j=_t_menzi[3])<0xb0 && i+3==j){if(_t_rule.yaku.silianke){str='四連刻'; v=12;if(_t_lang=='en') str='Four Step Pung';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;no3Lianke=1;}}else if(_t_menzi[0]>0xb0 && _t_menzi[3]<0xb5){str='四喜和'; v=12;if(_t_lang=='en') str='Four Winds';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if(!no3Fengzi){if(((_t_menzi[0]>0xb0 && _t_menzi[2]<0xb5) || (_t_menzi[1]>0xb0 && _t_menzi[3]<0xb5))){if(_t_dz>0x30 && _t_dz<0x35){str='四喜和'; v=12;if(_t_lang=='en') str='Four Winds';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}}if(_t_menzi[1]>0xb4){str='大三元'; v=12;if(_t_lang=='en') str='Big Three Dragons';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;k=-5; i=-1; j=3; while(++i<_t[jia].fulou_ctr){k+=5;if((_t[jia].fuloupai[k] & 0x3f)>0x34 && --j==0) _t_babaojia=_t[jia].fulou_dajia[i];}}if(((l=_t_menzi[0])+0x10==_t_menzi[1] && (l+0x20==_t_menzi[2] || l+0x20==_t_menzi[3]) && !(l & 0x30)) ||    ((((j=_t_menzi[3]) & 0x30)<0x30) && j-0x10==_t_menzi[2] && (j-0x20==(l=_t_menzi[1]) || j-0x20==(l=_t_menzi[0])))){str='三色同刻'; v=3;if(_t_lang=='en') str='Triple Pung';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if(_t_menzi[0]==_t_menzi[3] && _t_rule.yaku.yisesishun){str='一色四順'; v=12;if(_t_lang=='en') str='Pure Quad Chows';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;if(_t[jia].fulou_ctr==4) _t_babaojia=_t[jia].fulou_dajia[3];}return(1);}_tm_hananame=new Array('春牌', '夏牌', '秋牌', '冬牌', '梅牌', '蘭牌', '菊牌', '竹牌');function _tm_yaku_judge(jia, ttype, mode){var i, j;var menzi=-1;var str, v;var yaku_menzi_fu=new Array(6);var yaku_menzi=new Array(6);var yaku_shupai2=new Array(16);var yaku_shupai_fu2=new Array(18);var yaku_name=new Array(20);var yaku_fansu=new Array(20);var yaku_name_ctr=0;var yakuman_name=new Array(10);var yakuman_name_ctr=0;var fu_ctr=0;var fan_ctr=0;var fan_ctr2=0;var yakufan_ctr=0;var yaku_fu_guide2='';var yakufan_ctr4AI=0;_t_fu_guide='';var yaku_shupai2=new Array(20);var mz=new Array(6);j=-1; while(++j<10) _t_y_shupai_fu[j]=-1;j=-1; while(++j<20) _t_y_shupai[j]=_t[jia].shupai[j];var noMenqianqing=0;_t_babaojia=-1;_t_hp=_t[jia].shupai[14] & 0x3f;if(_t_hp<1) _t_hp=_t[jia].shupai[15] & 0x3f;_t_shupai_move(jia);var tegawari2=new Array(0x40);var tegawari22=new Array(0x40);j=-1; while(++j<20) yaku_shupai2[j]=_t_y_shupai[j]=_t[jia].shupai[j];j=-1; while(++j<10) yaku_shupai_fu2[j]=_t_y_shupai_fu[j]=-1;_t_bm_yakuman_jia=-1;_t_yaku_name_ctr=0;_t_yakuman_name_ctr=0;_t_fu=0;_t_fan=0;_t_yakufan_ctr=0;_t_yaku_manguan='';_t_yakufan_result=0;_t_yaku_result_point=0;_t_yaku_result_point1=0;_t_yaku_result_point2=0;_t_shisanbuta_flag=0;_t_yaku_result_point=0;_t_yaku_dora=0;_t_yaku_pay_of_sanjia=_t_yaku_pay_of_zhuangjia=0;_t_dandiao=0;_t_chip_detail.yakibuta=_t_chip_detail.gang=_t_chip_detail.ippatsu=_t_chip_detail.uradora=_t_chip_detail.akapai=_t_chip_detail.hanapai=_t_chip_detail.yakuman=0;_t_yf_daisharin=0;_tm_hananame=new Array('春牌', '夏牌', '秋牌', '冬牌', '梅牌', '蘭牌', '菊牌', '竹牌');if(_t_lang=='en') _tm_hananame=new Array('Spring Flower Tile', 'Summer Flower Tile', 'Autumn Flower Tile', 'Winter Flower Tile', 'Plum Flower Tile', 'Orchid Flower Tile', 'Chrysanthemum Flower Tile', 'Bamboo Flower Tile');if(ttype==3){str='八仙過海'; v=8;if(_t_lang=='en') str='Eight Flower Tiles Belonging';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if(_t_menzi1(jia)!=0){_t_common_yaku_taiwan(jia, mode);menzi=-1; while(++menzi<2){_t_yaku_taiwan_menziType(jia, mode, ttype);if(menzi>1) break;if(menzi==0){i=16; while(--i>=0) yaku_shupai2[i]=_t_y_shupai[i];i=20; while(--i>=0){yaku_name[i]=_t_yaku_name[i];yaku_fansu[i]=_t_yaku_fansu[i];}yaku_name_ctr=_t_yaku_name_ctr;yakuman_name_ctr=_t_yakuman_name_ctr;yakufan_ctr=_t_yakufan_ctr;_t_menzi3(jia);continue;}}if(yakufan_ctr>_t_yakufan_ctr){i=16; while(--i>=0) _t_y_shupai[i]=yaku_shupai2[i];i=20; while(--i>=0){_t_yaku_name[i]=yaku_name[i];_t_yaku_fansu[i]=yaku_fansu[i];}_t_yaku_name_ctr=yaku_name_ctr;_t_yakuman_name_ctr=yakuman_name_ctr;_t_yakufan_ctr=yakufan_ctr;}}else if(ttype!=0){i=_t_yakufan_ctr;i*=_tm_yakuRate;i+=_tm_basePoint;_t_yaku_result_point=i;return(i);}else return(-1);i=_t_common_yaku_taiwan2(jia, mode, _t_hp);return(i);}function _t_common_yaku_taiwan (jia, mode){var p, i, j, k, l, c=4, pcode=(_t[jia].shupai[14] || _t[jia].shupai[15]) & 0x3f;var tb=new Array(0x40);var sz= tz= wz= fp= sy=0, laotou=1, duanyao=1, green=1;var str, v;_t_yaku_name_common_ctr=0;_t_yakuman_name_common_ctr=0;_t_fan_common=0;_t_yakufan_ctr_common=0;_t_renhe_flag=0;if(mode==0 && !_t_yixun_flag && (_t[jia].nukidora_ctr==0 || _t[jia].nukidora[0]>0x37)){str='地胡'; strE='Blessing of Earth';if(!_t_started_flag){if(!_t_ronghe_flag){ str='天胡'; strE='Blessing of Heaven'; }}else {if(_t_ronghe_flag){ str='人胡'; strE='Blessing of Man'; }}if(_t_lang=='en') str=strE;_t_yaku_name_common[_t_yaku_name_common_ctr]=str; _t_yaku_fansu_common[_t_yaku_name_common_ctr++]=16; _t_yakufan_ctr_common+=v;}else {if(_t[jia].reach_flag!=0){str='天聴'; v=8;if(_t_zhuangjia!=jia){ str='地聴'; v=4; }if(_t_lang=='en'){str='Declaration of Winning Hand';}_t_yaku_name_common[_t_yaku_name_common_ctr]=str; _t_yaku_fansu_common[_t_yaku_name_common_ctr++]=v; _t_yakufan_ctr_common+=v;}else if(_t[jia].menqian_flag==0){str='門清'; v=1;if(_t_lang=='en') str='No Melding';_t_yaku_name_common[_t_yaku_name_common_ctr]=str; _t_yaku_fansu_common[_t_yaku_name_common_ctr++]=v; _t_yakufan_ctr_common+=v;if((mode!=1 && _t_ronghe_flag==0) || mode==2){str='不求'; v=1;if(_t_lang=='en') str='Self Tiles Only';_t_yaku_name_common[_t_yaku_name_common_ctr]=str; _t_yaku_fansu_common[_t_yaku_name_common_ctr++]=v; _t_yakufan_ctr_common+=v;}}if((mode!=1 && _t_ronghe_flag==0) || mode==2){if(_t[jia].fulou_ctr>4 && _t[jia].fuloupai[4]<1 && _t[jia].fuloupai[4+5]<1 && _t[jia].fuloupai[4+10]<1 && _t[jia].fuloupai[4+15]<1 && _t[jia].fuloupai[4+20]<1){str='半求'; v=1;if(_t_lang=='en') str='Melded Hand except a Pair';_t_yaku_name_common[_t_yaku_name_common_ctr]=str; _t_yaku_fansu_common[_t_yaku_name_common_ctr++]=v; _t_yakufan_ctr_common+=v;}str='自摸'; v=1;if(_t_lang=='en') str='Completion by Draw';_t_yaku_name_common[_t_yaku_name_common_ctr]=str; _t_yaku_fansu_common[_t_yaku_name_common_ctr++]=v; _t_yakufan_ctr_common+=v;}else if(_t[jia].fulou_ctr>4 && _t[jia].fuloupai[4]<1 && _t[jia].fuloupai[4+5]<1 && _t[jia].fuloupai[4+10]<1 && _t[jia].fuloupai[4+15]<1 && _t[jia].fuloupai[4+20]<1){str='全求'; v=2;if(_t_lang=='en') str='Fully Melded Hand';_t_yaku_name_common[_t_yaku_name_common_ctr]=str; _t_yaku_fansu_common[_t_yaku_name_common_ctr++]=v; _t_yakufan_ctr_common+=v;}}}function _t_common_yaku_taiwan2 (jia, mode, _t_hp){var str, v, u;var i, j, k, l, m, n;var ym=0, yf;yf=_t_yakufan_ctr;if(_t_lingshang_flag!=0 && !_t_ronghe_flag){_t_yaku_fansu[_t_yaku_name_ctr]=1;str='槓上開花'; v=1;if(_t_lang=='en') str='Out with Replacement Tile';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}else if(_t_qianggang_flag!=0){_t_yaku_fansu[_t_yaku_name_ctr]=1;str='搶槓胡'; v=1;if(_t_lang=='en') str='Robbing The Kong';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}else if(_t_zampai_ctr<1 && !_t_ronghe_flag){str='海底摸月'; v=1;if(_t_lang=='en') str='Last Tile Draw';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if(_t_zampai_ctr<1 && _t_ronghe_flag){str='河底撈魚'; v=1;if(_t_lang=='en') str='Last Tile Claim';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}i=_t_yakufan_ctr;i*=_tm_yakuRate;i+=_tm_basePoint;_t_yaku_result_point=i;return(i);}function _yj_menzisort_taiwan(jia, yaku_menzi, dandiao, bianzhang, qianzhang, shuangpeng, liangmen){var i, j, k, l, m;var yaku_shupai_buff=new Array(20);j=0; while(++j<20){_t_y_shupai[j]=0;if(j>13 && j<17) continue;yaku_shupai_buff[j]=_t[jia].shupai[j];}_t_y_shupai[j]=yaku_shupai_buff[0]=0;if((k=dandiao)<0 && (k=bianzhang)<0 && (k=qianzhang)<0 && (k=liangmen)<0) k=shuangpeng;var n1=_t[jia].fulou_ctr*3;var lim=6-_t[jia].fulou_ctr;i=-1; while(++i<lim){if(i==k) continue;j=yaku_menzi[i];if(j<=0) break;if(j<0x40){j--; l=3;while(--l>=0){m=0;while(++m<20){if((yaku_shupai_buff[m] & 0x3f)==j){_t_y_shupai[_tm_suff[n1++]]=yaku_shupai_buff[m];yaku_shupai_buff[m]=0;break;}}++j;}continue;}l=3;if(j>=0xc0) --l;j &= 0x3f; while(--l>=0){m=0; while(++m<20){if((yaku_shupai_buff[m] & 0x3f)==j){_t_y_shupai[_tm_suff[n1++]]=yaku_shupai_buff[m];yaku_shupai_buff[m]=0;break;}}}}m=0; while(++m<20){if((yaku_shupai_buff[m] & 0x3f)>0) _t_y_shupai[_tm_suff[n1++]]=yaku_shupai_buff[m];}_t_y_shupai_fu[0]=-1;_t_y_shupai[14]=_t[jia].shupai[14];_t_y_shupai[15]=_t[jia].shupai[15];}function _t_yaku_taiwan_menziType(jia, mode, ttype){var a, b, c, i, j=-1, k=0, l, m, n, o, _t_hp, v, x, y, z;var str='';var ar=new Array(0x40);var zt=new Array(0x40);_t_dz=0;_t_shupai_move(jia);var noDuidui=0;var no3Lianke=0;var no3Fengzi=0;var noQuantai=0;var tianhe=0;if(mode==0 && !_t_started_flag && !_t_ronghe_flag) tianhe=1;_t_yakufan_ctr=0;_t_yaku_name_ctr=0;_t_fu=0;_t_fu_guide='';_t_yakuman_name_ctr=0;var anke=0;var angang=0;var liangmen=-1;var gangzi=0;var qianzhang=-1;var bianzhang=-1;var dandiao=-1;var shuangpeng=-1;var yaku_menzi=[0, 0, 0, 0, 0, 0];var yaku_menzi_fu=[0, 0, 0, 0, 0, 0];_t_hp=(_t[jia].shupai[14] || _t[jia].shupai[15]) & 0x3f;i=-1; while(++i<6) yaku_menzi_fu[i]=yaku_menzi[i]=-1;j=-1; while(++j<5){if(_t_menzi[j+1]==0) break;if(_t_menzi[j]>_t_menzi[j+1]){k=_t_menzi[j]; _t_menzi[j]=_t_menzi[j+1]; _t_menzi[j+1]=k;j=-1;}}j=-1; while(++j<6){if((i=_t_menzi[j])<1) break;yaku_menzi_fu[j]=0; yaku_menzi[j]=i;if(i<0x30){if(i==_t_hp){ qianzhang=j; continue; }if(i-1==_t_hp){if((i & 0x0f)==8) bianzhang=j; else liangmen=j;continue;}if(i+1==_t_hp){if((i & 0x0f)==2) bianzhang=j; else liangmen=j;}continue;}if(i<0xc0){i &= 0x3f; ++anke;if(i==_t_hp){if(_t_bipai2[_t_hp]<4){shuangpeng=j;if(_t_ronghe_flag) --anke;}}continue;}k=0;if((i &= 0x3f)==_t_hp) dandiao=j;if(i>0x34 || _t_zhuangfeng[0]==i || _t_zhuangfeng[1]==i) k=2;if(i==_t[jia].menfeng==i) k+=2;_t_dz=i;}i=0x40; while(--i>=0) ar[i]=0;j=-1; k=-5; i=5;while(++j<_t[jia].fulou_ctr){k+=5; l=_t[jia].fuloupai[k] & 0x3f;if(l!=(_t[jia].fuloupai[k+1] & 0x3f)){l=Math.floor(l+(_t[jia].fuloupai[k+1] & 0x3f)+(_t[jia].fuloupai[k+2] & 0x3f))/3;_t_menzi[i--]=l; ar[l]++;continue;}_t_menzi[i--]=l | 0x80;if(_t[jia].fuloupai[k+4]){ ++anke; ++gangzi; ++angang; }if(_t[jia].fuloupai[k+3]){ ++gangzi; }}i=-1; while(++i<_t_yaku_name_common_ctr){str=_t_yaku_name_common[i]; v=_t_yaku_fansu_common[i];_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}_t_fan=_t_fan_common;i=6; while(--i>=0){if(_t_menzi[i]>0x80 && _t_menzi[i]<0xc0) break;}if(i<0 && _t_dz<0x30 && liangmen>-1 && _t[jia].nukidora_ctr<1 && (_t_ronghe_flag || mode)){str='平胡'; v=2;if(_t_lang=='en') str='Simple Sequence Hand';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;dandiao=bianzhang=qianzhang=shuangpeng=-1;_t_dandiao=0;}else {_t_dandiao=0; if(dandiao>-1 && liangmen<0 && (qianzhang>-1 || bianzhang>-1)) _t_dandiao=1;if(mode!=2 && (dandiao>-1 || bianzhang>-1 || qianzhang>-1)){str='独聴'; v=1;if(_t_lang=='en') str='Single, Edge, or Closed Wait';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}if(!mode) _yj_menzisort_taiwan(jia, yaku_menzi, dandiao, bianzhang, qianzhang, shuangpeng, liangmen);if(bianzhang>-1) bianzhang=_t_menzi[bianzhang];if(qianzhang>-1) qianzhang=_t_menzi[qianzhang];j=-1; while(++j<5){if(_t_menzi[j+1]==0) break;if(_t_menzi[j]>_t_menzi[j+1]){k=_t_menzi[j]; _t_menzi[j]=_t_menzi[j+1]; _t_menzi[j+1]=k;j=-1;}}i=5; j=0x30; l=0; while(--i>=0){if((k=_t_menzi[i] & 0x30)>0x20){ l++; continue; }if(j==0x30){ j=k; continue; }if(j!=k) break;}if(i<0 && j<0x30){v=1; if(_t_dz>0x30 || !((_t_dz ^ j) & 0x30)){if(l>0 || _t_dz>0x30){v=4; str='混一色';if(_t_lang=='en') str='Half Flush';}else {v=8; str='清一色';if(_t_lang=='en') str='Full Flush';}_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}var zipai=0;i=5; while(--i>=0){j=_t_menzi[i];if((j & 0x3f)>0x30) zipai++;}if(_t_menzi[0]>0xb0 && _t_dz>0x30){str='字一色'; v=8;if(_t_lang=='en') str='All Honors';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;if(_t[jia].fulou_ctr==4) _t_babaojia=_t[jia].fulou_dajia[3];}if(anke>4){str='五暗刻'; v=8;if(_t_lang=='en') str='Five Concealed Pungs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noDuidui=1;}if((_t_menzi[0]>0xb0 && _t_menzi[3]<0xb5) || (_t_menzi[1]>0xb0 && _t_menzi[4]<0xb5)){str='大四喜'; v=16;if(_t_lang=='en') str='Big Four Winds';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;if(_t[jia].fulou_ctr==4) _t_babaojia=_t[jia].fulou_dajia[3];no3Fengzi=1;}else if(!noDuidui && _t_menzi[0]>0x80){str=String.fromCharCode(30896)+'々胡'; v=4;if(_t_lang=='en') str='All Pungs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if(anke==4){str='四暗刻'; v=5;if(_t_lang=='en') str='Four Concealed Pungs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}else if(anke==3){str='三暗刻'; v=2;if(_t_lang=='en') str='Three Concealed Pungs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if(!no3Fengzi){if(((_t_menzi[0]>0xb0 && _t_menzi[2]<0xb5) || (_t_menzi[1]>0xb0 && _t_menzi[3]<0xb5) || (_t_menzi[2]>0xb0 && _t_menzi[4]<0xb5))){if(_t_dz>0x30 && _t_dz<0x35){str='小四喜'; v=8;if(_t_lang=='en') str='Little Four Winds';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}i=5; while(--i>-1){if((k=_t_menzi[i] & 0x3f)<0x30) continue;var v=0;if(k==_t_zhuangfeng[0]) ++v;if(k==_t[jia].menfeng) ++v;if(v<1) continue;if(_t_lang=='en'){str='East';if(k==0x32) str='South';else if(k==0x33) str='West';else if(k==0x34) str='North';str+=' Wind';}else {str='東';if(k==0x32) str='南';else if(k==0x33) str='西';else if(k==0x34) str='北';if(_t_zhuangfeng[0]==_t[jia].menfeng) str+='連風';else str+='風';}_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}if(_t_menzi[2]>0xb4){str='大三元'; v=8;if(_t_lang=='en') str='Big Three Dragons';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;k=-5; i=-1; j=3; while(++i<_t[jia].fulou_ctr){k+=5;if((_t[jia].fuloupai[k] & 0x3f)>0x34 && --j==0) _t_babaojia=_t[jia].fulou_dajia[i];}}else if(_t_menzi[3]>0xb4 && _t_dz>0x34){str='小三元'; v=4;if(_t_lang=='en') str='Little Three Dragons';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}else {v=1; i=-1; while(++i<5){if((k=_t_menzi[i] & 0x3f)<0x35) continue;if(_t_lang=='en'){str='Red';if(k==0x36) str='Green';if(k==0x37) str='White';str+=' Dragon Pung';}else {str='紅中';if(k==0x36) str='緑発';if(k==0x37) str='白板';}_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}if(ttype){str='八仙過海'; v=8;if(_t_lang=='en') str='Eight Flower Tiles Belonging';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}else {i=0x37; l=0; m=0; v=1; while(++i<0x40){j=(i & 3)+0x31; k=0;if(_t[jia].menfeng==j) k++;j=_t[jia].nukidora_ctr; while(--j>=0){if(_t[jia].nukidora[j]==i){if(k>0){str=_tm_hananame[i-0x38]; v=k;_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}l++;break;}}if(i==0x3b || i==0x3f){if(l==4) m++;l=0;}}if(m>0){str='花槓'; v=2*m;if(_t_lang=='en'){str='A Set of Four Flower Tiles';if(m>1) str='Sets of Four Flower Tiles';}_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}return(1);}
