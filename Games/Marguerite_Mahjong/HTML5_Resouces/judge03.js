_gm_yj_noMenqianqing=0;function _gm_yaku_judge(jia, mode, dpai){var i, j;var menzi=-1;var str, v;var yaku_name=new Array(20);var yaku_fansu=new Array(20);var yaku_name_ctr=0;var yakufan_ctr=0;var helepai=0;var helepai_ctr=0;var yakufan_ctr4AI=0;_t_fu_guide='';var noMohe=0;_gm_yj_noMenqianqing=0;_t_hp=_t[jia].shupai[14] & 0x3f;if(_t_hp<1) _t_hp=_t[jia].shupai[15] & 0x3f;var yaku_shupai2=new Array(20);var mz=new Array(6);j=-1; while(++j<10) _t_y_shupai_fu[j]=-1;j=-1; while(++j<20) _t_y_shupai[j]=_t[jia].shupai[j];var noMenqianqing=0;_t_babaojia=-1;helepai=_t[jia].shupai[15] & 0x3f;if(helepai==0) helepai=_t[jia].shupai[14] & 0x3f;_t_shupai_move(jia); helepai_ctr=_t_bipai2[helepai];_t_yaku_name_ctr=0;_t_yakuman_name_ctr=0;_t_fu=0;_t_fan=0;_t_yakufan_ctr=0;_t_yaku_manguan='';_t_yakufan_result=0;_t_yaku_result_point=0;_t_yaku_result_point1=0;_t_yaku_result_point2=0;_t_shisanbuta_flag=0;_t_yaku_result_point=0;_t_yaku_dora_ctr=0;_t_yaku_pay_of_sanjia=_t_yaku_pay_of_zhuangjia=0;_t_dandiao=0;_t_chip_detail.yakibuta=_t_chip_detail.gang=_t_chip_detail.ippatsu=_t_chip_detail.uradora=_t_chip_detail.akapai=_t_chip_detail.hanapai=_t_chip_detail.yakuman=0;var ytcount=0;_gm_common(jia, mode, dpai);if(mode<3){if(_t_guoshiwushuang(jia)){str='十三'+String.fromCharCode(20040);if(_t_lang=='en') str='Thirteen Orphans';v=88; _t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;_gm_yj_noMenqianqing=1;i=0x40; while(--i>=0) _t_XOO[i]=_t_OXO[i]=_t_OOX[i]=_t_OOO[i]=_t_OOOO[i]=0;if(_t_zampai_ctr<1 && !_t_ronghe_flag){v=8; str='妙手回春';if(_t_lang=='en') str='Last Tile Draw';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noMohe++;}else if(_t_zampai_ctr<1){v=8; str='海底撈月';if(_t_lang=='en') str='Last Tile Claim';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noMohe++;}if(_t_qianggang_flag){v=8; str='搶槓和';if(_t_lang=='en') str='Robbing The Kong';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if(!_t[jia].menqian_flag && !_t_ronghe_flag && !noMohe){v=4; str='不求人';if(_t_lang=='en') str='Fully Concealed';if(noMohe){v=2; str='門前清';if(_t_lang=='en') str='Concealed';}_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}i=_gm_common2(jia, mode);return(i);}if(_gm_bukao(jia, mode)){i=_gm_common2(jia, mode);return(i);}if(_gm_zehelong(jia, mode)){i=_gm_common2(jia, mode);return(i);}}if(_gm_qiduizi(jia, mode)){noMenqianqing=_gm_yj_noMenqianqing;i=16; while(--i>=0) yaku_shupai2[i]=_t_y_shupai[i];i=20; while(--i>=0){yaku_name[i]=_t_yaku_name[i];yaku_fansu[i]=_t_yaku_fansu[i];}yaku_name_ctr=_t_yaku_name_ctr;yakufan_ctr=_t_yakufan_ctr;ytcount++;}if(_t_menzi1(jia)!=0){menzi=-1; while(++menzi<3){_gm_yaku_menziType(jia, mode);if(menzi>1) break;if(ytcount){if(yakufan_ctr<_t_yakufan_ctr){noMenqianqing=_gm_yj_noMenqianqing;if(mode<2){i=16; while(--i>=0) yaku_shupai2[i]=_t_y_shupai[i];i=20; while(--i>=0){yaku_name[i]=_t_yaku_name[i];yaku_fansu[i]=_t_yaku_fansu[i];}yaku_name_ctr=_t_yaku_name_ctr;}yakufan_ctr=_t_yakufan_ctr;}if(mode>1){_t_menzi3(jia); menzi=1; continue;}if(menzi==0) _t_menzi2(jia);else _t_menzi3(jia);continue;}noMenqianqing=_gm_yj_noMenqianqing;if(mode<2){i=16; while(--i>=0) yaku_shupai2[i]=_t_y_shupai[i];i=20; while(--i>=0){yaku_name[i]=_t_yaku_name[i];yaku_fansu[i]=_t_yaku_fansu[i];}yaku_name_ctr=_t_yaku_name_ctr;}yakufan_ctr=_t_yakufan_ctr;ytcount++;if(mode>1){_t_menzi3(jia); menzi=1; continue;}_t_menzi2(jia);}}else if(ytcount<1) return(-1);if(yakufan_ctr>_t_yakufan_ctr){_gm_yj_noMenqianqing=noMenqianqing;if(mode<2){i=16; while(--i>=0) _t_y_shupai[i]=yaku_shupai2[i];i=20; while(--i>=0){_t_yaku_name[i]=yaku_name[i];_t_yaku_fansu[i]=yaku_fansu[i];}_t_yaku_name_ctr=yaku_name_ctr;}_t_yakufan_ctr=yakufan_ctr;}i=_gm_common2(jia, mode);return(i);}function _gm_common (jia, mode, dpai){var p, i, j, k, l, c=4, pcode=(_t[jia].shupai[14] || _t[jia].shupai[15]) & 0x3f;var tb=new Array(0x40);var sz= tz= wz= fp= sy=0, laotou=1, duanyao=1, green=1;var str, v;_t_yaku_name_common_ctr=0;_t_yakuman_name_common_ctr=0;_t_fan_common=0;_t_yakufan_ctr_common=0;if(!_t_qianggang_flag){c=4; p=_t_players; while(--p>=0){i=_t[p].fulou_ctr*5;while(--i>=0){if((_t[p].fuloupai[i] & 0x3f)==pcode) c--;}i=_t[p].fusipai_ctr;while(--i>=0){j=_t[p].fusipai2[i];if(j<0 || (j & 0x200)) continue;if((j & 0x3f)==pcode) c--;}}if((dpai & 0x3f)==pcode) c--;if((c<1 && _t_ronghe_flag) || (c<2 && (!_t_ronghe_flag || mode==2))){v=4; str='和絶張';if(_t_lang=='en') str='Last Tile';_t_yaku_name_common[_t_yaku_name_common_ctr]=str; _t_yaku_fansu_common[_t_yaku_name_common_ctr++]=v; _t_yakufan_ctr_common+=v;}}if((i=_t[jia].nukidora_ctr)>0){_t_yakufan_ctr_common+=i;_t_fan_common+=i;}}function _gm_common2 (jia, mode){var str, v;var i, j, k;if(_t_yakufan_ctr-_t_fan<8) return(0);if(!mode){i=-1; while(++i<_t_yaku_name_ctr-1){if((v=_t_yaku_fansu[i])<=_t_yaku_fansu[i+1]) continue;_t_yaku_fansu[i]=_t_yaku_fansu[i+1]; _t_yaku_fansu[i+1]=v;str=_t_yaku_name[i]; _t_yaku_name[i]=_t_yaku_name[i+1]; _t_yaku_name[i+1]=str;i=-1;}}if((v=_t[jia].nukidora_ctr)>0){str='花牌';if(_t_lang=='en'){str='Flower Tiles'; if(v>0) str+='s';}_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v;}_t_yaku_result_point=_t_yakufan_ctr;_t_fu=0;_t_fu_guide=''; j=-1; while(++j<10) _t_y_shupai_fu[j]=-1;_t_yaku_pay_of_sanjia=_t_yaku_pay_of_zhuangjia=_t_yakufan_ctr;return(_t_yakufan_ctr);}function _gm_zehelong(jia, mode){var i, j, k, l, m=-1, n=3, p;var mn=-1;var yaku_shupai_buff=new Array(20);var ptn=0;var str, v;var noWuzi=0;var noMohe=0;if(_t_gamemode!=_T_GAMEMODE_GUOJI) return(0);if(_t[jia].fulou_ctr>1) return(0);_t_shupai_move(jia);if(_t_bipai2[0x01]>0 && _t_bipai2[0x04]>0 && _t_bipai2[0x07]>0){_t_bipai2[0x01]--; _t_bipai2[0x04]--; _t_bipai2[0x07]--;if(_t_bipai2[0x12]>0 && _t_bipai2[0x15]>0 && _t_bipai2[0x18]>0){_t_bipai2[0x12]--; _t_bipai2[0x15]--; _t_bipai2[0x18]--;if(_t_bipai2[0x23]<1 || _t_bipai2[0x26]<1 || _t_bipai2[0x29]<1) return(0);_t_bipai2[0x23]--; _t_bipai2[0x26]--; _t_bipai2[0x29]--; ptn=0x012;}else if(_t_bipai2[0x13]>0 && _t_bipai2[0x16]>0 && _t_bipai2[0x19]>0){_t_bipai2[0x13]--; _t_bipai2[0x16]--; _t_bipai2[0x19]--;if(_t_bipai2[0x22]<1 || _t_bipai2[0x25]<1 || _t_bipai2[0x28]<1) return(0);_t_bipai2[0x22]--; _t_bipai2[0x25]--; _t_bipai2[0x28]--; ptn=0x021;}else return(0);}else if(_t_bipai2[0x02]>0 && _t_bipai2[0x05]>0 && _t_bipai2[0x08]>0){_t_bipai2[0x02]--; _t_bipai2[0x05]--; _t_bipai2[0x08]--;if(_t_bipai2[0x11]>0 && _t_bipai2[0x14]>0 && _t_bipai2[0x17]>0){_t_bipai2[0x11]--; _t_bipai2[0x14]--; _t_bipai2[0x17]--;if(_t_bipai2[0x23]<1 || _t_bipai2[0x26]<1 || _t_bipai2[0x29]<1) return(0);_t_bipai2[0x23]--; _t_bipai2[0x26]--; _t_bipai2[0x29]--; ptn=0x102;}else if(_t_bipai2[0x13]>0 && _t_bipai2[0x16]>0 && _t_bipai2[0x19]>0){_t_bipai2[0x13]--; _t_bipai2[0x16]--; _t_bipai2[0x19]--;if(_t_bipai2[0x21]<1 || _t_bipai2[0x24]<1 || _t_bipai2[0x27]<1) return(0);_t_bipai2[0x21]--; _t_bipai2[0x24]--; _t_bipai2[0x27]--; ptn=0x201;}else return(0);}else if(_t_bipai2[0x03]>0 && _t_bipai2[0x06]>0 && _t_bipai2[0x09]>0){_t_bipai2[0x03]--; _t_bipai2[0x06]--; _t_bipai2[0x09]--;if(_t_bipai2[0x11]>0 && _t_bipai2[0x14]>0 && _t_bipai2[0x17]>0){_t_bipai2[0x11]--; _t_bipai2[0x14]--; _t_bipai2[0x17]--;if(_t_bipai2[0x22]<1 || _t_bipai2[0x25]<1 || _t_bipai2[0x28]<1) return(0);_t_bipai2[0x22]--; _t_bipai2[0x25]--; _t_bipai2[0x28]--; ptn=0x120;}else if(_t_bipai2[0x12]>0 && _t_bipai2[0x15]>0 && _t_bipai2[0x18]>0){_t_bipai2[0x12]--; _t_bipai2[0x15]--; _t_bipai2[0x18]--;if(_t_bipai2[0x21]<1 || _t_bipai2[0x24]<1 || _t_bipai2[0x27]<1) return(0);_t_bipai2[0x21]--; _t_bipai2[0x24]--; _t_bipai2[0x27]--; ptn=0x210;}else return(0);}else return(0);_t_menzi[0]=_t_menzi[1]=_t_menzi[2]=_t_menzi[3]=_t_menzi[4]=0; n=0;if(_t[jia].fulou_ctr<1){mn=-1; i=0; while(++i<0x28){if(_t_bipai2[i]<1 || _t_bipai2[i+1]<1 || _t_bipai2[i+2]<1) continue;if(_t_bipai2[i]>1 && _t_bipai2[i+3]>0) continue;_t_bipai2[i]--; _t_bipai2[i+1]--; _t_bipai2[i+2]--;_t_menzi[n++]=mn=i+1;break;}if(mn<0){i=0x38; while(--i>0){if(_t_bipai2[i]==3){_t_bipai2[i]=0; _t_menzi[n++]=mn=i | 0x80;break;}}}if(mn<0) return(0);}_t_dz=0x38; while(--_t_dz>0){if(_t_bipai2[_t_dz]==2){_t_menzi[n++]=_t_dz | 0xc0;break;}}if(_t_dz<1) return(0);if(mode<0) return(1);_t_yaku_name_ctr=0;_t_fu=0;_t_yakuman_name_ctr=0;_t_fan=_t_fan_common;_t_yakufan_ctr=_t_yakufan_ctr_common;i=-1; while(++i<_t_yaku_name_common_ctr){v=_t_yaku_fansu_common[i]; _t_yaku_fansu[_t_yaku_name_ctr]=v;str=_t_yaku_name_common[i]; _t_yaku_name[_t_yaku_name_ctr++]=str;}if(!mode){var ttype=-1;if(_t_hp<0x30){switch ((_t_hp & 0x0f) % 3){case 1:
j=(ptn >> 4) & 0x30;if(!((_t_hp ^ j) & 0x30)) ttype=0x1010;break;case 2:
j=ptn & 0x30;if(!((_t_hp ^ j) & 0x30)) ttype=0x1020;break;case 0:
j=(ptn << 4) & 0x30;if(!((_t_hp ^ j) & 0x30)) ttype=0x1030;break;}}if(ttype<0){if(_t[jia].fulou_ctr>0 || _t_dz==_t_hp) ttype=n-1;else if(mn<0x30 && Math.abs(mn-_t_hp)<2) ttype=0;else { ttype=0;  }}j=-1; while(++j<20){_t_y_shupai[j]=0;yaku_shupai_buff[j]=_t[jia].shupai[j];}yaku_shupai_buff[0]=yaku_shupai_buff[14]=yaku_shupai_buff[15]=0;j=-1; while(++j<13){if(yaku_shupai_buff[j]>yaku_shupai_buff[j+1]){i=yaku_shupai_buff[j]; yaku_shupai_buff[j]=yaku_shupai_buff[j+1]; yaku_shupai_buff[j+1]=i;j=-1;}}var n1=_t[jia].fulou_ctr*3;if(ttype!=0x1010){l=((ptn >> 4) & 0x30)+1; i=3; while(--i>=0){j=0; while(++j<14){if((yaku_shupai_buff[j] & 0x3f)==l){_t_y_shupai[++n1]=yaku_shupai_buff[j];yaku_shupai_buff[j]=0;break;}}l+=3;}}if(ttype!=0x1020){l=(ptn & 0x30)+2; i=3; while(--i>=0){j=0; while(++j<14){if((yaku_shupai_buff[j] & 0x3f)==l){_t_y_shupai[++n1]=yaku_shupai_buff[j];yaku_shupai_buff[j]=0;break;}}l+=3;}}if(ttype!=0x1030){l=((ptn << 4) & 0x30)+3; i=3; while(--i>=0){j=0; while(++j<14){if((yaku_shupai_buff[j] & 0x3f)==l){_t_y_shupai[++n1]=yaku_shupai_buff[j];yaku_shupai_buff[j]=0;break;}}l+=3;}}i=-1; while(++i<n){if(i==ttype) continue;j=_t_menzi[i];if(j<=0) break;if(j<0x40){j--; l=3;while(--l>=0){m=0; while(++m<14){if((yaku_shupai_buff[m] & 0x3f)==j){_t_y_shupai[++n1]=yaku_shupai_buff[m];yaku_shupai_buff[m]=0;break;}}++j;}continue;}l=3;if(j>=0xc0) --l;j &= 0x3f; while(--l>=0){m=0; while(++m<14){if((yaku_shupai_buff[m] & 0x3f)==j){_t_y_shupai[++n1]=yaku_shupai_buff[m];yaku_shupai_buff[m]=0;break;}}}}m=0; while(++m<14){if((yaku_shupai_buff[m] & 0x3f)>0) _t_y_shupai[++n1]=yaku_shupai_buff[m];}_t_y_shupai[14]=_t[jia].shupai[14];_t_y_shupai[15]=_t[jia].shupai[15];}str='組合竜'; v=12;if(_t_lang=='en') str='Knitted Straight';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;if(mn<0){i=_t[jia].fuloupai[0] & 0x3f;j=_t[jia].fuloupai[1] & 0x3f;k=_t[jia].fuloupai[2] & 0x3f;if(i!=j) mn=Math.floor((i+j+k) / 3);else mn=i | 0x80;}if(mn<0x80 && _t_dz<0x30){str='平和'; v=2;if(_t_lang=='en') str='All Chows';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noWuzi=1;}if((i=mn & 0x3f)>0x34){if(_t_lang=='cn' || _t_lang=='tw') str='箭刻';else if(_t_lang=='en') str='Dragon Pung';else  {str='白板';if(i==0x36) str='緑発';if(i==0x35) str='紅中';}v=2; _t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}else if(i>0x30){k=0;if(i==_t_zhuangfeng[0]){if(_t_lang=='cn') str='圏'+String.fromCharCode(39118)+'刻';else if(_t_lang=='tw') str='圏風刻';else if(_t_lang=='en') str='Prevailing  Wind Pung';else {str='東';if(i==0x32) str='南';if(i==0x33) str='西';if(i==0x34) str='北';str=str+'圏風';}v=2; _t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;k++;}if(i==_t[jia].menfeng){if(_t_lang=='cn' || _t_lang=='tw') str='門風刻';else if(_t_lang=='en') str='Seat Wind Pung';else {str='東';if(i==0x32) str='南';if(i==0x33) str='西';if(i==0x34) str='北';str=str+'門風';}v=2; _t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;k++;}if(!k){v=1; str=String.fromCharCode(20040)+'九刻';if(_t_lang=='en') str='Pung of Terminals';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}else if(!((i-1) & 7)){v=1; str=String.fromCharCode(20040)+'九刻';if(_t_lang=='en') str='Pung of Terminals';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if((mn>0xb0 && mn<0xb5 && _t_dz>0x34) || (_t_dz>0x30 && _t_dz<0x35 && mn>0xb4)){str='五門斉';if(_t_lang=='en') str='All Types';v=6; _t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}_t_shupai_move(jia);var k=-5; i=_t[jia].fulou_ctr; while(--i>-1){k+=5;_t_bipai2[_t[jia].fuloupai[k  ] & 0x3f]++;_t_bipai2[_t[jia].fuloupai[k+1] & 0x3f]++;_t_bipai2[_t[jia].fuloupai[k+2] & 0x3f]++;}i=0x2a; v=0; while(--i>=0){if(_t_bipai2[i]>3) v+=2;}if(v>0){str='四帰一';if(_t_lang=='en') str='Tile Hog';v=2; _t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if(!noWuzi && (mn & 0x3f)<0x30){if(_t_dz<0x30){str='無字'; v=1;if(_t_lang=='en') str='No Honor Tiles';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}if(!_t[jia].menqian_flag && _t[jia].fulou_ctr>0){str='暗槓'; v=2;if(_t_lang=='en') str='Concealed Kong';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}else if(_t[jia].fulou_ctr>0 && _t[jia].fuloupai[3]){str='明槓'; v=1;if(_t_lang=='en') str='Melded Kong';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}ttype=-1;if(_t_hp<0x30){switch ((_t_hp & 0x0f) % 3){case 1:
j=(ptn >> 4) & 0x30;if(!((_t_hp ^ j) & 0x30)) ttype=0x1010;break;case 2:
j=ptn & 0x30;if(!((_t_hp ^ j) & 0x30)) ttype=0x1020;break;case 0:
j=(ptn << 4) & 0x30;if(!((_t_hp ^ j) & 0x30)) ttype=0x1030;break;}}if(ttype<0 && !(mode==0 && !_t_started_flag && !_t_ronghe_flag) && _t[jia].helepai_ctr==1){str='';if(_t_dz==_t_hp){str='単調将';if(_t_lang=='en') str='Single Wait';}else if(mn<0x40){str='辺張';if(_t_lang=='en') str='Edge Wait';if((mn+1==_t_hp && (_t_hp & 0x0f)==3) || (mn-1==_t_hp && (_t_hp & 0x0f)==7)){str='嵌張';if(_t_lang=='en') str='Closed Wait';}}if(str!=''){v=1; _t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}if(_t_lingshang_flag && !_t_ronghe_flag){v=8; str='槓上開花';if(_t_lang=='en') str='Supplemental Tile of Melding Quad';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noMohe++;}if(_t_zampai_ctr<1 && !_t_ronghe_flag){v=8; str='妙手回春';if(_t_lang=='en') str='Last Tile Draw';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noMohe++;}else if(_t_zampai_ctr<1){v=8; str='海底撈月';if(_t_lang=='en') str='Last Tile Claim';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noMohe++;}if(_t_qianggang_flag){v=8; str='搶槓和';if(_t_lang=='en') str='Robbing The Kong';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if(!_t[jia].menqian_flag && !_t_ronghe_flag && !noMohe){v=4; str='不求人';if(_t_lang=='en') str='Fully Concealed';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}else if(!_gm_yj_noMenqianqing && !_t[jia].menqian_flag){v=2; str='門前清';if(_t_lang=='en') str='Concealed';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}else if(!noMohe && !_t_ronghe_flag){v=1; str='自摸';if(_t_lang=='cn' || _t_lang=='tw') str='自摸';if(_t_lang=='en') str='Self-Drawn';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}return(1);}function _gm_bukao(jia, mode){var i, j, k, l, m=-1, n=3, t=-1, p;var pb=new Array(20);var yaku_shupai_buff=new Array(20);var str, v;var noMohe=0;if(_t_gamemode!=_T_GAMEMODE_GUOJI) return(0);if(_t[jia].fulou_ctr>0) return(0);i=20; while(--i>=0){pb[i]=0xff;if((j=_t[jia].shupai[i] & 0x3f)>0) pb[i]=j;}i=-1; while(++i<18){if(pb[i]>pb[i+1]){j=pb[i]; pb[i]=pb[i+1]; pb[i+1]=j;i=-1;}}var z147=z258=z369=-1;k=-1;i=-1; while(++i<14){j=pb[i];if(j>0x38) break;if(j>0x30){if(j==k) return(0);k=j; continue;}if((k ^ j) & 0x70){l=j & 0x0f;if(l==1 || l==4 || l==7){if(z147>-1) return(0);z147=j;}else if(l==2 || l==5 || l==8){if(z258>-1) return(0);z258=j;}else {if(z369>-1) return(0);z369=j;}k=j; continue;}if(j!=k+3 && j!=k+6) return(0);k=j;}if(mode<0){_t_shupai_move(jia);if(z147>-1){if(_t_bipai2[z147+1]<1) _t[jia].helepai[_t[jia].helepai_ctr++]=z147+1;if(_t_bipai2[z147+4]<1) _t[jia].helepai[_t[jia].helepai_ctr++]=z147+4;if(_t_bipai2[z147+7]<1) _t[jia].helepai[_t[jia].helepai_ctr++]=z147+7;}if(z258>-1){if(_t_bipai2[z258+2]<1) _t[jia].helepai[_t[jia].helepai_ctr++]=z258+2;if(_t_bipai2[z258+5]<1) _t[jia].helepai[_t[jia].helepai_ctr++]=z258+5;if(_t_bipai2[z258+8]<1) _t[jia].helepai[_t[jia].helepai_ctr++]=z258+8;}if(z369>-1){if(_t_bipai2[z369+3]<1) _t[jia].helepai[_t[jia].helepai_ctr++]=z369+3;if(_t_bipai2[z369+6]<1) _t[jia].helepai[_t[jia].helepai_ctr++]=z369+6;if(_t_bipai2[z369+9]<1) _t[jia].helepai[_t[jia].helepai_ctr++]=z369+9;}i=0x30; while(++i<0x38){if(_t_bipai2[i]<1) _t[jia].helepai[_t[jia].helepai_ctr++]=i;}return(1);}_t_yaku_name_ctr=0;_t_fu=0;_t_yakuman_name_ctr=0;_t_fan=_t_fan_common;_t_yakufan_ctr=_t_yakufan_ctr_common;i=0x40; while(--i>=0) _t_XOO[i]=_t_OXO[i]=_t_OOX[i]=_t_OOO[i]=_t_OOOO[i]=0;i=-1; while(++i<_t_yaku_name_common_ctr){v=_t_yaku_fansu_common[i]; _t_yaku_fansu[_t_yaku_name_ctr]=v;str=_t_yaku_name_common[i]; _t_yaku_name[_t_yaku_name_ctr++]=str;}if(!mode){j=0; while(++j<20){_t_y_shupai[j]=0;yaku_shupai_buff[j]=_t[jia].shupai[j];}yaku_shupai_buff[0]=yaku_shupai_buff[14]=yaku_shupai_buff[15]=0;var n1=_t[jia].fulou_ctr*3;i=-1; while(++i<3){if(i==k) continue;j=z147;m=-1; while(++m<20){k=yaku_shupai_buff[m] & 0x3f;if(k>0 && !((k ^ j) & 0x30)){_t_y_shupai[++n1]=yaku_shupai_buff[m];yaku_shupai_buff[m]=0;break;}}}i=-1; while(++i<3){if(i==k) continue;j=z258;m=-1; while(++m<20){k=yaku_shupai_buff[m] & 0x3f;if(k>0 && !((k ^ j) & 0x30)){_t_y_shupai[++n1]=yaku_shupai_buff[m];yaku_shupai_buff[m]=0;break;}}}m=0; while(++m<14){if((yaku_shupai_buff[m] & 0x3f)>0) _t_y_shupai[++n1]=yaku_shupai_buff[m];}_t_y_shupai[14]=_t[jia].shupai[14];_t_y_shupai[15]=_t[jia].shupai[15];}_gm_yj_noMenqianqing=1;if(pb[7]==0x31){v=24; str='七星不靠';if(_t_lang=='en') str='Greater Honors and Knitted Tiles';}else {v=12; str='全不靠';if(_t_lang=='en') str='Lesser Honors and Knitted Tiles';}_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;if(pb[8]<0x30){str='組合竜'; v=12;if(_t_lang=='en') str='Knitted Straight';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if(_t_zampai_ctr<1 && !_t_ronghe_flag){v=8; str='妙手回春';if(_t_lang=='en') str='Last Tile Draw';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noMohe++;}else if(_t_zampai_ctr<1){v=8; str='海底撈月';if(_t_lang=='en') str='Last Tile Claim';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noMohe++;}if(_t_qianggang_flag){v=8; str='搶槓和';if(_t_lang=='en') str='Robbing The Kong';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if(!_t[jia].menqian_flag && !_t_ronghe_flag){v=4; str='不求人';if(_t_lang=='en') str='Fully Concealed';if(noMohe){v=2; str='門前清';if(_t_lang=='en') str='Concealed';}_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}return(1);}function _gm_qiduizi(jia, mode){var a, b, c, i, j=-1, k=0, l, m, n, o, v, x, y, z;var str='';var ar=new Array(0x40);var tb=new Array(20);var tianhe=0;var noMohe=0;var no41=0;_t_yaku_name_ctr=0;_t_fu=0;_t_yakuman_name_ctr=0;_t_fan=_t_fan_common;_t_yakufan_ctr=_t_yakufan_ctr_common;if(mode<2){i=-1; while(++i<_t_yaku_name_common_ctr){v=_t_yaku_fansu_common[i]; _t_yaku_fansu[_t_yaku_name_ctr]=v;str=_t_yaku_name_common[i]; _t_yaku_name[_t_yaku_name_ctr++]=str;}}_t_shupai_move(jia);_gm_yj_noMenqianqing=0;var noQueyimen=0;var noWuzi=0;if(_t[jia].fulou_ctr>0) return(0);i=0x40; while(--i>=0){if(_t_bipai2[i] & 1) return(0);_t_XOO[i]=_t_OXO[i]=_t_OOX[i]=_t_OOO[i]=_t_OOOO[i]=0;}if(mode==0 && !_t_started_flag && !_t_ronghe_flag) tianhe=1;_gm_yj_noMenqianqing=1;j=0x38; while(--j>=0){if(_t_bipai2[j]>0) break;}if(j>6 && j<0x30 && _t_bipai2[j] && _t_bipai2[j-1] && _t_bipai2[j-2] && _t_bipai2[j-3] && _t_bipai2[j-4] && _t_bipai2[j-5] && _t_bipai2[j-6]){str='連七対'; v=88;if(_t_lang=='en') str='Seven Shifted Pairs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noWuzi=1;if(!mode){i=14;  while(--i>=0) _t_y_shupai[i]=_t[jia].shupai[i];}}else {i=_t_bipai2[0x02]+_t_bipai2[0x03]+_t_bipai2[0x04]+_t_bipai2[0x06]+_t_bipai2[0x08]+_t_bipai2[0x36];if(i>13){str='緑一色'; v=88;if(_t_lang=='en') str='All Green';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;no41=1;}if(_t_bipai2[0x31]+_t_bipai2[0x32]+_t_bipai2[0x33]+_t_bipai2[0x34]+_t_bipai2[0x35]+_t_bipai2[0x36]+_t_bipai2[0x37]>12){str='字一色'; v=64;if(_t_lang=='en') str='All Honors';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}else {i=20; l=0x30; j=k=0; while(--i>=0){if((m=_t[jia].shupai[i] & 0x3f)<1) continue;if(m>0x30){ j++; k++; continue; }if(l>=0x30) l=m;if(!((m ^ l) & 0x30)) k++;}if(k>13){if(j>0){v=6; str='混一色';if(_t_lang=='en') str='Half Flush';}else {v=24; str='清一色';if(_t_lang=='en') str='Full Flush';}_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noWuzi=1;}}str='七対'; v=24;if(_t_lang=='en') str='Seven Pairs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;if(!mode){i=20; while(--i>=0) tb[i]=_t[jia].shupai[i];tb[14]=tb[15]=0;k=0; i=0; while(++i<14){if((tb[i] & 0x3f)==_t_hp){_t_y_shupai[13]=tb[i];tb[i]=0; break;}}i=0; while(++i<20){if(tb[i]) _t_y_shupai[++k]=tb[i];}_t_y_shupai[14]=_t[jia].shupai[14];_t_y_shupai[15]=_t[jia].shupai[15];}}var big=mid=sma=0;var hig=low=0;var suit=0x30, zipai=0, yao=0;var tuibudao=0;i=20; k=-1; l=0;while(--i>=0){j=_t[jia].shupai[i] & 0x3f;if(j<1 || j>0x37) continue;if(j==0x37 || (j<0x20 && j!=0x01 && j!=0x03 && j!=0x07 && j!=0x16 && j!=0x17)) tuibudao++;if(j>0x30){ yao++; zipai++; continue; }if(suit>0x20) suit=j & 0x30;else if((suit ^ j) & 0x30) suit=-1;switch (j & 0x0f){case 1: yao++;sma++;low++;break;case 2: sma++;low++;break;case 3: low++;sma++;break;case 4: low++;mid++;break;case 5: mid++;break;case 6: hig++;mid++;break;case 7: big++;hig++;break;case 8: big++;hig++;break;case 9: big++;hig++;yao++;break;}}if(tuibudao>12){str='推不倒'; v=8;if(_t_lang=='en') str='Reversible Tiles';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noQueyimen=1;}if(zipai<14 && yao>12){if(zipai>0){str='混幺九'; v=32;if(_t_lang=='tw') str='清'+String.fromCharCode(20040)+'九';if(_t_lang=='en') str='All Terminals and Honors';}else {str='清幺九'; v=64;if(_t_lang=='tw') str='混'+String.fromCharCode(20040)+'九';if(_t_lang=='en') str='All Terminals';no41=1;}_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noWuzi=1;}if(big>12){str='全大'; v=24;if(_t_lang=='en') str='Upper Tiles';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noWuzi=1;}else if(hig>12){str='大於五'; v=12;if(_t_lang=='cn') str='大于五';if(_t_lang=='en') str='Upper Four';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noWuzi=1;}if(sma>12){str='全小'; v=24;if(_t_lang=='en') str='Lower Tiles';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noWuzi=1;}else if(low>12){str='小於五'; v=12;if(_t_lang=='cn') str='小于五';if(_t_lang=='en') str='Lower Four';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noWuzi=1;}if(mid>12){str='全中'; v=24;if(_t_lang=='en') str='Middle Tiles';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noWuzi=1;}else {if(yao<1){str='断'+String.fromCharCode(20040); v=2;if(_t_lang=='cn') str='断幺';if(_t_lang=='tw') str=String.fromCharCode(26039)+String.fromCharCode(20040);if(_t_lang=='en') str='All Simples';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noWuzi=1;}}if(!noWuzi && zipai<1){str='無字'; v=1;if(_t_lang=='en') str='No Honor Tiles';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}ar[0]=ar[1]=ar[2]=ar[3]=ar[4]=0;i=20; while(--i>=0){if((j=_t[jia].shupai[i] & 0x3f)<1 || i>0x37) continue;if(j>0x34) j=4; else j >>= 4;ar[j]++;}i=5; j=0; k=-1; while(--i>=0){if(ar[i]<1){ k=i; continue; }j++;}if(j>4){str='五門斉';if(_t_lang=='en') str='All Types';v=6; _t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if(!noQueyimen){i=3; j=0; k=-1; while(--i>=0){if(ar[i]<1){ k=i; j++; }}if(j==1){str='欠一門';if(_t_lang=='en') str='One Voided Suit';v=1; _t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}if(no41<1){v=0; i=0x38; while(--i>=0){if(_t_bipai2[i]>3) v+=2;}if(v>0){str='四帰一';if(_t_lang=='en') str='Tile Hog';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}if(_t_zampai_ctr<1 && !_t_ronghe_flag){v=8; str='妙手回春';if(_t_lang=='en') str='Last Tile Draw';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noMohe++;}else if(_t_zampai_ctr<1){v=8; str='海底撈月';if(_t_lang=='en') str='Last Tile Claim';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noMohe++;}if(!_t_ronghe_flag){v=4; str='不求人';if(_t_lang=='en') str='Fully Concealed';if(noMohe){v=2; str='門前清';if(_t_lang=='en') str='Concealed';}_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}return(1);}function _gm_yaku_menziType(jia, mode){var a, b, c, i, j=-1, k=0, l, m, n, o, v, x, y, z;var str='';var ar=new Array(0x40);var zt=new Array(0x40);var noMohe=0;_t_dz=0;_t_shupai_move(jia);_gm_yj_noMenqianqing=0;var noQueyimen=0;var noWuzi=0;var noSiguiyi=0;var noDuanyao=0;var yaku_menzi_fu=new Array(6);var yaku_menzi=new Array(6);var tianhe=0;if(mode==0 && !_t_started_flag && !_t_ronghe_flag) tianhe=1;_t_yaku_name_ctr=0;_t_fu=0;_t_yakuman_name_ctr=0;_t_fan=_t_fan_common;_t_yakufan_ctr=_t_yakufan_ctr_common;var anke=0;var angang=0;var liangmen=-1;var gangzi=0;var qianzhang=-1;var bianzhang=-1;var dandiao=-1;var shuangpeng=-1;var gm_liangshun=0;if(mode<2){i=-1; while(++i<_t_yaku_name_common_ctr){v=_t_yaku_fansu_common[i]; _t_yaku_fansu[_t_yaku_name_ctr]=v;str=_t_yaku_name_common[i]; _t_yaku_name[_t_yaku_name_ctr++]=str;}}i=-1; while(++i<6) yaku_menzi_fu[i]=yaku_menzi[i]=-1;j=-1; while(++j<4){if(_t_menzi[j+1]==0) break;if(_t_menzi[j]>_t_menzi[j+1]){k=_t_menzi[j]; _t_menzi[j]=_t_menzi[j+1]; _t_menzi[j+1]=k;j=-1;}}var shz1=shz2=shz3=kez1=0;j=-1; while(++j<6){if((i=_t_menzi[j])<1) break;yaku_menzi_fu[j]=0; yaku_menzi[j]=i;if(i<0x30){if(i==_t_hp && !shz1){qianzhang=j;shz1=1;continue;}if(i-1==_t_hp && !shz2){if((i & 0x0f)==8) bianzhang=j; else liangmen=j;shz2=1;continue;}if(i+1==_t_hp && !shz3){if((i & 0x0f)==2) bianzhang=j; else liangmen=j;shz3=1;continue;}continue;}if(i<0xc0){i &= 0x3f; ++anke;if(i==_t_hp){if(_t_bipai2[_t_hp]<4){shuangpeng=j;if(_t_ronghe_flag) --anke;kez1=1;}}yaku_menzi_fu[j]=k; _t_fu+=k;continue;}if((i &= 0x3f)==_t_hp) dandiao=j;_t_dz=i;}ar[0]=ar[1]=ar[2]=ar[3]=ar[4]=ar[5]=-1;if(!mode) yj_menzisort(jia, _t_menzi, ar, dandiao, bianzhang, qianzhang, shuangpeng, liangmen);if(bianzhang>-1) bianzhang=_t_menzi[bianzhang];if(qianzhang>-1) qianzhang=_t_menzi[qianzhang];i=0x40; while(--i>=0) ar[i]=0;j=-1; k=-5; i=4;while(++j<_t[jia].fulou_ctr){k+=5; l=_t[jia].fuloupai[k] & 0x3f;if(l!=(_t[jia].fuloupai[k+1] & 0x3f)){l=Math.floor(l+(_t[jia].fuloupai[k+1] & 0x3f)+(_t[jia].fuloupai[k+2] & 0x3f))/3;_t_menzi[i--]=l; ar[l]++;continue;}_t_menzi[i--]=l | 0x80;if(_t[jia].fuloupai[k+4]){ ++anke; ++gangzi; ++angang; }if(_t[jia].fuloupai[k+3]){ ++gangzi; }}j=-1; while(++j<4){if(_t_menzi[j+1]==0) break;if(_t_menzi[j]>_t_menzi[j+1]){k=_t_menzi[j]; _t_menzi[j]=_t_menzi[j+1]; _t_menzi[j+1]=k;j=-1;}}_t_dandiao=0; if(dandiao>-1 && liangmen<0 && (qianzhang>-1 || bianzhang>-1)) _t_dandiao=1;var noPinghe=0;var noDuidui=0;var noTingpai=0;var noQuanqiu=0;var noLaoshaofu=0;var noYibeikou=0;var noYaojiuke=0;var noQuantai=0;var noXixiangfeng=0;var noLianlyu=0;if(_t_ronghe_flag && _t[jia].fulou_ctr>3 && anke<1){str='全求人';if(_t_lang=='en') str='Melded Hand';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=6; _t_yakufan_ctr+=6;noTingpai=1;}if(gangzi>3){str='四槓';if(_t_lang=='cn') str='四杠';if(_t_lang=='en') str='Four Kongs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=88; _t_yakufan_ctr+=88;noDuidui=1;noTingpai=1;}else if(gangzi>2){str='三槓';if(_t_lang=='en') str='Three Kongs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=32; _t_yakufan_ctr+=32;}else if(gangzi>1 && gangzi>angang){str='双明槓';if(_t_lang=='en') str='Two Melded Kongs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=4; _t_yakufan_ctr+=4;}else if(gangzi==1 && angang<1){str='明槓';if(_t_lang=='en') str='Melded Kong';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=1; _t_yakufan_ctr+=1;}if(angang>1){str='双暗槓';if(_t_lang=='en') str='Two Concealed Kongs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=8; _t_yakufan_ctr+=8;}else if(angang>0){str='暗槓';if(_t_lang=='en') str='Concealed Kong';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=2; _t_yakufan_ctr+=2;}if(anke>3){str='四暗刻';if(_t_lang=='en') str='Four Concealed Pungs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=64; _t_yakufan_ctr+=64;noDuidui=1;noQuanqiu=1;_gm_yj_noMenqianqing=1;}else {if(anke>2){str='三暗刻';if(_t_lang=='en') str='Three Concealed Pungs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=16; _t_yakufan_ctr+=16;}else if(anke>1){str='双暗刻';if(_t_lang=='en') str='Two Concealed Pungs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=2; _t_yakufan_ctr+=2;}}if(!noTingpai && _t[jia].helepai_ctr==1){str='';if(dandiao>-1){str='単調将';if(_t_lang=='en') str='Single Wait';}else if(bianzhang>-1){str='辺張';if(_t_lang=='en') str='Edge Wait';}else if(qianzhang>-1){str='嵌張';if(_t_lang=='en') str='Closed Wait';}if(str!=''){v=1; _t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=1; _t_yakufan_ctr++;}}if(_t_menzi[0]>0xb0 && _t_dz>0x30){str='字一色';if(_t_lang=='en') str='All Honors';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=64; _t_yakufan_ctr+=64;noDuidui=1;noYaojiuke=1;noQuantai=1;}else if((j=_t_menzi[4] & 0x30)<0x30 && (_t_menzi[4] & 0x0f)==5 &&    _t_menzi[0]==j+2 && _t_menzi[1]==j+2 && _t_menzi[2]==j+8 && _t_menzi[3]==j+8){str='一色双竜会';if(_t_lang=='en') str='Pure Terminal Chows';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=64; _t_yakufan_ctr+=64;noPinghe=1;noXixiangfeng=1;noLaoshaofu=1;noYibeikou=1;noWuzi=1;}else {if(!tianhe && _t[jia].fulou_ctr<1 && (i=_t_hp & 0x30)<0x30 &&    _t_bipai2[i+1]>2 && _t_bipai2[i+2]>0 && _t_bipai2[i+3]>0 && _t_bipai2[i+4]>0 && _t_bipai2[i+5]>0 && _t_bipai2[i+6]>0 && _t_bipai2[i+7]>0 && _t_bipai2[i+8]>0 && _t_bipai2[i+9]>2 &&    !(_t_bipai2[_t_hp] & 1)){str='九蓮宝燈';if(_t_lang=='en') str='Nine Gates';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=88; _t_yakufan_ctr+=88;noYaojiuke=1;_gm_yj_noMenqianqing=1;noWuzi=1;j=-1; while(++j<20) _t_y_shupai[j]=_t[jia].shupai[j];}else {i=4; j=0x30; l=0; while(--i>=0){if((k=_t_menzi[i] & 0x30)>0x20){ l++; continue; }if(j==0x30){ j=k; continue; }if(j!=k) break;}if(i<0){v=1; if(_t_dz>0x30 || !((_t_dz ^ j) & 0x30)){if(l>0 || _t_dz>0x30){v=6; str='混一色';if(_t_lang=='en') str='Half Flush';}else {v=24; str='清一色';if(_t_lang=='en') str='Full Flush';}_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noWuzi=1;}}i=5; k=0; while(--i>=0){if((j=_t_menzi[i])<0x30){if(j==0x03) ++k;continue;}if((j &= 0x3f)==0x36 || j==0x03 || !(j & 0x31)) ++k;}if(k>4){str='緑一色';if(_t_lang=='en') str='All Green';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=88; _t_yakufan_ctr+=88;}}}if(_t_menzi[0]>0xb0 && _t_menzi[3]<0xb5){str='大四喜';if(_t_lang=='en') str='Big Four Winds';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=88; _t_yakufan_ctr+=88;noDuidui=1;noYaojiuke=1;}else {if(_t_menzi[4]>0xf0 && _t_menzi[4]<0xf5 &&    ((_t_menzi[0]>0xb0 && _t_menzi[2]<0xb5) || (_t_menzi[1]>0xb0 && _t_menzi[3]<0xb5))){str='小四喜';if(_t_lang=='en') str='Little Four Winds';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=64; _t_yakufan_ctr+=64;noYaojiuke=1;}else {if((_t_menzi[0]>0xb0 && _t_menzi[2]<0xb5) || (_t_menzi[1]>0xb0 && _t_menzi[3]<0xb5)){str='三風刻';if(_t_lang=='en') str='Big Three Winds';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=12; _t_yakufan_ctr+=12;}k=_t_zhuangfeng[0];i=4; while(--i>=0){if((_t_menzi[i] & 0x3f)==k) break;}if(i>-1){if(_t_lang=='en') str='Prevalent Wind Pung';else str='圏風刻';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=2; _t_yakufan_ctr+=2;}k=_t[jia].menfeng;i=4; while(--i>=0){if((_t_menzi[i] & 0x3f)==k) break;}if(i>-1){if(_t_lang=='en') str='Seat Wind Pung';else str='門風刻';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=2; _t_yakufan_ctr+=2;}}}if(_t_menzi[1]>0xb4){str='大三元';if(_t_lang=='en') str='Big Three Dragons';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=88; _t_yakufan_ctr+=88;}else {if(_t_menzi[2]>0xb4 && _t_menzi[4]>0xf4){str='小三元';if(_t_lang=='en') str='Little Three Dragons';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=64; _t_yakufan_ctr+=64;}else if(_t_menzi[2]>0xb4){str='双箭刻';if(_t_lang=='en') str='Two Dragon Pungs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=6; _t_yakufan_ctr+=6;}else if((j=_t_menzi[3] & 0x3f)>0x34){if(_t_lang=='en') str='Dragon Pung';else str='箭刻';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=2; _t_yakufan_ctr+=2;}}var yaojiuke=0, quanwu=0;var big=mid=sma=0;var hig=low=0;var dui=yao=zipai=0;var tuibudao=0;i=5; while(--i>=0){j=_t_menzi[i];if(j<1) continue;if(j<0x30){if(j==0x12 || j==0x13 || j==0x14 || j==0x05) tuibudao++;switch (j & 0x0f){case 2: yao++;sma++;low++;break;case 3: low++;break;case 4: quanwu++;break;case 5: mid++;quanwu++;break;case 6: quanwu++;break;case 7: hig++;break;case 8: big++;hig++;yao++;break;}continue;}if((k=j & 0x3f)==0x37 || (k<0x20 && k!=0x01 && k!=0x03 && k!=0x07 && k!=0x16 && k!=0x17)) tuibudao++;if(j<0xc0) dui++;if((j & 0x3f)>0x30){zipai++; yao++;if(j<0xc0 && j<0xc5 && (j & 0x3f)!=_t_zhuangfeng[0] && (j & 0x3f)!=_t[jia].menfeng) yaojiuke++;continue;}else {switch (j & 0x0f){case 1: yao++;sma++;low++;break;case 2: sma++;low++;break;case 3: low++;sma++;break;case 4: low++;mid++;break;case 5: quanwu++;mid++;break;case 6: hig++;mid++;break;case 7: big++;hig++;break;case 8: big++;hig++;break;case 9: big++;hig++;yao++;break;}}}if(tuibudao>4){str='推不倒';if(_t_lang=='en') str='Reversible Tiles';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=8; _t_yakufan_ctr+=8;noQueyimen=1;}if(_t_menzi[0]>0x80 && _t_menzi[3]<0xb0){i=5; while(--i>=0){if(_t_menzi[i] & 0x01) break;}if(i<0 && _t_menzi[4]<0xf0){str='全双刻';if(_t_lang=='en') str='All Even Pungs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=24; _t_yakufan_ctr+=24;noWuzi=1;noDuidui=1;noDuanyao=1;}}if(!noQuantai && yao>4 && dui>3){if(zipai>0){str='混'+String.fromCharCode(20040)+'九'; v=32;if(_t_lang=='en') str='All Terminals and Honors';}else {str='清'+String.fromCharCode(20040)+'九'; v=64;if(_t_lang=='en') str='All Terminals';}_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noDuidui=1;noYaojiuke=1;noQuantai=1;noWuzi=1;}else if(yao>4 && !noQuantai){str='全帯'+String.fromCharCode(20040);if(_t_lang=='en') str='Outside Hand';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=4; _t_yakufan_ctr+=4;}if(big>4){str='全大';if(_t_lang=='en') str='Upper Tiles';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=24; _t_yakufan_ctr+=24;noWuzi=1;}else if(hig>4){str='大於五';if(_t_lang=='en') str='Upper Four';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=12; _t_yakufan_ctr+=12;noWuzi=1;}if(sma>4){str='全小';if(_t_lang=='en') str='Lower Tiles';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=24; _t_yakufan_ctr+=24;noWuzi=1;}else if(low>4){str='小於五';if(_t_lang=='en') str='Lower Four';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=12; _t_yakufan_ctr+=12;noWuzi=1;}if(mid>4){str='全中';if(_t_lang=='en') str='Middle Tiles';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=24; _t_yakufan_ctr+=24;noDuanyao=1;noWuzi=1;}if(quanwu>4){str='全帯五';if(_t_lang=='en') str='All Fives';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=16; _t_yakufan_ctr+=16;noDuanyao=1;noWuzi=1;}if(noDuanyao<1 && yao<1){str='断'+String.fromCharCode(20040);if(_t_lang=='cn') str='断幺';if(_t_lang=='tw') str=String.fromCharCode(26039)+String.fromCharCode(20040);if(_t_lang=='en') str='All Simples';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=2; _t_yakufan_ctr+=2;noWuzi=1;}if(_t_menzi[0]==_t_menzi[3]){str='一色四同順';if(_t_lang=='en') str='Quadruple Chow';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=48; _t_yakufan_ctr+=48;noYibeikou=1;noSiguiyi=1;}else if(_t_menzi[0]==_t_menzi[2] ||_t_menzi[1]==_t_menzi[3]){str='一色三同順';if(_t_lang=='en') str='Pure Triple Chow';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=24; _t_yakufan_ctr+=24;noYibeikou=1;gm_liangshun=2;}if((i=_t_menzi[0])<0x30 && i+6==_t_menzi[1] &&    (j=_t_menzi[2])<0x30 && j+6==_t_menzi[3] &&    (k=_t_menzi[4])<0xf0 && (k & 0x0f)==5 && ((i ^ k) & 0x30) && ((j ^ k) & 0x30) && ((i ^ j) & 0x30)){str='三色双竜会';if(_t_lang=='en') str='Three-Suited Terminal Chows';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=16; _t_yakufan_ctr+=16;noLaoshaofu=1;noPinghe=1;noXixiangfeng=1;noWuzi=1;}if((i=_t_menzi[0])<0x30 &&    ((i+1==_t_menzi[1] && i+2==_t_menzi[2] && i+3==_t_menzi[3]) ||     (i+2==_t_menzi[1] && i+4==_t_menzi[2] && i+6==_t_menzi[3]))){str='一色四歩高';if(_t_lang=='en') str='Four Shifted Chows';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=32; _t_yakufan_ctr+=32;noLaoshaofu=1;}else if(((l=_t_menzi[0])<0x30 && l+1==_t_menzi[1] && (l+2==_t_menzi[2] || l+2==_t_menzi[3])) ||         ((j=_t_menzi[3])<0x30 && j-1==_t_menzi[2] && (j-2==(l=_t_menzi[1]) || j-2==(l=_t_menzi[0])))){str='一色三歩高';if(_t_lang=='en') str='Pure Shifted Chows';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=16; _t_yakufan_ctr+=16;gm_liangshun=2;}else if(((l=_t_menzi[0])<0x30 && l+2==_t_menzi[1] && (l+4==_t_menzi[2] || l+4==_t_menzi[3])) ||         ((j=_t_menzi[3])<0x30 && j-2==_t_menzi[2] && (j-4==(l=_t_menzi[1]) || j-4==(l=_t_menzi[0])))){str='一色三歩高';if(_t_lang=='en') str='Pure Shifted Chows';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=16; _t_yakufan_ctr+=16;gm_liangshun=2;}if(((l=_t_menzi[0])+0x10==_t_menzi[1] && (l+0x20==_t_menzi[2] || l+0x20==_t_menzi[3]) && !(l & 0x30)) ||    ((((j=_t_menzi[3]) & 0x30)<0x30) && j-0x10==_t_menzi[2] && (j-0x20==(l=_t_menzi[1]) || j-0x20==(l=_t_menzi[0])))){if(l & 0x80){str='三同刻'; v=16;if(_t_lang=='en') str='Triple Pung';l &= 0x0f;}else {str='三色三同順'; v=8;if(_t_lang=='en') str='Mixed Triple Chow';gm_liangshun=2;l &= 0x0f;}_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;noXixiangfeng=1;}else {v=0; x=y=-1;i=-1; while(++i<4){if((l=_t_menzi[i])<0x80) continue;if(l>0xb0) break;j=i; while(++j<5){if((m=_t_menzi[j])<0x80) continue;if(m>0xb0) break;if(((l ^ m) & 0x0f)) continue;x=l; y=m; v+=2;}}if(v>0){str='双同刻';if(_t_lang=='en') str='Double Pung';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}if(((i=_t_menzi[0])<0x30 && i+3==_t_menzi[1] && (i+6==_t_menzi[2] || i+6==_t_menzi[3])) ||    ((i=_t_menzi[3])<0x30 && i-3==_t_menzi[2] && (i-6==_t_menzi[1] || i-6==_t_menzi[0]))){str='清竜';if(_t_lang=='en') str='Pure Straight';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=16; _t_yakufan_ctr+=16;noLianlyu=1;noLaoshaofu=1;gm_liangshun=2;i &= 0x30;}l=0; if((i=_t_menzi[0])>0x80 && (j=_t_menzi[3])<0xb0 && i+3==j){str='一色四節高';if(_t_lang=='en') str='Four Pure Shifted Pungs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=48; _t_yakufan_ctr+=48;noDuidui=1;l=1;}else if(((i=_t_menzi[0])>0x80 && (j=_t_menzi[2])<0xb0 && i+2==j) ||         ((i=_t_menzi[1])>0x80 && (j=_t_menzi[3])<0xb0 && i+2==j)){str='一色三節高';if(_t_lang=='en') str='Pure Shifted Pungs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=24; _t_yakufan_ctr+=24;i &= 0x3f;l=1;}o=0; x=-1; while(++x<3){i=_t_menzi[x];if(i!=0x02 && i!=0x05 && i!=0x08) continue;l=1;if(i==0x05) l=2;if(i==0x08) l=4;y=x; while(++y<4){i=_t_menzi[y];if(i!=0x12 && i!=0x15 && i!=0x18) continue;m=1;if(i==0x15) m=2;if(i==0x18) m=4;z=y; while(++z<5){i=_t_menzi[z];if(i!=0x22 && i!=0x25 && i!=0x28) continue;n=1;if(i==0x25) n=2;if(i==0x28) n=4;if((l | m | n)==7){ o++; break; }}if(o) break;}if(o) break;}if(o){str='花竜';if(_t_lang=='cn') str='花'+String.fromCharCode(40857);if(_t_lang=='en') str='Mixed Straight';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=8; _t_yakufan_ctr+=8;gm_liangshun=2;}o=0;var t=[0, 0, 0, 0], u=[0, 0, 0, 0];a=-1; x=-1; while(++x<3){i=_t_menzi[x];if(i==a) continue;a=i;if(i<1 || i>0xb0) continue;if(i & 0x30) continue;l=i & 0xf0; b=-1;y=x; while(++y<4){i=_t_menzi[y];if(i==b) continue;b=i;if(i<1 || i>0xb0) continue;if((i & 0xf0)!=l+0x10) continue;c=-1;z=y; while(++z<5){i=_t_menzi[z];if(i==c) continue;c=i;if(i<1 || i>0xb0) continue;if((i & 0xf0)!=l+0x20) continue;u[0]=_t_menzi[x]; t[0]=_t_menzi[x] & 0x0f;u[1]=_t_menzi[y]; t[1]=_t_menzi[y] & 0x0f;u[2]=i; t[2]=i & 0x0f;for(;;){if(t[0]>t[1]){k=t[0]; t[0]=t[1]; t[1]=k;k=u[0]; u[0]=u[1]; u[1]=k;continue;}if(t[1]<=t[2]) break;k=t[1]; t[1]=t[2]; t[2]=k;k=u[1]; u[1]=u[2]; u[2]=k;}if(t[0]+1==t[1] && t[1]+1==t[2]){if(u[0]<0x80){str='三色三歩高';if(_t_lang=='en') str='Mixed Shifted Chows';gm_liangshun=2; v=6;}else {str='三色三節高'; v=8;if(_t_lang=='en') str='Mixed Shifted Pungs';}_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;o=-1;break;}}if(o) break;}if(o) break;}if(!noDuidui){if(_t_menzi[0]>0x80){str=String.fromCharCode(30896)+'々和';if(_t_lang=='en') str='All Pungs';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=6; _t_yakufan_ctr+=6;}}l=m=n=o=0; w=0;a=x=-1; while(++x<3){if((i=_t_menzi[x])>0x80) break;if(i==a) continue;a=i; b=-1; y=x; while(++y<4){if((i=_t_menzi[y])>0x80) break;if(i==b) continue;b=i;if(a==b){if(noYibeikou>0) continue;if(gm_liangshun>2) continue;l++; gm_liangshun++;w=(w << 8)+(x << 4)+y;continue;}if(a+3==b){if(noLianlyu>0) continue;if(gm_liangshun>2) continue;m++; gm_liangshun++;w=(w << 8)+(x << 4)+y;continue;}if(a+6==b){if(noLaoshaofu>0) continue;if(gm_liangshun>2) continue;n++; gm_liangshun++;w=(w << 8)+(x << 4)+y;continue;}if(((a ^ b) & 0x0f)) continue;if(noXixiangfeng>0) continue;if(gm_liangshun>2) continue;o++; gm_liangshun++;w=(w << 8)+(x << 4)+y;}}if((v=l)>0){str='一般高';if(_t_lang=='en') str='Pure Double Chow';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if((v=m)>0){str='連六';if(_t_lang=='en') str='Short Straight';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if((v=n)>0){str='老少副';if(_t_lang=='en') str='Two Terminal Chows';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if((v=o)>0){str='喜相逢';if(_t_lang=='en') str='Mixed Double Chow';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}if(!noPinghe && _t_menzi[3]<0x80 && _t_dz<0x30){str='平和';if(_t_lang=='en') str='All Chows';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=2; _t_yakufan_ctr+=2;noWuzi=1;}if(!noWuzi && zipai<1){str='無字';if(_t_lang=='en') str='No Honor Tiles';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=1; _t_yakufan_ctr+=1;}if(!noYaojiuke){v=0; i=5; while(--i>=0){j=_t_menzi[i]-0x80;if(j<1 || j>0x34) continue;if(j>0x30){if(j!=_t_zhuangfeng[0] && j!=_t_zhuangfeng[1] && j!=_t[jia].menfeng) v++;continue;}if(!((j-1) & 7)) v++;}if(v>0){str=String.fromCharCode(20040)+'九刻';if(_t_lang=='en') str='Pung of Terminals';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}ar[0]=ar[1]=ar[2]=ar[3]=ar[4]=0;i=5; while(--i>=0){if((j=_t_menzi[i] & 0x03f)>0x34){ ar[4]++; continue; }ar[j >> 4]++;}i=5; j=0; while(--i>=0){if(ar[i]>0) j++;}if(j>4){str='五門斉';if(_t_lang=='en') str='All Types';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=6; _t_yakufan_ctr+=6;}if(!noQueyimen){i=3; j=0; k=-1; while(--i>=0){if(ar[i]<1){ k=i; j++; }}if(j==1){str='欠一門';if(_t_lang=='en') str='One Voided Suit';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=1; _t_yakufan_ctr++;}}if(!noSiguiyi){i=0x38; while(--i>=0) ar[i]=_t_bipai2[i];k=-5; i=_t[jia].fulou_ctr; while(--i>=0){k+=5;ar[_t[jia].fuloupai[k  ] & 0x3f]++;ar[_t[jia].fuloupai[k+1] & 0x3f]++;ar[_t[jia].fuloupai[k+2] & 0x3f]++;}v=0; i=0x00; while(++i<0x38){if((i & 0x0f)==10) i+=7;if(ar[i]>3) v+=2;}if(v>0){str='四帰一';if(_t_lang=='en') str='Tile Hog';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=v; _t_yakufan_ctr+=v;}}if(_t_lingshang_flag && !_t_ronghe_flag){str='槓上開花';if(_t_lang=='en') str='Out with Replacement Tile';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=8; _t_yakufan_ctr+=8;noMohe++;}if(_t_zampai_ctr<1 && !_t_ronghe_flag){str='妙手回春';if(_t_lang=='en') str='Last Tile Draw';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=8; _t_yakufan_ctr+=8;noMohe++;}else if(_t_zampai_ctr<1){str='海底撈月';if(_t_lang=='en') str='Last Tile Claim';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=8; _t_yakufan_ctr+=8;noMohe++;}if(_t_qianggang_flag){str='搶槓和';if(_t_lang=='en') str='Robbing The Kong';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=8; _t_yakufan_ctr+=8;}if(!_t[jia].menqian_flag && !_t_ronghe_flag && !noMohe){str='不求人';if(_t_lang=='en') str='Fully Concealed';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=4; _t_yakufan_ctr+=4;}else if(!_gm_yj_noMenqianqing && !_t[jia].menqian_flag){str='門前清';if(_t_lang=='en') str='Concealed';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=2; _t_yakufan_ctr+=2;}else if(!noMohe && !_t_ronghe_flag){str='自摸';if(_t_lang=='cn' || _t_lang=='tw') str='自摸';if(_t_lang=='en') str='Self-Drawn';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=1; _t_yakufan_ctr++;}if(_t_yakufan_ctr-_t_fan<1){str='無番和';if(_t_lang=='en') str='Chicken Hand';_t_yaku_name[_t_yaku_name_ctr]=str; _t_yaku_fansu[_t_yaku_name_ctr++]=8; _t_yakufan_ctr+=8;_gm_wufanhe_flag[jia]=1;}return(1);}function _gm_seat_change(){var i, j;if(_t_players!=4) return;if(_t_jushou_ctr==4 || _t_jushou_ctr==12){i=_t_player_code[1]; _t_player_code[1]=_t_player_code[3]; _t_player_code[3]=i;i=_t[1].score;_t[1].score=_t[3].score;_t[3].score=i;j=8; while(--j>=0){i=_t[1].result[j];_t[1].result[j]=_t[3].result[j];_t[3].result[j]=i;}i=_t[1].total_result;_t[1].total_result=_t[3].total_result;_t[3].total_result=i;i=_t[1].player_name;_t[1].player_name=_t[3].player_name;_t[3].player_name=i;switch(_t_jijia){case 0: i=3; break;case 1: i=2; break;case 2: i=1; break;case 3: i=0; break;}_t_zhuangjia=_t_jijia=i;_t_init_balance();return;}if(_t_jushou_ctr!=8) return;if(_t_jijia==0){i=_t_player_code[2]; _t_player_code[2]=_t_player_code[3]; _t_player_code[3]=i;i=_t[2].score;_t[2].score=_t[3].score;_t[3].score=i;j=8; while(--j>=0){i=_t[2].result[j];_t[2].result[j]=_t[3].result[j];_t[3].result[j]=i;}i=_t[2].total_result;_t[2].total_result=_t[3].total_result;_t[3].total_result=i;i=_t[2].player_name;_t[2].player_name=_t[3].player_name;_t[3].player_name=i;_t_zhuangjia=_t_jijia=2;_t_init_balance();return;}if(_t_jijia==1){i=_t_player_code[1];_t_player_code[1]=_t_player_code[3];_t_player_code[3]=_t_player_code[2];_t_player_code[2]=i;i=_t[1].score;_t[1].score=_t[3].score;_t[3].score=_t[2].score;_t[2].score=i;j=8; while(--j>=0){i=_t[1].result[j];_t[1].result[j]=_t[3].result[j];_t[3].result[j]=_t[2].result[j];_t[2].result[j]=i;}i=_t[1].total_result;_t[1].total_result=_t[3].total_result;_t[3].total_result=_t[2].total_result;_t[2].total_result=i;i=_t[1].player_name;_t[1].player_name=_t[3].player_name;_t[3].player_name=_t[2].player_name;_t[2].player_name=i;_t_zhuangjia=_t_jijia=0;_t_init_balance();return;}if(_t_jijia==2){i=_t_player_code[1];_t_player_code[1]=_t_player_code[2];_t_player_code[2]=_t_player_code[3];_t_player_code[3]=i;i=_t[1].score;_t[1].score=_t[2].score;_t[2].score=_t[3].score;_t[3].score=i;j=8; while(--j>=0){i=_t[1].result[j];_t[1].result[j]=_t[3].result[j];_t[2].result[j]=_t[3].result[j];_t[3].result[j]=i;}i=_t[1].total_result;_t[1].total_result=_t[2].total_result;_t[2].total_result=_t[3].total_result;_t[3].total_result=i;i=_t[1].player_name;_t[1].player_name=_t[2].player_name;_t[2].player_name=_t[3].player_name;_t[3].player_name=i;_t_zhuangjia=_t_jijia=3;_t_init_balance();return;}i=_t_player_code[2]; _t_player_code[2]=_t_player_code[1]; _t_player_code[1]=i;i=_t[2].score;_t[2].score=_t[1].score;_t[1].score=i;j=8; while(--j>=0){i=_t[2].result[j];_t[2].result[j]=_t[1].result[j];_t[1].result[j]=i;}i=_t[2].total_result;_t[2].total_result=_t[1].total_result;_t[1].total_result=i;i=_t[2].player_name;_t[2].player_name=_t[1].player_name;_t[1].player_name=i;_t_zhuangjia=_t_jijia=1;_t_init_balance();return;}
